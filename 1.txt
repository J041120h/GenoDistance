GPU acceleration enabled. Detected 1 GPU(s)
  GPU 0: NVIDIA L40S (47.7 GB)
Creating gene activity matrix using GPU with 4 workers
Aggregation method: weighted_sum
Normalization: total_weight
Min peak accessibility: 0.01
Accessibility filter: 196789/3576085 peaks pass

Processing 18,651 genes from 3,576,085 peaks
Using 196,789 accessibility-filtered peaks
GPU batch size: 200 genes per batch
Transferring data to GPU...
Processing 94 gene batches on GPU...
Combining results...
Applying total_weight normalization on GPU...

Gene activity matrix created: 12,402 cells Ã— 18,651 genes
Results saved to: /dcs07/hongkai/data/harry/result/gene_activity/gene_activity_weighted_gpu.h5ad

Matrix statistics:
  Non-zero genes: 18,651/18,651 (100.0%)
  Sparsity: 59.7%
  Total counts: 8,562,441

GPU acceleration statistics:
  GPUs used: 1
  Batch size: 200 genes
