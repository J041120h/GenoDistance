/users/hjiang/.conda/envs/hongkai/lib/python3.10/site-packages/ignite/handlers/checkpoint.py:16: DeprecationWarning: `TorchScript` support for functional optimizers is deprecated and will be removed in a future PyTorch release. Consider using the `torch.compile` optimizer instead.
  from torch.distributed.optim import ZeroRedundancyOptimizer
... storing 'modality' as categorical
... storing '_combined_batch_' as categorical
... storing 'modality' as categorical
... storing '_combined_batch_' as categorical
... storing 'modality' as categorical
... storing '_combined_batch_' as categorical
... storing 'modality' as categorical
... storing '_combined_batch_' as categorical
... storing 'modality' as categorical
... storing '_combined_batch_' as categorical
... storing 'modality' as categorical
... storing '_combined_batch_' as categorical
... storing 'modality' as categorical
... storing '_combined_batch_' as categorical
... storing 'modality' as categorical
... storing '_combined_batch_' as categorical
... storing 'modality' as categorical
... storing '_combined_batch_' as categorical
... storing 'modality' as categorical
... storing '_combined_batch_' as categorical
... storing 'modality' as categorical
... storing '_combined_batch_' as categorical
... storing 'modality' as categorical
... storing '_combined_batch_' as categorical
... storing 'modality' as categorical
... storing '_combined_batch_' as categorical
... storing 'modality' as categorical
... storing '_combined_batch_' as categorical
... storing 'modality' as categorical
... storing '_combined_batch_' as categorical
... storing 'modality' as categorical
... storing '_combined_batch_' as categorical
... storing 'modality' as categorical
... storing '_combined_batch_' as categorical
... storing 'database' as categorical
... storing 'dataset' as categorical
... storing 'batch' as categorical
... storing 'tissue' as categorical
... storing 'source_file' as categorical
... storing 'age' as categorical
... storing 'sex' as categorical
... storing 'disease_state' as categorical
... storing 'organ_part' as categorical
... storing 'Unnamed: 5' as categorical
... storing 'modality' as categorical
... storing 'original_sample' as categorical
2026-01-03 22:53:37,974 - harmonypy - INFO - Computing initial centroids with sklearn.KMeans...
2026-01-03 22:53:37 | [INFO] Computing initial centroids with sklearn.KMeans...
2026-01-03 22:53:38,025 - harmonypy - INFO - sklearn.KMeans initialization complete.
2026-01-03 22:53:38 | [INFO] sklearn.KMeans initialization complete.
2026-01-03 22:53:38,025 - harmonypy - INFO - Iteration 1 of 30
2026-01-03 22:53:38 | [INFO] Iteration 1 of 30
2026-01-03 22:53:38,030 - harmonypy - INFO - Converged after 1 iteration
2026-01-03 22:53:38 | [INFO] Converged after 1 iteration
Traceback (most recent call last):
  File "/users/hjiang/GenoDistance/code/wrapper/wrapper.py", line 968, in wrapper
    multiomics_results = multiomics_wrapper(
  File "/users/hjiang/GenoDistance/code/wrapper/multiomics_wrapper.py", line 514, in multiomics_wrapper
    fig, axes = visualize_multimodal_embedding(
  File "/users/hjiang/GenoDistance/code/integration/integration_visualization.py", line 797, in visualize_multimodal_embedding
    ax, data_type, unique_values = plot_embedding_colored_by_column(
  File "/users/hjiang/GenoDistance/code/integration/integration_visualization.py", line 499, in plot_embedding_colored_by_column
    scatter = ax.scatter(embedding[valid_mask, 0], embedding[valid_mask, 1],
TypeError: tuple indices must be integers or slices, not tuple
