Linux system detected with GPU enabled.
Resuming process from previous progress:
{
    "rna": {
        "preprocessing": true,
        "cell_type_cluster": true,
        "dimensionality_reduction": false,
        "sample_distance_calculation": false,
        "trajectory_analysis": false,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "atac": {
        "preprocessing": false,
        "cell_type_cluster": false,
        "dimensionality_reduction": false,
        "sample_distance_calculation": false,
        "trajectory_analysis": false,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "multiomics": {
        "glue_integration": false,
        "glue_preprocessing": false,
        "glue_training": false,
        "glue_gene_activity": false,
        "glue_cell_types": false,
        "glue_visualization": false,
        "integration_preprocessing": false,
        "dimensionality_reduction": false,
        "embedding_visualization": false,
        "optimal_resolution": false
    },
    "system_info": {
        "platform": "Linux",
        "python_version": "3.10.18 | packaged by conda-forge | (main, Jun  4 2025, 14:45:41) [GCC 13.3.0]",
        "use_gpu": true,
        "linux_system": true
    }
}

============================================================
RUNNING RNA PIPELINE
============================================================
Starting RNA wrapper function with provided parameters...
Starting preprocessing...
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
=== Reading input dataset ===
Raw shape: 861190 cells × 18309 genes
All required columns are present in adata.obs.
Before processing. Type of adata.X: <class 'scipy.sparse._csr.csr_matrix'>
adata.X dtype: float64
adata.X is sparse: True
Converting adata.X from float64 to float32 (CPU)
After initial filtering (CPU): 823700 cells × 18102 genes
After mitochondrial filtering (CPU): 823700 cells × 18102 genes
After gene exclusion filtering (CPU): 823700 cells × 18102 genes
After sample filtering (CPU): 823700 cells × 18102 genes
Number of samples remaining: 44
After final gene filtering (CPU): 823700 cells × 18060 genes
Preprocessing complete on CPU. Proceeding to clustering & sample analysis.
=== Processing data for clustering ===
Running HVG selection on CPU...
After HVG: 823700 cells × 2000 genes
Moving to GPU for normalization, PCA, and Harmony...
=== [GPU] Running Harmony integration ===
Variables to regress: sample
Use GPU mode.
	Initialization is completed.
	Completed 1 / 30 iteration(s).
	Completed 2 / 30 iteration(s).
	Completed 3 / 30 iteration(s).
	Completed 4 / 30 iteration(s).
	Completed 5 / 30 iteration(s).
	Completed 6 / 30 iteration(s).
	Completed 7 / 30 iteration(s).
Reach convergence after 7 iteration(s).
End of harmony for adata_cluster.
[safe_h5ad_write] Preparing to save to: /dcl01/hongkai/data/data/hjiang/Data/multiomics_benchmark_data/rna/preprocess/adata_cell.h5ad
[clean_obs_for_saving] Cleaning observation metadata for H5AD compatibility...
[clean_obs_for_saving] Cleaning completed successfully
[clean_obs_for_saving] 6 categorical columns processed
[safe_h5ad_write] Writing H5AD file...
[safe_h5ad_write] Successfully saved to: /dcl01/hongkai/data/data/hjiang/Data/multiomics_benchmark_data/rna/preprocess/adata_cell.h5ad
=== [CPU] Processing data for sample differences ===
[safe_h5ad_write] Preparing to save to: /dcl01/hongkai/data/data/hjiang/Data/multiomics_benchmark_data/rna/preprocess/adata_sample.h5ad
[clean_obs_for_saving] Cleaning observation metadata for H5AD compatibility...
[clean_obs_for_saving] Cleaning completed successfully
[clean_obs_for_saving] 6 categorical columns processed
[safe_h5ad_write] Writing H5AD file...
[safe_h5ad_write] Successfully saved to: /dcl01/hongkai/data/data/hjiang/Data/multiomics_benchmark_data/rna/preprocess/adata_sample.h5ad
Total runtime: 1397.56 seconds
Starting cell type clustering at resolution: 0.99
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
[cell_types] No cell type annotation found. Performing clustering.
[cell_types] Building neighborhood graph...
[cell_types] No target clusters specified. Using standard Leiden clustering (resolution=0.99)...
[cell_types] Found 31 clusters after Leiden clustering.
[cell_types] Finished assigning cell types.
[cell_types] Computing UMAP...
[cell_types] Converting GPU arrays to CPU...
[cell_types] Generating UMAP visualizations...
[generate_umap_visualizations] Generating UMAP plots...
[generate_umap_visualizations] → Plotting UMAP colored by 'cell_type' (31 categories)
[generate_umap_visualizations] ✓ Saved: /dcl01/hongkai/data/data/hjiang/Data/multiomics_benchmark_data/rna/preprocess/umap_cell_type.png
[safe_h5ad_write] Preparing to save to: /dcl01/hongkai/data/data/hjiang/Data/multiomics_benchmark_data/rna/preprocess/adata_cell.h5ad
[clean_obs_for_saving] Cleaning observation metadata for H5AD compatibility...
[clean_obs_for_saving] Cleaning completed successfully
[clean_obs_for_saving] 7 categorical columns processed
[safe_h5ad_write] Writing H5AD file...
[safe_h5ad_write] Successfully saved to: /dcl01/hongkai/data/data/hjiang/Data/multiomics_benchmark_data/rna/preprocess/adata_cell.h5ad
[cell_types] Total runtime: 374.89 seconds
[safe_h5ad_write] Preparing to save to: /dcl01/hongkai/data/data/hjiang/Data/multiomics_benchmark_data/rna/preprocess/adata_sample.h5ad
[clean_obs_for_saving] Cleaning observation metadata for H5AD compatibility...
[clean_obs_for_saving] Cleaning completed successfully
[clean_obs_for_saving] 7 categorical columns processed
[safe_h5ad_write] Writing H5AD file...
[safe_h5ad_write] Successfully saved to: /dcl01/hongkai/data/data/hjiang/Data/multiomics_benchmark_data/rna/preprocess/adata_sample.h5ad

✗ RNA pipeline failed with error: Dimensionality_reduction is skipped, but no dimensionality_reduction data found.

============================================================
PIPELINE EXECUTION SUMMARY
============================================================
RNA Pipeline: ⚠ PARTIAL
  - preprocessing: ✓
  - cell_type_cluster: ✓
  - dimensionality_reduction: ✗
  - sample_distance_calculation: ✗
  - trajectory_analysis: ✗
  - trajectory_dge: ✗
  - cluster_dge: ✗
  - visualization: ✗

Results saved to: /dcl01/hongkai/data/data/hjiang/Data/multiomics_benchmark_data
Status file: /dcl01/hongkai/data/data/hjiang/Data/multiomics_benchmark_data/sys_log/main_process_status.json
Execution time: 2381.1988 seconds
