Linux system detected with GPU enabled.
Resuming process from previous progress:
{
    "rna": {
        "preprocessing": false,
        "cell_type_cluster": false,
        "dimensionality_reduction": false,
        "sample_distance_calculation": false,
        "trajectory_analysis": false,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "atac": {
        "preprocessing": false,
        "cell_type_cluster": false,
        "dimensionality_reduction": false,
        "sample_distance_calculation": false,
        "trajectory_analysis": false,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "multiomics": {
        "glue_integration": true,
        "glue_preprocessing": true,
        "glue_training": true,
        "glue_gene_activity": true,
        "glue_cell_types": true,
        "glue_visualization": true,
        "integration_preprocessing": true,
        "dimensionality_reduction": true,
        "embedding_visualization": true,
        "optimal_resolution": true
    },
    "system_info": {
        "platform": "Linux",
        "python_version": "3.10.18 | packaged by conda-forge | (main, Jun  4 2025, 14:45:41) [GCC 13.3.0]",
        "use_gpu": true,
        "linux_system": true
    }
}

============================================================
RUNNING MULTIOMICS PIPELINE
============================================================
Starting multi-modal pipeline with output directory: /dcs07/hongkai/data/harry/result/multi_omics_unpaired/multiomics
Initial status flags: {'glue_integration': True, 'glue_preprocessing': True, 'glue_training': True, 'glue_gene_activity': True, 'glue_cell_types': True, 'glue_visualization': True, 'integration_preprocessing': True, 'dimensionality_reduction': True, 'embedding_visualization': True, 'optimal_resolution': True}
Loaded preprocessed data from: /dcs07/hongkai/data/harry/result/multi_omics_unpaired/multiomics/preprocess/adata_sample.h5ad
Loaded dimensionality reduction data from existing files
Step 5: Finding optimal cell resolution...
GPU Memory: 47.70 GB
GPU Memory Available: 0.00 GB

================================================================================
MULTI-OMICS RESOLUTION OPTIMIZATION
================================================================================

Configuration:
  Optimization target: RNA EXPRESSION
  Representation: X_glue (20 components)
  DR components: 30
  CCA PCs: 2
  Cell type method: cell_types_multiomics (RNA clustering + ATAC label transfer)
  Cell type visualization: True
  Output: /dcs07/hongkai/data/harry/result/multi_omics_unpaired/multiomics/resolution_optimization/Integration_optimization_rna_expression

============================================================
PASS 1: Coarse Search (0.1 - 1.0, step 0.1)
============================================================

--- Resolution: 0.100 (coarse) ---
  Clusters: 12
  RNA expression: 0.1690
  ATAC expression: 0.4271

--- Resolution: 0.200 (coarse) ---
  Clusters: 16
  RNA expression: 0.0909
  ATAC expression: 0.3893

--- Resolution: 0.300 (coarse) ---
  Clusters: 21
  RNA expression: 0.0591
  ATAC expression: 0.1908

--- Resolution: 0.400 (coarse) ---
