Linux system detected with GPU enabled.
Resuming process from previous progress:
{
    "rna": {
        "preprocessing": true,
        "cell_type_cluster": true,
        "dimensionality_reduction": true,
        "sample_distance_calculation": true,
        "trajectory_analysis": true,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": true
    },
    "atac": {
        "preprocessing": false,
        "cell_type_cluster": false,
        "dimensionality_reduction": false,
        "sample_distance_calculation": false,
        "trajectory_analysis": false,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "multiomics": {
        "glue_integration": false,
        "glue_preprocessing": false,
        "glue_training": false,
        "glue_gene_activity": false,
        "glue_cell_types": false,
        "glue_visualization": false,
        "integration_preprocessing": false,
        "dimensionality_reduction": false,
        "embedding_visualization": false,
        "optimal_resolution": false
    },
    "system_info": {
        "platform": "Linux",
        "python_version": "3.10.18 | packaged by conda-forge | (main, Jun  4 2025, 14:45:41) [GCC 13.3.0]",
        "use_gpu": true,
        "linux_system": true
    }
}

============================================================
RUNNING RNA PIPELINE
============================================================
Starting RNA wrapper function with provided parameters...
Reading Pseudobulk from provided or default path: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/pseudobulk/pseudobulk_sample.h5ad
Using PROFILED GPU version of optimal resolution
Directory setup: 0.00 seconds
Starting RNA-seq resolution optimization for X_DR_expression...
Using 10 PCs for CCA analysis
Testing resolutions from 0.01 to 1.00...
Will compute corrected p-values with 1000 simulations per resolution

=== FIRST PASS: Coarse Search ===


Testing resolution: 0.100

  Cell clustering: 3.55 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 4
  Pseudobulk computation: 13.34 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.100: CCA Score = 0.7950 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.5859
PC1 + PC3: CCA score = 0.3817
PC1 + PC4: CCA score = 0.2288
PC1 + PC5: CCA score = 0.2378
PC1 + PC6: CCA score = 0.2622
PC1 + PC7: CCA score = 0.2030
PC1 + PC8: CCA score = 0.2546
PC1 + PC9: CCA score = 0.2016
PC1 + PC10: CCA score = 0.3560
PC2 + PC3: CCA score = 0.6419
PC2 + PC4: CCA score = 0.5645
PC2 + PC5: CCA score = 0.5682
PC2 + PC6: CCA score = 0.5788
PC2 + PC7: CCA score = 0.5546
PC2 + PC8: CCA score = 0.5754
PC2 + PC9: CCA score = 0.5540
PC2 + PC10: CCA score = 0.6269
PC3 + PC4: CCA score = 0.3479
PC3 + PC5: CCA score = 0.3539
PC3 + PC6: CCA score = 0.3707
PC3 + PC7: CCA score = 0.3315
PC3 + PC8: CCA score = 0.3654
PC3 + PC9: CCA score = 0.3306
PC3 + PC10: CCA score = 0.4421
PC4 + PC5: CCA score = 0.1786
PC4 + PC6: CCA score = 0.2100
PC4 + PC7: CCA score = 0.1288
PC4 + PC8: CCA score = 0.2004
PC4 + PC9: CCA score = 0.1264
PC4 + PC10: CCA score = 0.3195
PC5 + PC6: CCA score = 0.2197
PC5 + PC7: CCA score = 0.1441
PC5 + PC8: CCA score = 0.2106
PC5 + PC9: CCA score = 0.1420
PC5 + PC10: CCA score = 0.3260
PC6 + PC7: CCA score = 0.1815
PC6 + PC8: CCA score = 0.2378
PC6 + PC9: CCA score = 0.1799
PC6 + PC10: CCA score = 0.3442
PC7 + PC8: CCA score = 0.1704
PC7 + PC9: CCA score = 0.0696
PC7 + PC10: CCA score = 0.3016
PC8 + PC9: CCA score = 0.1686
PC8 + PC10: CCA score = 0.3385
PC9 + PC10: CCA score = 0.3006
Best combination: PC2 + PC3 with score 0.6419
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.100/cca_plot_res_0.100.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.100/cca_plot_res_0.100_contributions.png
Created CCA visualization plot using PC2 + PC3 (viz score: 0.6419)
  Null distribution (1000 sims): 2.17 seconds
Resolution 0.100: Standard p-value = 0.0420
TOTAL for resolution 0.100: 20.37 seconds


Testing resolution: 0.200

  Cell clustering: 2.36 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 5
  Pseudobulk computation: 16.03 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.200: CCA Score = 0.7206 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.4651
PC1 + PC3: CCA score = 0.4648
PC1 + PC4: CCA score = 0.5377
PC1 + PC5: CCA score = 0.4626
PC1 + PC6: CCA score = 0.4854
PC1 + PC7: CCA score = 0.4698
PC1 + PC8: CCA score = 0.6145
PC1 + PC9: CCA score = 0.4852
PC1 + PC10: CCA score = 0.4694
PC2 + PC3: CCA score = 0.0770
PC2 + PC4: CCA score = 0.2811
PC2 + PC5: CCA score = 0.0621
PC2 + PC6: CCA score = 0.1596
PC2 + PC7: CCA score = 0.1028
PC2 + PC8: CCA score = 0.4092
PC2 + PC9: CCA score = 0.1591
PC2 + PC10: CCA score = 0.1009
PC3 + PC4: CCA score = 0.2806
PC3 + PC5: CCA score = 0.0601
PC3 + PC6: CCA score = 0.1588
PC3 + PC7: CCA score = 0.1015
PC3 + PC8: CCA score = 0.4088
PC3 + PC9: CCA score = 0.1583
PC3 + PC10: CCA score = 0.0996
PC4 + PC5: CCA score = 0.2769
PC4 + PC6: CCA score = 0.3135
PC4 + PC7: CCA score = 0.2888
PC4 + PC8: CCA score = 0.4901
PC4 + PC9: CCA score = 0.3133
PC4 + PC10: CCA score = 0.2881
PC5 + PC6: CCA score = 0.1522
PC5 + PC7: CCA score = 0.0908
PC5 + PC8: CCA score = 0.4063
PC5 + PC9: CCA score = 0.1516
PC5 + PC10: CCA score = 0.0886
PC6 + PC7: CCA score = 0.1728
PC6 + PC8: CCA score = 0.4321
PC6 + PC9: CCA score = 0.2112
PC6 + PC10: CCA score = 0.1717
PC7 + PC8: CCA score = 0.4145
PC7 + PC9: CCA score = 0.1723
PC7 + PC10: CCA score = 0.1206
PC8 + PC9: CCA score = 0.4319
PC8 + PC10: CCA score = 0.4140
PC9 + PC10: CCA score = 0.1712
Best combination: PC1 + PC8 with score 0.6145
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.200/cca_plot_res_0.200.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.200/cca_plot_res_0.200_contributions.png
Created CCA visualization plot using PC1 + PC8 (viz score: 0.6145)
  Null distribution (1000 sims): 2.15 seconds
Resolution 0.200: Standard p-value = 0.1930
TOTAL for resolution 0.200: 21.75 seconds


Testing resolution: 0.300

  Cell clustering: 2.53 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 8
  Pseudobulk computation: 22.93 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.300: CCA Score = 0.7459 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.4651
PC1 + PC3: CCA score = 0.4162
PC1 + PC4: CCA score = 0.5556
PC1 + PC5: CCA score = 0.4774
PC1 + PC6: CCA score = 0.4454
PC1 + PC7: CCA score = 0.4082
PC1 + PC8: CCA score = 0.4980
PC1 + PC9: CCA score = 0.4079
PC1 + PC10: CCA score = 0.4235
PC2 + PC3: CCA score = 0.2395
PC2 + PC4: CCA score = 0.4392
PC2 + PC5: CCA score = 0.3347
PC2 + PC6: CCA score = 0.2873
PC2 + PC7: CCA score = 0.2253
PC2 + PC8: CCA score = 0.3635
PC2 + PC9: CCA score = 0.2247
PC2 + PC10: CCA score = 0.2520
PC3 + PC4: CCA score = 0.3871
PC3 + PC5: CCA score = 0.2627
PC3 + PC6: CCA score = 0.1987
PC3 + PC7: CCA score = 0.0877
PC3 + PC8: CCA score = 0.2985
PC3 + PC9: CCA score = 0.0862
PC3 + PC10: CCA score = 0.1431
PC4 + PC5: CCA score = 0.4522
PC4 + PC6: CCA score = 0.4183
PC4 + PC7: CCA score = 0.3784
PC4 + PC8: CCA score = 0.4739
PC4 + PC9: CCA score = 0.3780
PC4 + PC10: CCA score = 0.3949
PC5 + PC6: CCA score = 0.3069
PC5 + PC7: CCA score = 0.2497
PC5 + PC8: CCA score = 0.3792
PC5 + PC9: CCA score = 0.2492
PC5 + PC10: CCA score = 0.2741
PC6 + PC7: CCA score = 0.1813
PC6 + PC8: CCA score = 0.3380
PC6 + PC9: CCA score = 0.1805
PC6 + PC10: CCA score = 0.2136
PC7 + PC8: CCA score = 0.2872
PC7 + PC9: CCA score = 0.0282
PC7 + PC10: CCA score = 0.1176
PC8 + PC9: CCA score = 0.2867
PC8 + PC10: CCA score = 0.3086
PC9 + PC10: CCA score = 0.1165
Best combination: PC1 + PC4 with score 0.5556
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.300/cca_plot_res_0.300.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.300/cca_plot_res_0.300_contributions.png
Created CCA visualization plot using PC1 + PC4 (viz score: 0.5556)
  Null distribution (1000 sims): 2.15 seconds
Resolution 0.300: Standard p-value = 0.1020
TOTAL for resolution 0.300: 28.80 seconds


Testing resolution: 0.400

  Cell clustering: 2.55 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 9
  Pseudobulk computation: 26.16 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.400: CCA Score = 0.7672 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3705
PC1 + PC3: CCA score = 0.5676
PC1 + PC4: CCA score = 0.3562
PC1 + PC5: CCA score = 0.3696
PC1 + PC6: CCA score = 0.3781
PC1 + PC7: CCA score = 0.4167
PC1 + PC8: CCA score = 0.4152
PC1 + PC9: CCA score = 0.5112
PC1 + PC10: CCA score = 0.3580
PC2 + PC3: CCA score = 0.4542
PC2 + PC4: CCA score = 0.1046
PC2 + PC5: CCA score = 0.1438
PC2 + PC6: CCA score = 0.1644
PC2 + PC7: CCA score = 0.2402
PC2 + PC8: CCA score = 0.2377
PC2 + PC9: CCA score = 0.3813
PC2 + PC10: CCA score = 0.1106
PC3 + PC4: CCA score = 0.4426
PC3 + PC5: CCA score = 0.4535
PC3 + PC6: CCA score = 0.4604
PC3 + PC7: CCA score = 0.4926
PC3 + PC8: CCA score = 0.4914
PC3 + PC9: CCA score = 0.5747
PC3 + PC10: CCA score = 0.4441
PC4 + PC5: CCA score = 0.1014
PC4 + PC6: CCA score = 0.1290
PC4 + PC7: CCA score = 0.2174
PC4 + PC8: CCA score = 0.2147
PC4 + PC9: CCA score = 0.3674
PC4 + PC10: CCA score = 0.0427
PC5 + PC6: CCA score = 0.1624
PC5 + PC7: CCA score = 0.2388
PC5 + PC8: CCA score = 0.2363
PC5 + PC9: CCA score = 0.3804
PC5 + PC10: CCA score = 0.1076
PC6 + PC7: CCA score = 0.2518
PC6 + PC8: CCA score = 0.2494
PC6 + PC9: CCA score = 0.3887
PC6 + PC10: CCA score = 0.1339
PC7 + PC8: CCA score = 0.3047
PC7 + PC9: CCA score = 0.4263
PC7 + PC10: CCA score = 0.2204
PC8 + PC9: CCA score = 0.4249
PC8 + PC10: CCA score = 0.2177
PC9 + PC10: CCA score = 0.3691
Best combination: PC3 + PC9 with score 0.5747
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.400/cca_plot_res_0.400.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.400/cca_plot_res_0.400_contributions.png
Created CCA visualization plot using PC3 + PC9 (viz score: 0.5747)
  Null distribution (1000 sims): 2.16 seconds
Resolution 0.400: Standard p-value = 0.0390
TOTAL for resolution 0.400: 32.09 seconds


Testing resolution: 0.500

  Cell clustering: 2.71 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 11
  Pseudobulk computation: 29.98 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.500: CCA Score = 0.8010 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2937
PC1 + PC3: CCA score = 0.4992
PC1 + PC4: CCA score = 0.4056
PC1 + PC5: CCA score = 0.2998
PC1 + PC6: CCA score = 0.2785
PC1 + PC7: CCA score = 0.4975
PC1 + PC8: CCA score = 0.2426
PC1 + PC9: CCA score = 0.2366
PC1 + PC10: CCA score = 0.2434
PC2 + PC3: CCA score = 0.4729
PC2 + PC4: CCA score = 0.3727
PC2 + PC5: CCA score = 0.2537
PC2 + PC6: CCA score = 0.2281
PC2 + PC7: CCA score = 0.4711
PC2 + PC8: CCA score = 0.1825
PC2 + PC9: CCA score = 0.1744
PC2 + PC10: CCA score = 0.1836
PC3 + PC4: CCA score = 0.5494
PC3 + PC5: CCA score = 0.4767
PC3 + PC6: CCA score = 0.4636
PC3 + PC7: CCA score = 0.6203
PC3 + PC8: CCA score = 0.4430
PC3 + PC9: CCA score = 0.4397
PC3 + PC10: CCA score = 0.4434
PC4 + PC5: CCA score = 0.3776
PC4 + PC6: CCA score = 0.3609
PC4 + PC7: CCA score = 0.5478
PC4 + PC8: CCA score = 0.3339
PC4 + PC9: CCA score = 0.3296
PC4 + PC10: CCA score = 0.3345
PC5 + PC6: CCA score = 0.2359
PC5 + PC7: CCA score = 0.4749
PC5 + PC8: CCA score = 0.1922
PC5 + PC9: CCA score = 0.1846
PC5 + PC10: CCA score = 0.1932
PC6 + PC7: CCA score = 0.4617
PC6 + PC8: CCA score = 0.1568
PC6 + PC9: CCA score = 0.1474
PC6 + PC10: CCA score = 0.1581
PC7 + PC8: CCA score = 0.4410
PC7 + PC9: CCA score = 0.4378
PC7 + PC10: CCA score = 0.4415
PC8 + PC9: CCA score = 0.0550
PC8 + PC10: CCA score = 0.0793
PC9 + PC10: CCA score = 0.0584
Best combination: PC3 + PC7 with score 0.6203
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.500/cca_plot_res_0.500.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.500/cca_plot_res_0.500_contributions.png
Created CCA visualization plot using PC3 + PC7 (viz score: 0.6203)
  Null distribution (1000 sims): 2.15 seconds
Resolution 0.500: Standard p-value = 0.0170
TOTAL for resolution 0.500: 36.11 seconds


Testing resolution: 0.600

  Cell clustering: 2.59 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 12
  Pseudobulk computation: 32.04 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.600: CCA Score = 0.7482 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3180
PC1 + PC3: CCA score = 0.5601
PC1 + PC4: CCA score = 0.3449
PC1 + PC5: CCA score = 0.4394
PC1 + PC6: CCA score = 0.3277
PC1 + PC7: CCA score = 0.2974
PC1 + PC8: CCA score = 0.3283
PC1 + PC9: CCA score = 0.2934
PC1 + PC10: CCA score = 0.3206
PC2 + PC3: CCA score = 0.5000
PC2 + PC4: CCA score = 0.2349
PC2 + PC5: CCA score = 0.3596
PC2 + PC6: CCA score = 0.2089
PC2 + PC7: CCA score = 0.1572
PC2 + PC8: CCA score = 0.2098
PC2 + PC9: CCA score = 0.1494
PC2 + PC10: CCA score = 0.1976
PC3 + PC4: CCA score = 0.5175
PC3 + PC5: CCA score = 0.5847
PC3 + PC6: CCA score = 0.5062
PC3 + PC7: CCA score = 0.4871
PC3 + PC8: CCA score = 0.5066
PC3 + PC9: CCA score = 0.4847
PC3 + PC10: CCA score = 0.5017
PC4 + PC5: CCA score = 0.3835
PC4 + PC6: CCA score = 0.2479
PC4 + PC7: CCA score = 0.2062
PC4 + PC8: CCA score = 0.2486
PC4 + PC9: CCA score = 0.2003
PC4 + PC10: CCA score = 0.2384
PC5 + PC6: CCA score = 0.3682
PC5 + PC7: CCA score = 0.3415
PC5 + PC8: CCA score = 0.3687
PC5 + PC9: CCA score = 0.3380
PC5 + PC10: CCA score = 0.3619
PC6 + PC7: CCA score = 0.1760
PC6 + PC8: CCA score = 0.2243
PC6 + PC9: CCA score = 0.1691
PC6 + PC10: CCA score = 0.2129
PC7 + PC8: CCA score = 0.1771
PC7 + PC9: CCA score = 0.0982
PC7 + PC10: CCA score = 0.1624
PC8 + PC9: CCA score = 0.1702
PC8 + PC10: CCA score = 0.2138
PC9 + PC10: CCA score = 0.1549
Best combination: PC3 + PC5 with score 0.5847
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.600/cca_plot_res_0.600.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.600/cca_plot_res_0.600_contributions.png
Created CCA visualization plot using PC3 + PC5 (viz score: 0.5847)
  Null distribution (1000 sims): 2.16 seconds
Resolution 0.600: Standard p-value = 0.0960
TOTAL for resolution 0.600: 38.01 seconds


Testing resolution: 0.700

  Cell clustering: 2.59 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 12
  Pseudobulk computation: 33.61 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.700: CCA Score = 0.8186 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.1480
PC1 + PC3: CCA score = 0.5712
PC1 + PC4: CCA score = 0.1296
PC1 + PC5: CCA score = 0.1713
PC1 + PC6: CCA score = 0.2125
PC1 + PC7: CCA score = 0.1256
PC1 + PC8: CCA score = 0.4073
PC1 + PC9: CCA score = 0.2174
PC1 + PC10: CCA score = 0.3536
PC2 + PC3: CCA score = 0.5633
PC2 + PC4: CCA score = 0.0888
PC2 + PC5: CCA score = 0.1429
PC2 + PC6: CCA score = 0.1904
PC2 + PC7: CCA score = 0.0828
PC2 + PC8: CCA score = 0.3962
PC2 + PC9: CCA score = 0.1958
PC2 + PC10: CCA score = 0.3408
PC3 + PC4: CCA score = 0.5588
PC3 + PC5: CCA score = 0.5699
PC3 + PC6: CCA score = 0.5836
PC3 + PC7: CCA score = 0.5579
PC3 + PC8: CCA score = 0.6792
PC3 + PC9: CCA score = 0.5854
PC3 + PC10: CCA score = 0.6485
PC4 + PC5: CCA score = 0.1237
PC4 + PC6: CCA score = 0.1765
PC4 + PC7: CCA score = 0.0418
PC4 + PC8: CCA score = 0.3897
PC4 + PC9: CCA score = 0.1823
PC4 + PC10: CCA score = 0.3332
PC5 + PC6: CCA score = 0.2090
PC5 + PC7: CCA score = 0.1195
PC5 + PC8: CCA score = 0.4054
PC5 + PC9: CCA score = 0.2139
PC5 + PC10: CCA score = 0.3515
PC6 + PC7: CCA score = 0.1735
PC6 + PC8: CCA score = 0.4245
PC6 + PC9: CCA score = 0.2482
PC6 + PC10: CCA score = 0.3733
PC7 + PC8: CCA score = 0.3884
PC7 + PC9: CCA score = 0.1795
PC7 + PC10: CCA score = 0.3317
PC8 + PC9: CCA score = 0.4270
PC8 + PC10: CCA score = 0.5100
PC9 + PC10: CCA score = 0.3761
Best combination: PC3 + PC8 with score 0.6792
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.700/cca_plot_res_0.700.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.700/cca_plot_res_0.700_contributions.png
Created CCA visualization plot using PC3 + PC8 (viz score: 0.6792)
  Null distribution (1000 sims): 2.15 seconds
Resolution 0.700: Standard p-value = 0.0170
TOTAL for resolution 0.700: 39.58 seconds


Testing resolution: 0.800

  Cell clustering: 2.63 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 12
  Pseudobulk computation: 32.24 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.800: CCA Score = 0.7716 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2035
PC1 + PC3: CCA score = 0.2318
PC1 + PC4: CCA score = 0.3935
PC1 + PC5: CCA score = 0.4640
PC1 + PC6: CCA score = 0.2081
PC1 + PC7: CCA score = 0.2208
PC1 + PC8: CCA score = 0.2598
PC1 + PC9: CCA score = 0.4479
PC1 + PC10: CCA score = 0.3115
PC2 + PC3: CCA score = 0.1158
PC2 + PC4: CCA score = 0.3384
PC2 + PC5: CCA score = 0.4183
PC2 + PC6: CCA score = 0.0545
PC2 + PC7: CCA score = 0.0918
PC2 + PC8: CCA score = 0.1648
PC2 + PC9: CCA score = 0.4004
PC2 + PC10: CCA score = 0.2381
PC3 + PC4: CCA score = 0.3561
PC3 + PC5: CCA score = 0.4328
PC3 + PC6: CCA score = 0.1236
PC3 + PC7: CCA score = 0.1440
PC3 + PC8: CCA score = 0.1986
PC3 + PC9: CCA score = 0.4155
PC3 + PC10: CCA score = 0.2627
PC4 + PC5: CCA score = 0.5370
PC4 + PC6: CCA score = 0.3411
PC4 + PC7: CCA score = 0.3490
PC4 + PC8: CCA score = 0.3749
PC4 + PC9: CCA score = 0.5232
PC4 + PC10: CCA score = 0.4124
PC5 + PC6: CCA score = 0.4205
PC5 + PC7: CCA score = 0.4270
PC5 + PC8: CCA score = 0.4484
PC5 + PC9: CCA score = 0.5781
PC5 + PC10: CCA score = 0.4802
PC6 + PC7: CCA score = 0.1014
PC6 + PC8: CCA score = 0.1704
PC6 + PC9: CCA score = 0.4027
PC6 + PC10: CCA score = 0.2420
PC7 + PC8: CCA score = 0.1857
PC7 + PC9: CCA score = 0.4094
PC7 + PC10: CCA score = 0.2530
PC8 + PC9: CCA score = 0.4317
PC8 + PC10: CCA score = 0.2876
PC9 + PC10: CCA score = 0.4646
Best combination: PC5 + PC9 with score 0.5781
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.800/cca_plot_res_0.800.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.800/cca_plot_res_0.800_contributions.png
Created CCA visualization plot using PC5 + PC9 (viz score: 0.5781)
  Null distribution (1000 sims): 2.17 seconds
Resolution 0.800: Standard p-value = 0.0500
TOTAL for resolution 0.800: 38.28 seconds


Testing resolution: 0.900

  Cell clustering: 2.65 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 15
  Pseudobulk computation: 39.99 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.900: CCA Score = 0.8228 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3602
PC1 + PC3: CCA score = 0.3205
PC1 + PC4: CCA score = 0.4713
PC1 + PC5: CCA score = 0.1923
PC1 + PC6: CCA score = 0.2105
PC1 + PC7: CCA score = 0.3339
PC1 + PC8: CCA score = 0.3187
PC1 + PC9: CCA score = 0.3059
PC1 + PC10: CCA score = 0.1705
PC2 + PC3: CCA score = 0.4288
PC2 + PC4: CCA score = 0.5507
PC2 + PC5: CCA score = 0.3437
PC2 + PC6: CCA score = 0.3542
PC2 + PC7: CCA score = 0.4389
PC2 + PC8: CCA score = 0.4275
PC2 + PC9: CCA score = 0.4180
PC2 + PC10: CCA score = 0.3320
PC3 + PC4: CCA score = 0.5255
PC3 + PC5: CCA score = 0.3018
PC3 + PC6: CCA score = 0.3137
PC3 + PC7: CCA score = 0.4069
PC3 + PC8: CCA score = 0.3945
PC3 + PC9: CCA score = 0.3842
PC3 + PC10: CCA score = 0.2883
PC4 + PC5: CCA score = 0.4588
PC4 + PC6: CCA score = 0.4667
PC4 + PC7: CCA score = 0.5338
PC4 + PC8: CCA score = 0.5245
PC4 + PC9: CCA score = 0.5167
PC4 + PC10: CCA score = 0.4500
PC5 + PC6: CCA score = 0.1808
PC5 + PC7: CCA score = 0.3160
PC5 + PC8: CCA score = 0.2999
PC5 + PC9: CCA score = 0.2862
PC5 + PC10: CCA score = 0.1320
PC6 + PC7: CCA score = 0.3274
PC6 + PC8: CCA score = 0.3119
PC6 + PC9: CCA score = 0.2987
PC6 + PC10: CCA score = 0.1573
PC7 + PC8: CCA score = 0.4056
PC7 + PC9: CCA score = 0.3955
PC7 + PC10: CCA score = 0.3032
PC8 + PC9: CCA score = 0.3828
PC8 + PC10: CCA score = 0.2864
PC9 + PC10: CCA score = 0.2720
Best combination: PC2 + PC4 with score 0.5507
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.900/cca_plot_res_0.900.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.900/cca_plot_res_0.900_contributions.png
Created CCA visualization plot using PC2 + PC4 (viz score: 0.5507)
  Null distribution (1000 sims): 2.17 seconds
Resolution 0.900: Standard p-value = 0.0060
TOTAL for resolution 0.900: 46.05 seconds


Testing resolution: 1.000

  Cell clustering: 2.60 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 15
  Pseudobulk computation: 42.77 seconds
  Dimension reduction: 0.01 seconds
Resolution 1.000: CCA Score = 0.7502 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.4263
PC1 + PC3: CCA score = 0.4165
PC1 + PC4: CCA score = 0.1874
PC1 + PC5: CCA score = 0.2760
PC1 + PC6: CCA score = 0.1157
PC1 + PC7: CCA score = 0.1488
PC1 + PC8: CCA score = 0.3012
PC1 + PC9: CCA score = 0.1425
PC1 + PC10: CCA score = 0.1953
PC2 + PC3: CCA score = 0.5771
PC2 + PC4: CCA score = 0.4413
PC2 + PC5: CCA score = 0.4856
PC2 + PC6: CCA score = 0.4160
PC2 + PC7: CCA score = 0.4264
PC2 + PC8: CCA score = 0.5004
PC2 + PC9: CCA score = 0.4242
PC2 + PC10: CCA score = 0.4447
PC3 + PC4: CCA score = 0.4318
PC3 + PC5: CCA score = 0.4770
PC3 + PC6: CCA score = 0.4059
PC3 + PC7: CCA score = 0.4165
PC3 + PC8: CCA score = 0.4920
PC3 + PC9: CCA score = 0.4143
PC3 + PC10: CCA score = 0.4353
PC4 + PC5: CCA score = 0.2986
PC4 + PC6: CCA score = 0.1625
PC4 + PC7: CCA score = 0.1875
PC4 + PC8: CCA score = 0.3221
PC4 + PC9: CCA score = 0.1826
PC4 + PC10: CCA score = 0.2262
PC5 + PC6: CCA score = 0.2597
PC5 + PC7: CCA score = 0.2761
PC5 + PC8: CCA score = 0.3805
PC5 + PC9: CCA score = 0.2727
PC5 + PC10: CCA score = 0.3037
PC6 + PC7: CCA score = 0.1160
PC6 + PC8: CCA score = 0.2864
PC6 + PC9: CCA score = 0.1078
PC6 + PC10: CCA score = 0.1716
PC7 + PC8: CCA score = 0.3013
PC7 + PC9: CCA score = 0.1427
PC7 + PC10: CCA score = 0.1954
PC8 + PC9: CCA score = 0.2983
PC8 + PC10: CCA score = 0.3268
PC9 + PC10: CCA score = 0.1907
Best combination: PC2 + PC3 with score 0.5771
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_1.000/cca_plot_res_1.000.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_1.000/cca_plot_res_1.000_contributions.png
Created CCA visualization plot using PC2 + PC3 (viz score: 0.5771)
  Null distribution (1000 sims): 2.15 seconds
Resolution 1.000: Standard p-value = 0.1120
TOTAL for resolution 1.000: 48.77 seconds

COARSE SEARCH TOTAL: 349.83 seconds

Best resolution from first pass: 0.90
Best CCA score: 0.8228

=== SECOND PASS: Fine-tuned Search ===
Fine-tuning search from 0.88 to 0.92...


Testing resolution: 0.880

  Cell clustering: 2.76 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 13
  Pseudobulk computation: 35.00 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.880: CCA Score = 0.7609 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2271
PC1 + PC3: CCA score = 0.2503
PC1 + PC4: CCA score = 0.4298
PC1 + PC5: CCA score = 0.3971
PC1 + PC6: CCA score = 0.3286
PC1 + PC7: CCA score = 0.2261
PC1 + PC8: CCA score = 0.2398
PC1 + PC9: CCA score = 0.4643
PC1 + PC10: CCA score = 0.3145
PC2 + PC3: CCA score = 0.1097
PC2 + PC4: CCA score = 0.3662
PC2 + PC5: CCA score = 0.3273
PC2 + PC6: CCA score = 0.2395
PC2 + PC7: CCA score = 0.0224
PC2 + PC8: CCA score = 0.0832
PC2 + PC9: CCA score = 0.4062
PC2 + PC10: CCA score = 0.2197
PC3 + PC4: CCA score = 0.3811
PC3 + PC5: CCA score = 0.3438
PC3 + PC6: CCA score = 0.2616
PC3 + PC7: CCA score = 0.1076
PC3 + PC8: CCA score = 0.1341
PC3 + PC9: CCA score = 0.4196
PC3 + PC10: CCA score = 0.2436
PC4 + PC5: CCA score = 0.4902
PC4 + PC6: CCA score = 0.4365
PC4 + PC7: CCA score = 0.3656
PC4 + PC8: CCA score = 0.3743
PC4 + PC9: CCA score = 0.5460
PC4 + PC10: CCA score = 0.4260
PC5 + PC6: CCA score = 0.4044
PC5 + PC7: CCA score = 0.3266
PC5 + PC8: CCA score = 0.3362
PC5 + PC9: CCA score = 0.5207
PC5 + PC10: CCA score = 0.3930
PC6 + PC7: CCA score = 0.2385
PC6 + PC8: CCA score = 0.2516
PC6 + PC9: CCA score = 0.4705
PC6 + PC10: CCA score = 0.3235
PC7 + PC8: CCA score = 0.0803
PC7 + PC9: CCA score = 0.4056
PC7 + PC10: CCA score = 0.2187
PC8 + PC9: CCA score = 0.4134
PC8 + PC10: CCA score = 0.2329
PC9 + PC10: CCA score = 0.4608
Best combination: PC4 + PC9 with score 0.5460
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.880/cca_plot_res_0.880.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.880/cca_plot_res_0.880_contributions.png
Created CCA visualization plot using PC4 + PC9 (viz score: 0.5460)
  Null distribution (1000 sims): 2.16 seconds
Resolution 0.880: Standard p-value = 0.0680
TOTAL for resolution 0.880: 41.14 seconds


Testing resolution: 0.890

  Cell clustering: 2.47 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 13
  Pseudobulk computation: 36.17 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.890: CCA Score = 0.7565 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2325
PC1 + PC3: CCA score = 0.3803
PC1 + PC4: CCA score = 0.3138
PC1 + PC5: CCA score = 0.4744
PC1 + PC6: CCA score = 0.2322
PC1 + PC7: CCA score = 0.2371
PC1 + PC8: CCA score = 0.2417
PC1 + PC9: CCA score = 0.3825
PC1 + PC10: CCA score = 0.4079
PC2 + PC3: CCA score = 0.3015
PC2 + PC4: CCA score = 0.2115
PC2 + PC5: CCA score = 0.4140
PC2 + PC6: CCA score = 0.0132
PC2 + PC7: CCA score = 0.0499
PC2 + PC8: CCA score = 0.0685
PC2 + PC9: CCA score = 0.3043
PC2 + PC10: CCA score = 0.3356
PC3 + PC4: CCA score = 0.3678
PC3 + PC5: CCA score = 0.5118
PC3 + PC6: CCA score = 0.3012
PC3 + PC7: CCA score = 0.3050
PC3 + PC8: CCA score = 0.3086
PC3 + PC9: CCA score = 0.4279
PC3 + PC10: CCA score = 0.4507
PC4 + PC5: CCA score = 0.4645
PC4 + PC6: CCA score = 0.2111
PC4 + PC7: CCA score = 0.2165
PC4 + PC8: CCA score = 0.2216
PC4 + PC9: CCA score = 0.3701
PC4 + PC10: CCA score = 0.3963
PC5 + PC6: CCA score = 0.4138
PC5 + PC7: CCA score = 0.4165
PC5 + PC8: CCA score = 0.4192
PC5 + PC9: CCA score = 0.5134
PC5 + PC10: CCA score = 0.5326
PC6 + PC7: CCA score = 0.0483
PC6 + PC8: CCA score = 0.0673
PC6 + PC9: CCA score = 0.3040
PC6 + PC10: CCA score = 0.3354
PC7 + PC8: CCA score = 0.0828
PC7 + PC9: CCA score = 0.3078
PC7 + PC10: CCA score = 0.3388
PC8 + PC9: CCA score = 0.3114
PC8 + PC10: CCA score = 0.3420
PC9 + PC10: CCA score = 0.4526
Best combination: PC5 + PC10 with score 0.5326
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.890/cca_plot_res_0.890.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.890/cca_plot_res_0.890_contributions.png
Created CCA visualization plot using PC5 + PC10 (viz score: 0.5326)
  Null distribution (1000 sims): 2.15 seconds
Resolution 0.890: Standard p-value = 0.0570
TOTAL for resolution 0.890: 41.97 seconds


Testing resolution: 0.910

  Cell clustering: 2.70 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 14
  Pseudobulk computation: 37.49 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.910: CCA Score = 0.7113 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.1680
PC1 + PC3: CCA score = 0.1578
PC1 + PC4: CCA score = 0.3816
PC1 + PC5: CCA score = 0.5481
PC1 + PC6: CCA score = 0.1679
PC1 + PC7: CCA score = 0.1810
PC1 + PC8: CCA score = 0.1459
PC1 + PC9: CCA score = 0.1450
PC1 + PC10: CCA score = 0.2654
PC2 + PC3: CCA score = 0.1066
PC2 + PC4: CCA score = 0.3634
PC2 + PC5: CCA score = 0.5357
PC2 + PC6: CCA score = 0.1212
PC2 + PC7: CCA score = 0.1388
PC2 + PC8: CCA score = 0.0881
PC2 + PC9: CCA score = 0.0866
PC2 + PC10: CCA score = 0.2386
PC3 + PC4: CCA score = 0.3588
PC3 + PC5: CCA score = 0.5325
PC3 + PC6: CCA score = 0.1066
PC3 + PC7: CCA score = 0.1262
PC3 + PC8: CCA score = 0.0666
PC3 + PC9: CCA score = 0.0647
PC3 + PC10: CCA score = 0.2315
PC4 + PC5: CCA score = 0.6358
PC4 + PC6: CCA score = 0.3634
PC4 + PC7: CCA score = 0.3696
PC4 + PC8: CCA score = 0.3537
PC4 + PC9: CCA score = 0.3534
PC4 + PC10: CCA score = 0.4175
PC5 + PC6: CCA score = 0.5356
PC5 + PC7: CCA score = 0.5399
PC5 + PC8: CCA score = 0.5291
PC5 + PC9: CCA score = 0.5289
PC5 + PC10: CCA score = 0.5737
PC6 + PC7: CCA score = 0.1387
PC6 + PC8: CCA score = 0.0880
PC6 + PC9: CCA score = 0.0866
PC6 + PC10: CCA score = 0.2386
PC7 + PC8: CCA score = 0.1110
PC7 + PC9: CCA score = 0.1099
PC7 + PC10: CCA score = 0.2480
PC8 + PC9: CCA score = 0.0239
PC8 + PC10: CCA score = 0.2236
PC9 + PC10: CCA score = 0.2230
Best combination: PC4 + PC5 with score 0.6358
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.910/cca_plot_res_0.910.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.910/cca_plot_res_0.910_contributions.png
Created CCA visualization plot using PC4 + PC5 (viz score: 0.6358)
  Null distribution (1000 sims): 2.15 seconds
Resolution 0.910: Standard p-value = 0.2080
TOTAL for resolution 0.910: 43.55 seconds


Testing resolution: 0.920

  Cell clustering: 2.62 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 13
  Pseudobulk computation: 36.72 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.920: CCA Score = 0.7067 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.1621
PC1 + PC3: CCA score = 0.2120
PC1 + PC4: CCA score = 0.5439
PC1 + PC5: CCA score = 0.1267
PC1 + PC6: CCA score = 0.2104
PC1 + PC7: CCA score = 0.1347
PC1 + PC8: CCA score = 0.2106
PC1 + PC9: CCA score = 0.2830
PC1 + PC10: CCA score = 0.2283
PC2 + PC3: CCA score = 0.2015
PC2 + PC4: CCA score = 0.5398
PC2 + PC5: CCA score = 0.1081
PC2 + PC6: CCA score = 0.1998
PC2 + PC7: CCA score = 0.1174
PC2 + PC8: CCA score = 0.2000
PC2 + PC9: CCA score = 0.2751
PC2 + PC10: CCA score = 0.2185
PC3 + PC4: CCA score = 0.5569
PC3 + PC5: CCA score = 0.1742
PC3 + PC6: CCA score = 0.2420
PC3 + PC7: CCA score = 0.1801
PC3 + PC8: CCA score = 0.2422
PC3 + PC9: CCA score = 0.3072
PC3 + PC10: CCA score = 0.2577
PC4 + PC5: CCA score = 0.5303
PC4 + PC6: CCA score = 0.5562
PC4 + PC7: CCA score = 0.5322
PC4 + PC8: CCA score = 0.5563
PC4 + PC9: CCA score = 0.5875
PC4 + PC10: CCA score = 0.5633
PC5 + PC6: CCA score = 0.1723
PC5 + PC7: CCA score = 0.0595
PC5 + PC8: CCA score = 0.1725
PC5 + PC9: CCA score = 0.2559
PC5 + PC10: CCA score = 0.1937
PC6 + PC7: CCA score = 0.1782
PC6 + PC8: CCA score = 0.2408
PC6 + PC9: CCA score = 0.3061
PC6 + PC10: CCA score = 0.2564
PC7 + PC8: CCA score = 0.1785
PC7 + PC9: CCA score = 0.2599
PC7 + PC10: CCA score = 0.1990
PC8 + PC9: CCA score = 0.3062
PC8 + PC10: CCA score = 0.2566
PC9 + PC10: CCA score = 0.3187
Best combination: PC4 + PC9 with score 0.5875
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.920/cca_plot_res_0.920.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.920/cca_plot_res_0.920_contributions.png
Created CCA visualization plot using PC4 + PC9 (viz score: 0.5875)
  Null distribution (1000 sims): 2.14 seconds
Resolution 0.920: Standard p-value = 0.2490
TOTAL for resolution 0.920: 42.67 seconds

FINE SEARCH TOTAL: 169.34 seconds

=== GENERATING CORRECTED NULL DISTRIBUTION ===
Accounting for resolution selection bias...
  Corrected null distribution generation: 0.00 seconds
Corrected null distribution saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/corrected_null/corrected_null_distribution_expression.npy

=== COMPUTING CORRECTED P-VALUES ===
  Corrected p-values computation: 6.96 seconds
Corrected null distribution plot saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/corrected_null/corrected_null_distribution.png
CORRECTED P-VALUES TOTAL: 7.44 seconds

=== FINAL RESULTS ===
Best resolution: 0.900
Best CCA score: 0.8228
Number of clusters at best resolution: 15
Number of PCs used: 10
Best visualization used PC2 + PC4
Standard p-value: 0.0060
Corrected p-value: 0.0880
Summary plot saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/summary/summary/resolution_optimization_summary_X_DR_expression.png
Summary report saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/summary/summary/optimization_results_X_DR_expression.txt
Detailed results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/summary/summary/detailed_results_X_DR_expression.csv

All results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/summary/all_resolution_results_expression.csv
Optimal resolution pseudobulk saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/summary/optimal.h5ad

Final summary saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/FINAL_SUMMARY.txt

[Find Optimal Resolution RNA-seq Linux] Total runtime: 527.78 seconds

PERFORMANCE SUMMARY:
  Setup: 0.0s
  Coarse search: 349.8s (66.3%)
  Fine search: 169.3s (32.1%)
  Corrected p-values: 7.4s (1.4%)
[Replace DR] Starting dimension reduction replacement...
[Replace DR] File paths:
  - Optimal expression: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/summary/optimal.h5ad
  - Optimal proportion: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/summary/optimal.h5ad
  - Pseudobulk sample: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/pseudobulk/pseudobulk_sample.h5ad

[Replace DR] Loading files...
  ✓ Optimal expression loaded: (25, 2000)
  ✓ Optimal proportion loaded: (25, 2000)
  ✓ Pseudobulk sample loaded: (25, 2000)

[Replace DR] Replacing expression dimension reduction results...
  ✓ Copied .uns['X_DR_expression'] (shape: (25, 10))
  ✓ Copied .uns['X_DR_expression_variance'] (shape: (10,))
  ✓ Copied .uns['X_DR_expression_variance_ratio'] (shape: (10,))
  ✓ Copied .uns['X_pca_expression_method'] (shape: (25, 10))
  ✓ Copied .obsm['X_DR_expression'] (shape: (25, 10))
  ✓ Copied .obsm['X_pca_expression_method'] (shape: (25, 10))

[Replace DR] Replacing proportion dimension reduction results...
  ✓ Copied .uns['X_DR_proportion'] (shape: (25, 5))
  ✓ Copied .uns['X_DR_proportion_variance_ratio'] (shape: (5,))
  ✓ Copied .uns['pca_proportion_variance_ratio'] (shape: (5,))
  ✓ Copied .obsm['X_DR_proportion'] (shape: (25, 5))
  ✓ Copied .obsm['X_pca_proportion'] (shape: (25, 5))

[Replace DR] Saving updated pseudobulk_sample...
  Destination: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/pseudobulk/pseudobulk_sample.h5ad
  ✓ Successfully saved (0.7 MB)

[Replace DR] === SUMMARY ===
  Expression DR keys copied: 6
  Proportion DR keys copied: 5
  File updated: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/pseudobulk/pseudobulk_sample.h5ad

Running sample distance: cosine

[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Computing cosine distance using dimension reduction results...
Data type: ATAC (affects DR method prioritization)
Available sample metadata columns: ['study', 'age', 'sex', 'severity', 'batch', 'sev.level', 'predicted_doublet']
Number of samples: 25
Computing sample distances using expression dimension reduction (X_DR_expression)...
Distance check results saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/cosine/expression_DR_distance/distance_check_results_expression_DR_cosine.txt
Score for expression_DR (cosine): 1.081310
Summary updated in /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/summary_sample.csv
Distance check completed for expression_DR: score = 1.081310
Sample distance heatmap saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/cosine/expression_DR_distance/sample_distance_expression_DR_heatmap.pdf
expression_DR-based distance matrix saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/cosine/expression_DR_distance
Computing sample distances using proportion dimension reduction (X_DR_proportion)...
Distance check results saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/cosine/proportion_DR_distance/distance_check_results_proportion_DR_cosine.txt
Score for proportion_DR (cosine): 1.084297
Summary updated in /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/summary_sample.csv
Distance check completed for proportion_DR: score = 1.084297
Sample distance heatmap saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/cosine/proportion_DR_distance/sample_distance_proportion_DR_heatmap.pdf
proportion_DR-based distance matrix saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/cosine/proportion_DR_distance
Sample distance computations completed for: expression_DR, proportion_DR
Distance statistics summary saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/cosine/distance_statistics_summary_cosine.csv

Running sample distance: correlation

[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Computing correlation distance using dimension reduction results...
Data type: ATAC (affects DR method prioritization)
Available sample metadata columns: ['study', 'age', 'sex', 'severity', 'batch', 'sev.level', 'predicted_doublet']
Number of samples: 25
Computing sample distances using expression dimension reduction (X_DR_expression)...
Distance check results saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/correlation/expression_DR_distance/distance_check_results_expression_DR_correlation.txt
Score for expression_DR (correlation): 1.022866
Summary updated in /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/summary_sample.csv
Distance check completed for expression_DR: score = 1.022866
Sample distance heatmap saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/correlation/expression_DR_distance/sample_distance_expression_DR_heatmap.pdf
expression_DR-based distance matrix saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/correlation/expression_DR_distance
Computing sample distances using proportion dimension reduction (X_DR_proportion)...
Distance check results saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/correlation/proportion_DR_distance/distance_check_results_proportion_DR_correlation.txt
Score for proportion_DR (correlation): 1.089822
Summary updated in /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/summary_sample.csv
Distance check completed for proportion_DR: score = 1.089822
Sample distance heatmap saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/correlation/proportion_DR_distance/sample_distance_proportion_DR_heatmap.pdf
proportion_DR-based distance matrix saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/correlation/proportion_DR_distance
Sample distance computations completed for: expression_DR, proportion_DR
Distance statistics summary saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/correlation/distance_statistics_summary_correlation.csv
Sample distance calculation completed. Results saved in /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance
Starting trajectory analysis...
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42

Processing X_DR_proportion...
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Warning: Only 5 components available, using all of them.
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3317
PC1 + PC3: CCA score = 0.3991
PC1 + PC4: CCA score = 0.4350
PC1 + PC5: CCA score = 0.3439
PC2 + PC3: CCA score = 0.3448
PC2 + PC4: CCA score = 0.3411
PC2 + PC5: CCA score = 0.2740
PC3 + PC4: CCA score = 0.4051
PC3 + PC5: CCA score = 0.3668
PC4 + PC5: CCA score = 0.3365
Best combination: PC1 + PC4 with score 0.4350
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/CCA/pca_10d_cca_proportion.pdf
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/CCA/pca_10d_cca_proportion_contributions.pdf

Processing X_DR_expression...
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3602
PC1 + PC3: CCA score = 0.3205
PC1 + PC4: CCA score = 0.4713
PC1 + PC5: CCA score = 0.1923
PC1 + PC6: CCA score = 0.2105
PC1 + PC7: CCA score = 0.3339
PC1 + PC8: CCA score = 0.3187
PC1 + PC9: CCA score = 0.3059
PC1 + PC10: CCA score = 0.1705
PC2 + PC3: CCA score = 0.4288
PC2 + PC4: CCA score = 0.5507
PC2 + PC5: CCA score = 0.3437
PC2 + PC6: CCA score = 0.3542
PC2 + PC7: CCA score = 0.4389
PC2 + PC8: CCA score = 0.4275
PC2 + PC9: CCA score = 0.4180
PC2 + PC10: CCA score = 0.3320
PC3 + PC4: CCA score = 0.5255
PC3 + PC5: CCA score = 0.3018
PC3 + PC6: CCA score = 0.3137
PC3 + PC7: CCA score = 0.4069
PC3 + PC8: CCA score = 0.3945
PC3 + PC9: CCA score = 0.3842
PC3 + PC10: CCA score = 0.2883
PC4 + PC5: CCA score = 0.4588
PC4 + PC6: CCA score = 0.4667
PC4 + PC7: CCA score = 0.5338
PC4 + PC8: CCA score = 0.5245
PC4 + PC9: CCA score = 0.5167
PC4 + PC10: CCA score = 0.4500
PC5 + PC6: CCA score = 0.1808
PC5 + PC7: CCA score = 0.3160
PC5 + PC8: CCA score = 0.2999
PC5 + PC9: CCA score = 0.2862
PC5 + PC10: CCA score = 0.1320
PC6 + PC7: CCA score = 0.3274
PC6 + PC8: CCA score = 0.3119
PC6 + PC9: CCA score = 0.2987
PC6 + PC10: CCA score = 0.1573
PC7 + PC8: CCA score = 0.4056
PC7 + PC9: CCA score = 0.3955
PC7 + PC10: CCA score = 0.3032
PC8 + PC9: CCA score = 0.3828
PC8 + PC10: CCA score = 0.2864
PC9 + PC10: CCA score = 0.2720
Best combination: PC2 + PC4 with score 0.5507
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/CCA/pca_10d_cca_expression.pdf
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/CCA/pca_10d_cca_expression_contributions.pdf
Saved proportion pseudotime data to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/CCA/pseudotime_proportion.csv
Saved expression pseudotime data to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/CCA/pseudotime_expression.csv

==================================================
CCA ANALYSIS SUMMARY
==================================================
X_DR_proportion: CCA score = 0.4350 (using PC1 + PC4)
X_DR_expression: CCA score = 0.5507 (using PC2 + PC4)

Total runtime: 1.08 seconds
==================================================
P-value for observed correlation 0.4349801813892994: 0.088
[CCA p-test] Runtime: 1.39 seconds
P-value for observed correlation 0.5506674680345562: 0.017
[CCA p-test] Runtime: 1.40 seconds
Starting visualization...
[_preprocessing] Verified required columns in pseudobulk AnnData: ['sev.level']
Found 13 unique cell types.
Dendrogram saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/visualization/cell_type_dendrogram.png
Generating cell type proportion PCA plots for grouping columns: ['sev.level']
Figure saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/visualization/proportion_embedding_sev.level.png
Proportion embedding plot saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/visualization/proportion_embedding_sev.level.png
Generating cell type expression plots for grouping columns: ['sev.level']
Figure saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/visualization/expression_embedding_sev.level.png
Expression embedding plot saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/visualization/expression_embedding_sev.level.png
[visualization] All requested visualizations saved.
RNA analysis completed successfully!

✓ RNA pipeline completed successfully!

============================================================
PIPELINE EXECUTION SUMMARY
============================================================
RNA Pipeline: ⚠ PARTIAL
  - preprocessing: ✓
  - cell_type_cluster: ✓
  - dimensionality_reduction: ✓
  - sample_distance_calculation: ✓
  - trajectory_analysis: ✓
  - trajectory_dge: ✗
  - cluster_dge: ✗
  - visualization: ✓

Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample
Status file: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/sys_log/main_process_status.json
Execution time: 551.2130 seconds
