Linux system detected with GPU enabled.
[Seed Control] GPU deterministic mode enabled with seed=42
Resuming process from previous progress:
{
    "rna": {
        "preprocessing": true,
        "cell_type_cluster": true,
        "dimensionality_reduction": true,
        "sample_distance_calculation": true,
        "trajectory_analysis": true,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": true
    },
    "atac": {
        "preprocessing": false,
        "cell_type_cluster": false,
        "dimensionality_reduction": false,
        "sample_distance_calculation": false,
        "trajectory_analysis": false,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "multiomics": {
        "glue_integration": false,
        "glue_preprocessing": false,
        "glue_training": false,
        "glue_gene_activity": false,
        "glue_cell_types": false,
        "glue_visualization": false,
        "integration_preprocessing": false,
        "dimensionality_reduction": false,
        "embedding_visualization": false,
        "optimal_resolution": false
    },
    "system_info": {
        "platform": "Linux",
        "python_version": "3.10.18 | packaged by conda-forge | (main, Jun  4 2025, 14:45:41) [GCC 13.3.0]",
        "use_gpu": true,
        "linux_system": true
    }
}

============================================================
RUNNING RNA PIPELINE
============================================================
Starting RNA wrapper function with provided parameters...
Reading Pseudobulk from provided or default path: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/pseudobulk/pseudobulk_sample.h5ad
Starting trajectory analysis...

Processing X_DR_proportion...
Warning: Only 5 components available, using all of them.
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3210
PC1 + PC3: CCA score = 0.3173
PC1 + PC4: CCA score = 0.4134
PC1 + PC5: CCA score = 0.3467
PC2 + PC3: CCA score = 0.0534
PC2 + PC4: CCA score = 0.2703
PC2 + PC5: CCA score = 0.1495
PC3 + PC4: CCA score = 0.2660
PC3 + PC5: CCA score = 0.1414
PC4 + PC5: CCA score = 0.3004
Best combination: PC1 + PC4 with score 0.4134
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/CCA/pca_10d_cca_proportion.pdf
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/CCA/pca_10d_cca_proportion_contributions.pdf

Processing X_DR_expression...
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3028
PC1 + PC3: CCA score = 0.2874
PC1 + PC4: CCA score = 0.2325
PC1 + PC5: CCA score = 0.2218
PC1 + PC6: CCA score = 0.3018
PC1 + PC7: CCA score = 0.2179
PC1 + PC8: CCA score = 0.2613
PC1 + PC9: CCA score = 0.2186
PC1 + PC10: CCA score = 0.2744
PC2 + PC3: CCA score = 0.2818
PC2 + PC4: CCA score = 0.2255
PC2 + PC5: CCA score = 0.2144
PC2 + PC6: CCA score = 0.2964
PC2 + PC7: CCA score = 0.2103
PC2 + PC8: CCA score = 0.2550
PC2 + PC9: CCA score = 0.2111
PC2 + PC10: CCA score = 0.2685
PC3 + PC4: CCA score = 0.2044
PC3 + PC5: CCA score = 0.1921
PC3 + PC6: CCA score = 0.2807
PC3 + PC7: CCA score = 0.1876
PC3 + PC8: CCA score = 0.2366
PC3 + PC9: CCA score = 0.1884
PC3 + PC10: CCA score = 0.2511
PC4 + PC5: CCA score = 0.0914
PC4 + PC6: CCA score = 0.2241
PC4 + PC7: CCA score = 0.0815
PC4 + PC8: CCA score = 0.1656
PC4 + PC9: CCA score = 0.0833
PC4 + PC10: CCA score = 0.1857
PC5 + PC6: CCA score = 0.2129
PC5 + PC7: CCA score = 0.0418
PC5 + PC8: CCA score = 0.1501
PC5 + PC9: CCA score = 0.0453
PC5 + PC10: CCA score = 0.1720
PC6 + PC7: CCA score = 0.2089
PC6 + PC8: CCA score = 0.2538
PC6 + PC9: CCA score = 0.2096
PC6 + PC10: CCA score = 0.2673
PC7 + PC8: CCA score = 0.1443
PC7 + PC9: CCA score = 0.0186
PC7 + PC10: CCA score = 0.1670
PC8 + PC9: CCA score = 0.1454
PC8 + PC10: CCA score = 0.2206
PC9 + PC10: CCA score = 0.1679
Best combination: PC1 + PC2 with score 0.3028
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/CCA/pca_10d_cca_expression.pdf
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/CCA/pca_10d_cca_expression_contributions.pdf
Saved proportion pseudotime data to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/CCA/pseudotime_proportion.csv
Saved expression pseudotime data to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/CCA/pseudotime_expression.csv

==================================================
CCA ANALYSIS SUMMARY
==================================================
X_DR_proportion: CCA score = 0.4134 (using PC1 + PC4)
X_DR_expression: CCA score = 0.3028 (using PC1 + PC2)

Total runtime: 1.36 seconds
==================================================
P-value for observed correlation 0.41341652065009066: 0.008
[CCA p-test] Runtime: 1.54 seconds
P-value for observed correlation 0.30277973809854536: 0.074
[CCA p-test] Runtime: 1.53 seconds
Using PROFILED GPU version of optimal resolution
Directory setup: 0.00 seconds
Starting RNA-seq resolution optimization for X_DR_proportion...
Using representation: X_pca with 20 components
Using 10 PCs for CCA analysis
Testing resolutions from 0.01 to 1.00...
Will compute corrected p-values with 1000 simulations per resolution

=== FIRST PASS: Coarse Search ===


Testing resolution: 0.100

  Cell clustering: 8.37 seconds
  Cell type assignment: 0.01 seconds
Number of clusters: 4
  Pseudobulk computation: 76.18 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.100: CCA Score = 0.3543 (using 4 PCs)
Auto-selecting best 2-PC combination from 4 components...
Testing 6 PC combinations...
PC1 + PC2: CCA score = 0.3468
PC1 + PC3: CCA score = 0.3391
PC1 + PC4: CCA score = 0.3407
PC2 + PC3: CCA score = 0.1136
PC2 + PC4: CCA score = 0.1697
PC3 + PC4: CCA score = 0.2187
Best combination: PC1 + PC2 with score 0.3468
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.100/cca_plot_res_0.100.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.100/cca_plot_res_0.100_contributions.png
Created CCA visualization plot using PC1 + PC2 (viz score: 0.3468)
  Null distribution (1000 sims): 2.22 seconds
Resolution 0.100: Standard p-value = 0.1680
TOTAL for resolution 0.100: 88.07 seconds


Testing resolution: 0.200

  Cell clustering: 6.77 seconds
  Cell type assignment: 0.01 seconds
Number of clusters: 5
  Pseudobulk computation: 91.58 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.200: CCA Score = 0.4757 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3494
PC1 + PC3: CCA score = 0.3408
PC1 + PC4: CCA score = 0.4186
PC1 + PC5: CCA score = 0.4121
PC2 + PC3: CCA score = 0.1092
PC2 + PC4: CCA score = 0.2664
PC2 + PC5: CCA score = 0.2915
PC3 + PC4: CCA score = 0.2550
PC3 + PC5: CCA score = 0.2887
PC4 + PC5: CCA score = 0.3121
Best combination: PC1 + PC4 with score 0.4186
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.200/cca_plot_res_0.200.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.200/cca_plot_res_0.200_contributions.png
Created CCA visualization plot using PC1 + PC4 (viz score: 0.4186)
  Null distribution (1000 sims): 2.02 seconds
Resolution 0.200: Standard p-value = 0.0270
TOTAL for resolution 0.200: 101.62 seconds


Testing resolution: 0.300

  Cell clustering: 6.76 seconds
  Cell type assignment: 0.01 seconds
Number of clusters: 8
  Pseudobulk computation: 144.70 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.300: CCA Score = 0.4907 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3546
PC1 + PC3: CCA score = 0.3507
PC1 + PC4: CCA score = 0.4622
PC1 + PC5: CCA score = 0.3827
PC2 + PC3: CCA score = 0.0583
PC2 + PC4: CCA score = 0.3066
PC2 + PC5: CCA score = 0.1638
PC3 + PC4: CCA score = 0.3021
PC3 + PC5: CCA score = 0.1552
PC4 + PC5: CCA score = 0.3387
Best combination: PC1 + PC4 with score 0.4622
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.300/cca_plot_res_0.300.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.300/cca_plot_res_0.300_contributions.png
Created CCA visualization plot using PC1 + PC4 (viz score: 0.4622)
  Null distribution (1000 sims): 1.98 seconds
Resolution 0.300: Standard p-value = 0.0230
TOTAL for resolution 0.300: 154.57 seconds


Testing resolution: 0.400

  Cell clustering: 6.43 seconds
  Cell type assignment: 0.01 seconds
Number of clusters: 11
  Pseudobulk computation: 173.26 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.400: CCA Score = 0.4925 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3028
PC1 + PC3: CCA score = 0.2980
PC1 + PC4: CCA score = 0.3977
PC1 + PC5: CCA score = 0.4123
PC2 + PC3: CCA score = 0.0553
PC2 + PC4: CCA score = 0.2692
PC2 + PC5: CCA score = 0.2903
PC3 + PC4: CCA score = 0.2637
PC3 + PC5: CCA score = 0.2852
PC4 + PC5: CCA score = 0.3883
Best combination: PC1 + PC5 with score 0.4123
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.400/cca_plot_res_0.400.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.400/cca_plot_res_0.400_contributions.png
Created CCA visualization plot using PC1 + PC5 (viz score: 0.4123)
  Null distribution (1000 sims): 2.07 seconds
Resolution 0.400: Standard p-value = 0.0220
TOTAL for resolution 0.400: 183.05 seconds


Testing resolution: 0.500

  Cell clustering: 6.39 seconds
  Cell type assignment: 0.01 seconds
Number of clusters: 12
  Pseudobulk computation: 176.75 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.500: CCA Score = 0.5099 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3097
PC1 + PC3: CCA score = 0.3048
PC1 + PC4: CCA score = 0.4013
PC1 + PC5: CCA score = 0.4334
PC2 + PC3: CCA score = 0.0604
PC2 + PC4: CCA score = 0.2679
PC2 + PC5: CCA score = 0.3140
PC3 + PC4: CCA score = 0.2623
PC3 + PC5: CCA score = 0.3092
PC4 + PC5: CCA score = 0.4046
Best combination: PC1 + PC5 with score 0.4334
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.500/cca_plot_res_0.500.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.500/cca_plot_res_0.500_contributions.png
Created CCA visualization plot using PC1 + PC5 (viz score: 0.4334)
  Null distribution (1000 sims): 1.98 seconds
Resolution 0.500: Standard p-value = 0.0140
TOTAL for resolution 0.500: 186.24 seconds


Testing resolution: 0.600

  Cell clustering: 6.44 seconds
  Cell type assignment: 0.01 seconds
Number of clusters: 14
  Pseudobulk computation: 210.01 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.600: CCA Score = 0.5117 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3039
PC1 + PC3: CCA score = 0.3013
PC1 + PC4: CCA score = 0.4068
PC1 + PC5: CCA score = 0.4302
PC2 + PC3: CCA score = 0.0433
PC2 + PC4: CCA score = 0.2767
PC2 + PC5: CCA score = 0.3102
PC3 + PC4: CCA score = 0.2738
PC3 + PC5: CCA score = 0.3076
PC4 + PC5: CCA score = 0.4115
Best combination: PC1 + PC5 with score 0.4302
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.600/cca_plot_res_0.600.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.600/cca_plot_res_0.600_contributions.png
Created CCA visualization plot using PC1 + PC5 (viz score: 0.4302)
  Null distribution (1000 sims): 3.05 seconds
Resolution 0.600: Standard p-value = 0.0170
TOTAL for resolution 0.600: 221.08 seconds


Testing resolution: 0.700

  Cell clustering: 6.95 seconds
  Cell type assignment: 0.01 seconds
Number of clusters: 15
