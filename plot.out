Linux system detected with GPU enabled.
Initializing main process status file.

============================================================
RUNNING RNA PIPELINE
============================================================
Starting RNA wrapper function with provided parameters...
Starting preprocessing...
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
=== Reading input dataset ===
Raw shape: 99438 cells Ã— 38606 genes
=== Merging sample-level metadata into adata.obs ===
   ðŸ“„ Reading CSV metadata file: /dcs07/hongkai/data/harry/result/multi_omics_heart/data/multi_omics_heart_sample_meta.csv
   âœ… Added 11 new metadata columns
   ðŸ”— Matched 99438/99438 entries (100.0%)
All required columns are present in adata.obs.
=== Processing data for clustering ===
Running HVG selection on CPU...
After HVG: 34273 cells Ã— 2000 genes
Moving to GPU for normalization, PCA, and Harmony...
=== [GPU] Running Harmony integration ===
Variables to regress: sample
Use GPU mode.
	Initialization is completed.
	Completed 1 / 30 iteration(s).
	Completed 2 / 30 iteration(s).
	Completed 3 / 30 iteration(s).
	Completed 4 / 30 iteration(s).
	Completed 5 / 30 iteration(s).
Reach convergence after 5 iteration(s).
End of harmony for adata_cluster.
[safe_h5ad_write] Preparing to save to: /dcs07/hongkai/data/harry/result/Benchmark_heart_rna/rna/preprocess/adata_cell.h5ad
[clean_obs_for_saving] Cleaning observation metadata for H5AD compatibility...
[clean_obs_for_saving] Cleaning completed successfully
[clean_obs_for_saving] 12 categorical columns processed
[safe_h5ad_write] Writing H5AD file...
[safe_h5ad_write] Successfully saved to: /dcs07/hongkai/data/harry/result/Benchmark_heart_rna/rna/preprocess/adata_cell.h5ad
=== [CPU] Processing data for sample differences ===
Saving original expression matrix (temporary variable)
Normalizing and PCA on CPU...
