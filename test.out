Resuming process from previous progress:
{
    "rna": {
        "preprocessing": true,
        "cell_type_cluster": true,
        "dimensionality_reduction": true,
        "sample_distance_calculation": false,
        "trajectory_analysis": true,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "atac": {
        "preprocessing": false,
        "cell_type_cluster": false,
        "dimensionality_reduction": false,
        "sample_distance_calculation": false,
        "trajectory_analysis": false,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "multiomics": {
        "glue_integration": false,
        "glue_preprocessing": false,
        "glue_training": false,
        "glue_gene_activity": false,
        "glue_cell_types": false,
        "glue_visualization": false,
        "integration_preprocessing": false,
        "dimensionality_reduction": false,
        "embedding_visualization": false,
        "optimal_resolution": false
    },
    "system_info": {
        "platform": "Linux",
        "python_version": "3.10.18 | packaged by conda-forge | (main, Jun  4 2025, 14:45:41) [GCC 13.3.0]",
        "use_gpu": false,
        "linux_system": false
    }
}

============================================================
RUNNING RNA PIPELINE
============================================================
Starting RNA wrapper function with provided parameters...
Starting preprocessing...
=== Reading input dataset ===
Raw shape: 46712 cells × 14881 genes
All required columns are present in adata.obs.
Type of adata.X: <class 'scipy.sparse._csc.csc_matrix'>
adata.X dtype: float64
adata.X is sparse: True
Converting adata.X from float64 to float32
After initial filtering: 46570 cells × 9943 genes
After mitochondrial filtering: 46516 cells × 9943 genes
After gene exclusion filtering: 46516 cells × 9930 genes
After sample filtering: 46516 cells × 9930 genes
Number of samples remaining: 25
After final gene filtering: 46516 cells × 9930 genes
Processed shape: 46516 cells × 9930 genes
Preprocessing complete!
=== [CPU] Processing data for clustering ===
=== [CPU] Running Harmony integration ===
Variables to regress: sample
	Initialization is completed.
	Completed 1 / 30 iteration(s).
	Completed 2 / 30 iteration(s).
	Completed 3 / 30 iteration(s).
	Completed 4 / 30 iteration(s).
	Completed 5 / 30 iteration(s).
	Completed 6 / 30 iteration(s).
	Completed 7 / 30 iteration(s).
	Completed 8 / 30 iteration(s).
	Completed 9 / 30 iteration(s).
Reach convergence after 9 iteration(s).
End of harmony for adata_cluster.
=== [CPU] Processing data for sample differences ===
Total runtime: 125.70 seconds
Starting cell type clustering at resolution: 0.7
[cell_types] No cell type annotation found. Performing clustering.
[cell_types] Building neighborhood graph...
[cell_types] No target clusters specified. Using standard Leiden clustering (resolution=0.7)...
[cell_types] Found 10 clusters after Leiden clustering.
[cell_types] Finished assigning cell types.
[cell_types] Computing UMAP...
[cell_types] Generating UMAP visualizations...
[generate_umap_visualizations] Generating UMAP plots...
[generate_umap_visualizations] → Plotting UMAP colored by 'cell_type' (10 categories)
[generate_umap_visualizations] ✓ Saved: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/preprocess/umap_cell_type.png
[cell_types] Saved AnnData object to /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/preprocess/adata_cell.h5ad
[cell_types] Total runtime: 27.50 seconds
[cell_types] Saved AnnData object to /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/preprocess/adata_sample.h5ad
Starting dimensionality reduction...
Processing 10 cell types across 25 samples
Creating layer for 1
Creating layer for 10
Creating layer for 2
Creating layer for 3
Creating layer for 4
Creating layer for 5
Creating layer for 6
Creating layer for 7
Creating layer for 8
Creating layer for 9

Processing cell type: 1
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 10
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 2
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 3
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 4
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 5
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 6
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 7
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 8
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 9
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Concatenating all cell type HVGs into single AnnData
Applying final HVG selection on 20000 concatenated genes
Final HVG selection: 2000 genes

Creating final HVG expression matrix

Total runtime: 17.68 seconds
Final HVG matrix shape: (10, 25)
Final AnnData shape: (25, 2000)
[process_anndata_with_dimension_reduction] Starting dimension reduction computation...
[process_anndata_with_dimension_reduction] Results will be stored under unified keys:
  - X_DR_expression: for expression data
  - X_DR_proportion: for proportion data
[process_anndata_with_dimension_reduction] RNA mode: Will use PCA for expression data
[process_anndata_with_dimension_reduction] ✓ Created output directories:
  - count_output_dir: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/preprocess
  - pseudobulk_output_dir: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/pseudobulk
[process_anndata_with_dimension_reduction] Using n_expression_components=10, n_proportion_components=5
[process_anndata_with_dimension_reduction] Data dimensions: expression=(25, 2000), proportion=(25, 10)
[DimRed] Computing PCA for RNA data with 10 components on (25, 2000) data
[PCA] Success. Shape: (25, 10)
[Storage] Stored X_DR_expression in both adata and pseudobulk_anndata (shape: (25, 10))
[Storage] Stored X_pca_expression_method in both adata and pseudobulk_anndata (shape: (25, 10))
[PCA] Stored variance information in both objects
[DimRed] Completed - results stored as X_DR_expression in both adata and pseudobulk_anndata
[process_anndata_with_dimension_reduction] ✓ Expression dimension reduction completed successfully
[run_dimension_reduction_proportion] Computing PCA with 5 components...
[run_dimension_reduction_proportion] Harmony failed: No module named 'harmonypy'. Using PCA only.
[run_dimension_reduction_proportion] Completed using PCA. Shape: (25, 5)
[process_anndata_with_dimension_reduction] ✓ Proportion dimension reduction completed successfully
[process_anndata_with_dimension_reduction] Preparing to save results...
[process_anndata_with_dimension_reduction] Target file paths:
  - adata: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/preprocess/adata_sample.h5ad
  - pseudobulk_anndata: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/pseudobulk/pseudobulk_sample.h5ad
[Save] Saving adata to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/preprocess/adata_sample.h5ad
[Save] ✓ Successfully saved adata (207.0 MB)
[Save] Saving pseudobulk_anndata to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/pseudobulk/pseudobulk_sample.h5ad
[Save] ✓ Successfully saved pseudobulk_anndata (0.4 MB)
[process_anndata_with_dimension_reduction] ✓ All files saved successfully

[process_anndata_with_dimension_reduction] === SUMMARY ===
Total runtime: 14.65 seconds
Expression dimension reduction: ✓ SUCCESS
Proportion dimension reduction: ✓ SUCCESS
Results available under unified keys:
  - X_DR_expression in both adata.uns and pseudobulk_anndata.uns
  - X_DR_proportion in both adata.uns and pseudobulk_anndata.uns
File saving: ✓ ATTEMPTED
Starting trajectory analysis...

Processing X_DR_proportion...
Warning: Only 5 components available, using all of them.
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3496
PC1 + PC3: CCA score = 0.3853
PC1 + PC4: CCA score = 0.3319
PC1 + PC5: CCA score = 0.3133
PC2 + PC3: CCA score = 0.2796
PC2 + PC4: CCA score = 0.1997
PC2 + PC5: CCA score = 0.1669
PC3 + PC4: CCA score = 0.2571
PC3 + PC5: CCA score = 0.2326
PC4 + PC5: CCA score = 0.1256
Best combination: PC1 + PC3 with score 0.3853
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/CCA/pca_10d_cca_proportion.pdf

Processing X_DR_expression...
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.5942
PC1 + PC3: CCA score = 0.2000
PC1 + PC4: CCA score = 0.1944
PC1 + PC5: CCA score = 0.1806
PC1 + PC6: CCA score = 0.2624
PC1 + PC7: CCA score = 0.2470
PC1 + PC8: CCA score = 0.2156
PC1 + PC9: CCA score = 0.3743
PC1 + PC10: CCA score = 0.1807
PC2 + PC3: CCA score = 0.5727
PC2 + PC4: CCA score = 0.5707
PC2 + PC5: CCA score = 0.5662
PC2 + PC6: CCA score = 0.5973
PC2 + PC7: CCA score = 0.5907
PC2 + PC8: CCA score = 0.5783
PC2 + PC9: CCA score = 0.6543
PC2 + PC10: CCA score = 0.5662
PC3 + PC4: CCA score = 0.1123
PC3 + PC5: CCA score = 0.0862
PC3 + PC6: CCA score = 0.2089
PC3 + PC7: CCA score = 0.1893
PC3 + PC8: CCA score = 0.1459
PC3 + PC9: CCA score = 0.3390
PC3 + PC10: CCA score = 0.0864
PC4 + PC5: CCA score = 0.0723
PC4 + PC6: CCA score = 0.2036
PC4 + PC7: CCA score = 0.1834
PC4 + PC8: CCA score = 0.1382
PC4 + PC9: CCA score = 0.3357
PC4 + PC10: CCA score = 0.0726
PC5 + PC6: CCA score = 0.1904
PC5 + PC7: CCA score = 0.1687
PC5 + PC8: CCA score = 0.1179
PC5 + PC9: CCA score = 0.3279
PC5 + PC10: CCA score = 0.0090
PC6 + PC7: CCA score = 0.2543
PC6 + PC8: CCA score = 0.2239
PC6 + PC9: CCA score = 0.3792
PC6 + PC10: CCA score = 0.1906
PC7 + PC8: CCA score = 0.2057
PC7 + PC9: CCA score = 0.3687
PC7 + PC10: CCA score = 0.1688
PC8 + PC9: CCA score = 0.3484
PC8 + PC10: CCA score = 0.1181
PC9 + PC10: CCA score = 0.3280
Best combination: PC2 + PC9 with score 0.6543
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/CCA/pca_10d_cca_expression.pdf
Saved proportion pseudotime data to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/CCA/pseudotime_proportion.csv
Saved expression pseudotime data to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/CCA/pseudotime_expression.csv

==================================================
CCA ANALYSIS SUMMARY
==================================================
X_DR_proportion: CCA score = 0.3853 (using PC1 + PC3)
X_DR_expression: CCA score = 0.6543 (using PC2 + PC9)

Total runtime: 0.93 seconds
==================================================
P-value for observed correlation 0.38528561998115785: 0.157
[CCA p-test] Runtime: 0.72 seconds
P-value for observed correlation 0.6542554057668079: 0.0
[CCA p-test] Runtime: 0.71 seconds
Starting RNA-seq resolution optimization for X_DR_proportion...
Using representation: X_pca with 20 components
Using 10 PCs for CCA analysis
Testing resolutions from 0.01 to 1.00...
Will compute corrected p-values with 1000 simulations per resolution

=== FIRST PASS: Coarse Search ===


Testing resolution: 0.10

Number of clusters: 4
Resolution 0.10: CCA Score = 0.3352 (using 4 PCs)
Auto-selecting best 2-PC combination from 4 components...
Testing 6 PC combinations...
PC1 + PC2: CCA score = 0.3221
PC1 + PC3: CCA score = 0.2749
PC1 + PC4: CCA score = 0.2663
PC2 + PC3: CCA score = 0.2036
PC2 + PC4: CCA score = 0.1918
PC3 + PC4: CCA score = 0.0931
Best combination: PC1 + PC2 with score 0.3221
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.10/cca_plot_res_0.10.png
Created CCA visualization plot using PC1 + PC2 (viz score: 0.3221)
Resolution 0.10: Standard p-value = 0.6570


Testing resolution: 0.20

Number of clusters: 5
Resolution 0.20: CCA Score = 0.3457 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3296
PC1 + PC3: CCA score = 0.2782
PC1 + PC4: CCA score = 0.2672
PC1 + PC5: CCA score = 0.2633
PC2 + PC3: CCA score = 0.2188
PC2 + PC4: CCA score = 0.2046
PC2 + PC5: CCA score = 0.1995
PC3 + PC4: CCA score = 0.1029
PC3 + PC5: CCA score = 0.0924
PC4 + PC5: CCA score = 0.0503
Best combination: PC1 + PC2 with score 0.3296
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.20/cca_plot_res_0.20.png
Created CCA visualization plot using PC1 + PC2 (viz score: 0.3296)
Resolution 0.20: Standard p-value = 0.7590


Testing resolution: 0.30

Number of clusters: 7
Resolution 0.30: CCA Score = 0.4161 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3330
PC1 + PC3: CCA score = 0.3390
PC1 + PC4: CCA score = 0.3013
PC1 + PC5: CCA score = 0.2694
PC2 + PC3: CCA score = 0.2860
PC2 + PC4: CCA score = 0.2401
PC2 + PC5: CCA score = 0.1986
PC3 + PC4: CCA score = 0.2485
PC3 + PC5: CCA score = 0.2086
PC4 + PC5: CCA score = 0.1392
Best combination: PC1 + PC3 with score 0.3390
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.30/cca_plot_res_0.30.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3390)
Resolution 0.30: Standard p-value = 0.5960


Testing resolution: 0.40

Number of clusters: 9
Resolution 0.40: CCA Score = 0.4312 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3408
PC1 + PC3: CCA score = 0.3683
PC1 + PC4: CCA score = 0.3148
PC1 + PC5: CCA score = 0.2874
PC2 + PC3: CCA score = 0.2946
PC2 + PC4: CCA score = 0.2240
PC2 + PC5: CCA score = 0.1837
PC3 + PC4: CCA score = 0.2641
PC3 + PC5: CCA score = 0.2308
PC4 + PC5: CCA score = 0.1292
Best combination: PC1 + PC3 with score 0.3683
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.40/cca_plot_res_0.40.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3683)
Resolution 0.40: Standard p-value = 0.5320


Testing resolution: 0.50

Number of clusters: 10
Resolution 0.50: CCA Score = 0.4333 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3447
PC1 + PC3: CCA score = 0.3787
PC1 + PC4: CCA score = 0.3148
PC1 + PC5: CCA score = 0.3054
PC2 + PC3: CCA score = 0.2904
PC2 + PC4: CCA score = 0.2001
PC2 + PC5: CCA score = 0.1850
PC3 + PC4: CCA score = 0.2542
PC3 + PC5: CCA score = 0.2424
PC4 + PC5: CCA score = 0.1203
Best combination: PC1 + PC3 with score 0.3787
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.50/cca_plot_res_0.50.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3787)
Resolution 0.50: Standard p-value = 0.5020


Testing resolution: 0.60

Number of clusters: 9
Resolution 0.60: CCA Score = 0.4338 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3519
PC1 + PC3: CCA score = 0.3881
PC1 + PC4: CCA score = 0.3224
PC1 + PC5: CCA score = 0.3126
PC2 + PC3: CCA score = 0.2872
PC2 + PC4: CCA score = 0.1893
PC2 + PC5: CCA score = 0.1720
PC3 + PC4: CCA score = 0.2502
PC3 + PC5: CCA score = 0.2374
PC4 + PC5: CCA score = 0.0985
Best combination: PC1 + PC3 with score 0.3881
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.60/cca_plot_res_0.60.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3881)
Resolution 0.60: Standard p-value = 0.5200


Testing resolution: 0.70

Number of clusters: 10
Resolution 0.70: CCA Score = 0.4361 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3496
PC1 + PC3: CCA score = 0.3853
PC1 + PC4: CCA score = 0.3319
PC1 + PC5: CCA score = 0.3133
PC2 + PC3: CCA score = 0.2796
PC2 + PC4: CCA score = 0.1997
PC2 + PC5: CCA score = 0.1669
PC3 + PC4: CCA score = 0.2571
PC3 + PC5: CCA score = 0.2326
PC4 + PC5: CCA score = 0.1256
Best combination: PC1 + PC3 with score 0.3853
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.70/cca_plot_res_0.70.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3853)
Resolution 0.70: Standard p-value = 0.5250


Testing resolution: 0.80

Number of clusters: 14
Resolution 0.80: CCA Score = 0.4442 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3385
PC1 + PC3: CCA score = 0.3825
PC1 + PC4: CCA score = 0.3324
PC1 + PC5: CCA score = 0.3063
PC2 + PC3: CCA score = 0.2869
PC2 + PC4: CCA score = 0.2157
PC2 + PC5: CCA score = 0.1728
PC3 + PC4: CCA score = 0.2797
PC3 + PC5: CCA score = 0.2481
PC4 + PC5: CCA score = 0.1606
Best combination: PC1 + PC3 with score 0.3825
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.80/cca_plot_res_0.80.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3825)
Resolution 0.80: Standard p-value = 0.4720


Testing resolution: 0.90

Number of clusters: 13
Resolution 0.90: CCA Score = 0.4642 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3459
PC1 + PC3: CCA score = 0.4021
PC1 + PC4: CCA score = 0.3419
PC1 + PC5: CCA score = 0.3346
PC2 + PC3: CCA score = 0.2913
PC2 + PC4: CCA score = 0.2003
PC2 + PC5: CCA score = 0.1874
PC3 + PC4: CCA score = 0.2866
PC3 + PC5: CCA score = 0.2778
PC4 + PC5: CCA score = 0.1800
Best combination: PC1 + PC3 with score 0.4021
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.90/cca_plot_res_0.90.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.4021)
Resolution 0.90: Standard p-value = 0.4260


Testing resolution: 1.00

Number of clusters: 14
Resolution 1.00: CCA Score = 0.4313 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3313
PC1 + PC3: CCA score = 0.3603
PC1 + PC4: CCA score = 0.3183
PC1 + PC5: CCA score = 0.2883
PC2 + PC3: CCA score = 0.2845
PC2 + PC4: CCA score = 0.2290
PC2 + PC5: CCA score = 0.1850
PC3 + PC4: CCA score = 0.2693
PC3 + PC5: CCA score = 0.2330
PC4 + PC5: CCA score = 0.1606
Best combination: PC1 + PC3 with score 0.3603
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_1.00/cca_plot_res_1.00.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3603)
Resolution 1.00: Standard p-value = 0.5190

Best resolution from first pass: 0.90
Best CCA score: 0.4642

=== SECOND PASS: Fine-tuned Search ===
Fine-tuning search from 0.89 to 0.91...

Testing fine-tuned resolution: 0.890
Error at fine-tuned resolution 0.890: cell_types() got an unexpected keyword argument 'cell_column'

Testing fine-tuned resolution: 0.910
Error at fine-tuned resolution 0.910: cell_types() got an unexpected keyword argument 'cell_column'

=== GENERATING CORRECTED NULL DISTRIBUTION ===
Accounting for resolution selection bias...
Corrected null distribution saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/corrected_null/corrected_null_distribution_proportion.npy

=== COMPUTING CORRECTED P-VALUES ===
Corrected null distribution plot saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/corrected_null/corrected_null_distribution.png

=== FINAL RESULTS ===
Best resolution: 0.900
Best CCA score: 0.4642
Number of clusters at best resolution: 13
Number of PCs used: 5
Best visualization used PC1 + PC3
Standard p-value: 0.4260
Corrected p-value: 0.9980

All results saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/all_resolution_results_proportion.csv

Final summary saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/FINAL_SUMMARY.txt

[Find Optimal Resolution RNA-seq] Total runtime: 401.40 seconds

Starting RNA-seq resolution optimization for X_DR_expression...
Using representation: X_pca with 20 components
Using 10 PCs for CCA analysis
Testing resolutions from 0.01 to 1.00...
Will compute corrected p-values with 1000 simulations per resolution

=== FIRST PASS: Coarse Search ===


Testing resolution: 0.10

Number of clusters: 4
Resolution 0.10: CCA Score = 0.7880 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.5597
PC1 + PC3: CCA score = 0.4378
PC1 + PC4: CCA score = 0.1973
PC1 + PC5: CCA score = 0.2434
PC1 + PC6: CCA score = 0.2554
PC1 + PC7: CCA score = 0.2074
PC1 + PC8: CCA score = 0.2598
PC1 + PC9: CCA score = 0.2047
PC1 + PC10: CCA score = 0.3331
PC2 + PC3: CCA score = 0.6537
PC2 + PC4: CCA score = 0.5240
PC2 + PC5: CCA score = 0.5430
PC2 + PC6: CCA score = 0.5485
PC2 + PC7: CCA score = 0.5278
PC2 + PC8: CCA score = 0.5505
PC2 + PC9: CCA score = 0.5268
PC2 + PC10: CCA score = 0.5887
PC3 + PC4: CCA score = 0.3911
PC3 + PC5: CCA score = 0.4163
PC3 + PC6: CCA score = 0.4234
PC3 + PC7: CCA score = 0.3962
PC3 + PC8: CCA score = 0.4260
PC3 + PC9: CCA score = 0.3949
PC3 + PC10: CCA score = 0.4743
PC4 + PC5: CCA score = 0.1431
PC4 + PC6: CCA score = 0.1626
PC4 + PC7: CCA score = 0.0651
PC4 + PC8: CCA score = 0.1694
PC4 + PC9: CCA score = 0.0561
PC4 + PC10: CCA score = 0.2687
PC5 + PC6: CCA score = 0.2163
PC5 + PC7: CCA score = 0.1567
PC5 + PC8: CCA score = 0.2214
PC5 + PC9: CCA score = 0.1532
PC5 + PC10: CCA score = 0.3042
PC6 + PC7: CCA score = 0.1747
PC6 + PC8: CCA score = 0.2345
PC6 + PC9: CCA score = 0.1716
PC6 + PC10: CCA score = 0.3139
PC7 + PC8: CCA score = 0.1810
PC7 + PC9: CCA score = 0.0849
PC7 + PC10: CCA score = 0.2762
PC8 + PC9: CCA score = 0.1780
PC8 + PC10: CCA score = 0.3174
PC9 + PC10: CCA score = 0.2742
Best combination: PC2 + PC3 with score 0.6537
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.10/cca_plot_res_0.10.png
Created CCA visualization plot using PC2 + PC3 (viz score: 0.6537)
Resolution 0.10: Standard p-value = 0.0330


Testing resolution: 0.20

Number of clusters: 5
Resolution 0.20: CCA Score = 0.7574 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.5108
PC1 + PC3: CCA score = 0.3743
PC1 + PC4: CCA score = 0.3704
PC1 + PC5: CCA score = 0.3933
PC1 + PC6: CCA score = 0.6036
PC1 + PC7: CCA score = 0.3726
PC1 + PC8: CCA score = 0.3864
PC1 + PC9: CCA score = 0.4308
PC1 + PC10: CCA score = 0.3743
PC2 + PC3: CCA score = 0.3558
PC2 + PC4: CCA score = 0.3518
PC2 + PC5: CCA score = 0.3758
PC2 + PC6: CCA score = 0.5923
PC2 + PC7: CCA score = 0.3541
PC2 + PC8: CCA score = 0.3686
PC2 + PC9: CCA score = 0.4148
PC2 + PC10: CCA score = 0.3558
PC3 + PC4: CCA score = 0.0542
PC3 + PC5: CCA score = 0.1429
PC3 + PC6: CCA score = 0.4796
PC3 + PC7: CCA score = 0.0675
PC3 + PC8: CCA score = 0.1227
PC3 + PC9: CCA score = 0.2265
PC3 + PC10: CCA score = 0.0762
PC4 + PC5: CCA score = 0.1325
PC4 + PC6: CCA score = 0.4766
PC4 + PC7: CCA score = 0.0412
PC4 + PC8: CCA score = 0.1105
PC4 + PC9: CCA score = 0.2200
PC4 + PC10: CCA score = 0.0543
PC5 + PC6: CCA score = 0.4947
PC5 + PC7: CCA score = 0.1385
PC5 + PC8: CCA score = 0.1723
PC5 + PC9: CCA score = 0.2567
PC5 + PC10: CCA score = 0.1430
PC6 + PC7: CCA score = 0.4783
PC6 + PC8: CCA score = 0.4892
PC6 + PC9: CCA score = 0.5249
PC6 + PC10: CCA score = 0.4796
PC7 + PC8: CCA score = 0.1176
PC7 + PC9: CCA score = 0.2237
PC7 + PC10: CCA score = 0.0676
PC8 + PC9: CCA score = 0.2461
PC8 + PC10: CCA score = 0.1228
PC9 + PC10: CCA score = 0.2265
Best combination: PC1 + PC6 with score 0.6036
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.20/cca_plot_res_0.20.png
Created CCA visualization plot using PC1 + PC6 (viz score: 0.6036)
Resolution 0.20: Standard p-value = 0.0980


Testing resolution: 0.30

Number of clusters: 7
Resolution 0.30: CCA Score = 0.7298 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.5052
PC1 + PC3: CCA score = 0.2656
PC1 + PC4: CCA score = 0.2497
PC1 + PC5: CCA score = 0.2460
PC1 + PC6: CCA score = 0.5180
PC1 + PC7: CCA score = 0.2391
PC1 + PC8: CCA score = 0.2647
PC1 + PC9: CCA score = 0.2627
PC1 + PC10: CCA score = 0.2724
PC2 + PC3: CCA score = 0.4606
PC2 + PC4: CCA score = 0.4516
PC2 + PC5: CCA score = 0.4495
PC2 + PC6: CCA score = 0.6402
PC2 + PC7: CCA score = 0.4458
PC2 + PC8: CCA score = 0.4600
PC2 + PC9: CCA score = 0.4589
PC2 + PC10: CCA score = 0.4645
PC3 + PC4: CCA score = 0.1386
PC3 + PC5: CCA score = 0.1317
PC3 + PC6: CCA score = 0.4745
PC3 + PC7: CCA score = 0.1183
PC3 + PC8: CCA score = 0.1640
PC3 + PC9: CCA score = 0.1608
PC3 + PC10: CCA score = 0.1762
PC4 + PC5: CCA score = 0.0956
PC4 + PC6: CCA score = 0.4658
PC4 + PC7: CCA score = 0.0761
PC4 + PC8: CCA score = 0.1368
PC4 + PC9: CCA score = 0.1329
PC4 + PC10: CCA score = 0.1511
PC5 + PC6: CCA score = 0.4638
PC5 + PC7: CCA score = 0.0627
PC5 + PC8: CCA score = 0.1298
PC5 + PC9: CCA score = 0.1257
PC5 + PC10: CCA score = 0.1448
PC6 + PC7: CCA score = 0.4602
PC6 + PC8: CCA score = 0.4740
PC6 + PC9: CCA score = 0.4729
PC6 + PC10: CCA score = 0.4783
PC7 + PC8: CCA score = 0.1162
PC7 + PC9: CCA score = 0.1117
PC7 + PC10: CCA score = 0.1328
PC8 + PC9: CCA score = 0.1593
PC8 + PC10: CCA score = 0.1748
PC9 + PC10: CCA score = 0.1718
Best combination: PC2 + PC6 with score 0.6402
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.30/cca_plot_res_0.30.png
Created CCA visualization plot using PC2 + PC6 (viz score: 0.6402)
Resolution 0.30: Standard p-value = 0.1920


Testing resolution: 0.40

Number of clusters: 9
Resolution 0.40: CCA Score = 0.7850 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2302
PC1 + PC3: CCA score = 0.4551
PC1 + PC4: CCA score = 0.3437
PC1 + PC5: CCA score = 0.4064
PC1 + PC6: CCA score = 0.3792
PC1 + PC7: CCA score = 0.3370
PC1 + PC8: CCA score = 0.2884
PC1 + PC9: CCA score = 0.2685
PC1 + PC10: CCA score = 0.2209
PC2 + PC3: CCA score = 0.4036
PC2 + PC4: CCA score = 0.2719
PC2 + PC5: CCA score = 0.3479
PC2 + PC6: CCA score = 0.3156
PC2 + PC7: CCA score = 0.2634
PC2 + PC8: CCA score = 0.1975
PC2 + PC9: CCA score = 0.1671
PC2 + PC10: CCA score = 0.0681
PC3 + PC4: CCA score = 0.4776
PC3 + PC5: CCA score = 0.5245
PC3 + PC6: CCA score = 0.5037
PC3 + PC7: CCA score = 0.4728
PC3 + PC8: CCA score = 0.4395
PC3 + PC9: CCA score = 0.4267
PC3 + PC10: CCA score = 0.3984
PC4 + PC5: CCA score = 0.4315
PC4 + PC6: CCA score = 0.4059
PC4 + PC7: CCA score = 0.3668
PC4 + PC8: CCA score = 0.3227
PC4 + PC9: CCA score = 0.3051
PC4 + PC10: CCA score = 0.2642
PC5 + PC6: CCA score = 0.4602
PC5 + PC7: CCA score = 0.4261
PC5 + PC8: CCA score = 0.3889
PC5 + PC9: CCA score = 0.3744
PC5 + PC10: CCA score = 0.3418
PC6 + PC7: CCA score = 0.4002
PC6 + PC8: CCA score = 0.3603
PC6 + PC9: CCA score = 0.3446
PC6 + PC10: CCA score = 0.3089
PC7 + PC8: CCA score = 0.3156
PC7 + PC9: CCA score = 0.2975
PC7 + PC10: CCA score = 0.2554
PC8 + PC9: CCA score = 0.2411
PC8 + PC10: CCA score = 0.1867
PC9 + PC10: CCA score = 0.1542
Best combination: PC3 + PC5 with score 0.5245
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.40/cca_plot_res_0.40.png
Created CCA visualization plot using PC3 + PC5 (viz score: 0.5245)
Resolution 0.40: Standard p-value = 0.0430


Testing resolution: 0.50

Number of clusters: 10
Resolution 0.50: CCA Score = 0.7535 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.5465
PC1 + PC3: CCA score = 0.0766
PC1 + PC4: CCA score = 0.0776
PC1 + PC5: CCA score = 0.2351
PC1 + PC6: CCA score = 0.2212
PC1 + PC7: CCA score = 0.1733
PC1 + PC8: CCA score = 0.2467
PC1 + PC9: CCA score = 0.1822
PC1 + PC10: CCA score = 0.2199
PC2 + PC3: CCA score = 0.5475
PC2 + PC4: CCA score = 0.5476
PC2 + PC5: CCA score = 0.5908
PC2 + PC6: CCA score = 0.5855
PC2 + PC7: CCA score = 0.5691
PC2 + PC8: CCA score = 0.5956
PC2 + PC9: CCA score = 0.5719
PC2 + PC10: CCA score = 0.5850
PC3 + PC4: CCA score = 0.0838
PC3 + PC5: CCA score = 0.2372
PC3 + PC6: CCA score = 0.2235
PC3 + PC7: CCA score = 0.1762
PC3 + PC8: CCA score = 0.2487
PC3 + PC9: CCA score = 0.1850
PC3 + PC10: CCA score = 0.2222
PC4 + PC5: CCA score = 0.2375
PC4 + PC6: CCA score = 0.2238
PC4 + PC7: CCA score = 0.1766
PC4 + PC8: CCA score = 0.2490
PC4 + PC9: CCA score = 0.1854
PC4 + PC10: CCA score = 0.2225
PC5 + PC6: CCA score = 0.3152
PC5 + PC7: CCA score = 0.2836
PC5 + PC8: CCA score = 0.3335
PC5 + PC9: CCA score = 0.2891
PC5 + PC10: CCA score = 0.3142
PC6 + PC7: CCA score = 0.2723
PC6 + PC8: CCA score = 0.3239
PC6 + PC9: CCA score = 0.2780
PC6 + PC10: CCA score = 0.3040
PC7 + PC8: CCA score = 0.2933
PC7 + PC9: CCA score = 0.2416
PC7 + PC10: CCA score = 0.2712
PC8 + PC9: CCA score = 0.2987
PC8 + PC10: CCA score = 0.3230
PC9 + PC10: CCA score = 0.2770
Best combination: PC2 + PC8 with score 0.5956
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.50/cca_plot_res_0.50.png
Created CCA visualization plot using PC2 + PC8 (viz score: 0.5956)
Resolution 0.50: Standard p-value = 0.0800


Testing resolution: 0.60

Number of clusters: 9
Resolution 0.60: CCA Score = 0.7834 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.5105
PC1 + PC3: CCA score = 0.2193
PC1 + PC4: CCA score = 0.3843
PC1 + PC5: CCA score = 0.3213
PC1 + PC6: CCA score = 0.2786
PC1 + PC7: CCA score = 0.2848
PC1 + PC8: CCA score = 0.1636
PC1 + PC9: CCA score = 0.2101
PC1 + PC10: CCA score = 0.1857
PC2 + PC3: CCA score = 0.5062
PC2 + PC4: CCA score = 0.5965
PC2 + PC5: CCA score = 0.5580
PC2 + PC6: CCA score = 0.5345
PC2 + PC7: CCA score = 0.5378
PC2 + PC8: CCA score = 0.4847
PC2 + PC9: CCA score = 0.5022
PC2 + PC10: CCA score = 0.4925
PC3 + PC4: CCA score = 0.3785
PC3 + PC5: CCA score = 0.3143
PC3 + PC6: CCA score = 0.2705
PC3 + PC7: CCA score = 0.2769
PC3 + PC8: CCA score = 0.1495
PC3 + PC9: CCA score = 0.1993
PC3 + PC10: CCA score = 0.1733
PC4 + PC5: CCA score = 0.4454
PC4 + PC6: CCA score = 0.4157
PC4 + PC7: CCA score = 0.4199
PC4 + PC8: CCA score = 0.3492
PC4 + PC9: CCA score = 0.3733
PC4 + PC10: CCA score = 0.3601
PC5 + PC6: CCA score = 0.3582
PC5 + PC7: CCA score = 0.3631
PC5 + PC8: CCA score = 0.2783
PC5 + PC9: CCA score = 0.3079
PC5 + PC10: CCA score = 0.2918
PC6 + PC7: CCA score = 0.3259
PC6 + PC8: CCA score = 0.2277
PC6 + PC9: CCA score = 0.2631
PC6 + PC10: CCA score = 0.2440
PC7 + PC8: CCA score = 0.2353
PC7 + PC9: CCA score = 0.2697
PC7 + PC10: CCA score = 0.2511
PC8 + PC9: CCA score = 0.1356
PC8 + PC10: CCA score = 0.0934
PC9 + PC10: CCA score = 0.1615
Best combination: PC2 + PC4 with score 0.5965
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.60/cca_plot_res_0.60.png
Created CCA visualization plot using PC2 + PC4 (viz score: 0.5965)
Resolution 0.60: Standard p-value = 0.0470


Testing resolution: 0.70

Number of clusters: 10
Resolution 0.70: CCA Score = 0.7429 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.5942
PC1 + PC3: CCA score = 0.2000
PC1 + PC4: CCA score = 0.1944
PC1 + PC5: CCA score = 0.1806
PC1 + PC6: CCA score = 0.2624
PC1 + PC7: CCA score = 0.2470
PC1 + PC8: CCA score = 0.2156
PC1 + PC9: CCA score = 0.3743
PC1 + PC10: CCA score = 0.1807
PC2 + PC3: CCA score = 0.5727
PC2 + PC4: CCA score = 0.5707
PC2 + PC5: CCA score = 0.5662
PC2 + PC6: CCA score = 0.5973
PC2 + PC7: CCA score = 0.5907
PC2 + PC8: CCA score = 0.5783
PC2 + PC9: CCA score = 0.6543
PC2 + PC10: CCA score = 0.5662
PC3 + PC4: CCA score = 0.1123
PC3 + PC5: CCA score = 0.0862
PC3 + PC6: CCA score = 0.2089
PC3 + PC7: CCA score = 0.1893
PC3 + PC8: CCA score = 0.1459
PC3 + PC9: CCA score = 0.3390
PC3 + PC10: CCA score = 0.0864
PC4 + PC5: CCA score = 0.0723
PC4 + PC6: CCA score = 0.2036
PC4 + PC7: CCA score = 0.1834
PC4 + PC8: CCA score = 0.1382
PC4 + PC9: CCA score = 0.3357
PC4 + PC10: CCA score = 0.0726
PC5 + PC6: CCA score = 0.1904
PC5 + PC7: CCA score = 0.1687
PC5 + PC8: CCA score = 0.1179
PC5 + PC9: CCA score = 0.3279
PC5 + PC10: CCA score = 0.0090
PC6 + PC7: CCA score = 0.2543
PC6 + PC8: CCA score = 0.2239
PC6 + PC9: CCA score = 0.3792
PC6 + PC10: CCA score = 0.1906
PC7 + PC8: CCA score = 0.2057
PC7 + PC9: CCA score = 0.3687
PC7 + PC10: CCA score = 0.1688
PC8 + PC9: CCA score = 0.3484
PC8 + PC10: CCA score = 0.1181
PC9 + PC10: CCA score = 0.3280
Best combination: PC2 + PC9 with score 0.6543
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.70/cca_plot_res_0.70.png
Created CCA visualization plot using PC2 + PC9 (viz score: 0.6543)
Resolution 0.70: Standard p-value = 0.1230


Testing resolution: 0.80

Number of clusters: 14
Resolution 0.80: CCA Score = 0.6791 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.1678
PC1 + PC3: CCA score = 0.4863
PC1 + PC4: CCA score = 0.1387
PC1 + PC5: CCA score = 0.3126
PC1 + PC6: CCA score = 0.1556
PC1 + PC7: CCA score = 0.2850
PC1 + PC8: CCA score = 0.1749
PC1 + PC9: CCA score = 0.1801
PC1 + PC10: CCA score = 0.2322
PC2 + PC3: CCA score = 0.4784
PC2 + PC4: CCA score = 0.1081
PC2 + PC5: CCA score = 0.3003
PC2 + PC6: CCA score = 0.1291
PC2 + PC7: CCA score = 0.2714
PC2 + PC8: CCA score = 0.1518
PC2 + PC9: CCA score = 0.1577
PC2 + PC10: CCA score = 0.2153
PC3 + PC4: CCA score = 0.4690
PC3 + PC5: CCA score = 0.5463
PC3 + PC6: CCA score = 0.4743
PC3 + PC7: CCA score = 0.5310
PC3 + PC8: CCA score = 0.4810
PC3 + PC9: CCA score = 0.4829
PC3 + PC10: CCA score = 0.5046
PC4 + PC5: CCA score = 0.2850
PC4 + PC6: CCA score = 0.0881
PC4 + PC7: CCA score = 0.2545
PC4 + PC8: CCA score = 0.1189
PC4 + PC9: CCA score = 0.1264
PC4 + PC10: CCA score = 0.1935
PC5 + PC6: CCA score = 0.2936
PC5 + PC7: CCA score = 0.3785
PC5 + PC8: CCA score = 0.3043
PC5 + PC9: CCA score = 0.3073
PC5 + PC10: CCA score = 0.3405
PC6 + PC7: CCA score = 0.2641
PC6 + PC8: CCA score = 0.1383
PC6 + PC9: CCA score = 0.1448
PC6 + PC10: CCA score = 0.2060
PC7 + PC8: CCA score = 0.2759
PC7 + PC9: CCA score = 0.2792
PC7 + PC10: CCA score = 0.3153
PC8 + PC9: CCA score = 0.1653
PC8 + PC10: CCA score = 0.2209
PC9 + PC10: CCA score = 0.2250
Best combination: PC3 + PC5 with score 0.5463
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.80/cca_plot_res_0.80.png
Created CCA visualization plot using PC3 + PC5 (viz score: 0.5463)
Resolution 0.80: Standard p-value = 0.3440


Testing resolution: 0.90

Number of clusters: 13
Resolution 0.90: CCA Score = 0.6816 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.1153
PC1 + PC3: CCA score = 0.5965
PC1 + PC4: CCA score = 0.1535
PC1 + PC5: CCA score = 0.1198
PC1 + PC6: CCA score = 0.1218
PC1 + PC7: CCA score = 0.2376
PC1 + PC8: CCA score = 0.1995
PC1 + PC9: CCA score = 0.1195
PC1 + PC10: CCA score = 0.1767
PC2 + PC3: CCA score = 0.5868
PC2 + PC4: CCA score = 0.1100
PC2 + PC5: CCA score = 0.0538
PC2 + PC6: CCA score = 0.0581
PC2 + PC7: CCA score = 0.2122
PC2 + PC8: CCA score = 0.1684
PC2 + PC9: CCA score = 0.0532
PC2 + PC10: CCA score = 0.1406
PC3 + PC4: CCA score = 0.5955
PC3 + PC5: CCA score = 0.5877
PC3 + PC6: CCA score = 0.5881
PC3 + PC7: CCA score = 0.6225
PC3 + PC8: CCA score = 0.6090
PC3 + PC9: CCA score = 0.5877
PC3 + PC10: CCA score = 0.6019
PC4 + PC5: CCA score = 0.1147
PC4 + PC6: CCA score = 0.1168
PC4 + PC7: CCA score = 0.2351
PC4 + PC8: CCA score = 0.1965
PC4 + PC9: CCA score = 0.1144
PC4 + PC10: CCA score = 0.1733
PC5 + PC6: CCA score = 0.0666
PC5 + PC7: CCA score = 0.2146
PC5 + PC8: CCA score = 0.1715
PC5 + PC9: CCA score = 0.0623
PC5 + PC10: CCA score = 0.1443
PC6 + PC7: CCA score = 0.2158
PC6 + PC8: CCA score = 0.1729
PC6 + PC9: CCA score = 0.0661
PC6 + PC10: CCA score = 0.1460
PC7 + PC8: CCA score = 0.2675
PC7 + PC9: CCA score = 0.2145
PC7 + PC10: CCA score = 0.2509
PC8 + PC9: CCA score = 0.1713
PC8 + PC10: CCA score = 0.2152
PC9 + PC10: CCA score = 0.1441
Best combination: PC3 + PC7 with score 0.6225
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.90/cca_plot_res_0.90.png
Created CCA visualization plot using PC3 + PC7 (viz score: 0.6225)
Resolution 0.90: Standard p-value = 0.3190


Testing resolution: 1.00

Number of clusters: 14
Resolution 1.00: CCA Score = 0.7466 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.1281
PC1 + PC3: CCA score = 0.1363
PC1 + PC4: CCA score = 0.5033
PC1 + PC5: CCA score = 0.3088
PC1 + PC6: CCA score = 0.2656
PC1 + PC7: CCA score = 0.1834
PC1 + PC8: CCA score = 0.1557
PC1 + PC9: CCA score = 0.2203
PC1 + PC10: CCA score = 0.3432
PC2 + PC3: CCA score = 0.0690
PC2 + PC4: CCA score = 0.4894
PC2 + PC5: CCA score = 0.2856
PC2 + PC6: CCA score = 0.2382
PC2 + PC7: CCA score = 0.1407
PC2 + PC8: CCA score = 0.1021
PC2 + PC9: CCA score = 0.1863
PC2 + PC10: CCA score = 0.3224
PC3 + PC4: CCA score = 0.4916
PC3 + PC5: CCA score = 0.2894
PC3 + PC6: CCA score = 0.2427
PC3 + PC7: CCA score = 0.1482
PC3 + PC8: CCA score = 0.1123
PC3 + PC9: CCA score = 0.1921
PC3 + PC10: CCA score = 0.3258
PC4 + PC5: CCA score = 0.5643
PC4 + PC6: CCA score = 0.5419
PC4 + PC7: CCA score = 0.5066
PC4 + PC8: CCA score = 0.4973
PC4 + PC9: CCA score = 0.5212
PC4 + PC10: CCA score = 0.5838
PC5 + PC6: CCA score = 0.3684
PC5 + PC7: CCA score = 0.3143
PC5 + PC8: CCA score = 0.2990
PC5 + PC9: CCA score = 0.3372
PC5 + PC10: CCA score = 0.4277
PC6 + PC7: CCA score = 0.2720
PC6 + PC8: CCA score = 0.2541
PC6 + PC9: CCA score = 0.2981
PC6 + PC10: CCA score = 0.3976
PC7 + PC8: CCA score = 0.1663
PC7 + PC9: CCA score = 0.2279
PC7 + PC10: CCA score = 0.3481
PC8 + PC9: CCA score = 0.2063
PC8 + PC10: CCA score = 0.3344
PC9 + PC10: CCA score = 0.3689
Best combination: PC4 + PC10 with score 0.5838
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_1.00/cca_plot_res_1.00.png
Created CCA visualization plot using PC4 + PC10 (viz score: 0.5838)
Resolution 1.00: Standard p-value = 0.1290

Best resolution from first pass: 0.10
Best CCA score: 0.7880

=== SECOND PASS: Fine-tuned Search ===
Fine-tuning search from 0.09 to 0.11...

Testing fine-tuned resolution: 0.090
Error at fine-tuned resolution 0.090: cell_types() got an unexpected keyword argument 'cell_column'

Testing fine-tuned resolution: 0.110
Error at fine-tuned resolution 0.110: cell_types() got an unexpected keyword argument 'cell_column'

=== GENERATING CORRECTED NULL DISTRIBUTION ===
Accounting for resolution selection bias...
Corrected null distribution saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/corrected_null/corrected_null_distribution_expression.npy

=== COMPUTING CORRECTED P-VALUES ===
Corrected null distribution plot saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/corrected_null/corrected_null_distribution.png

=== FINAL RESULTS ===
Best resolution: 0.100
Best CCA score: 0.7880
Number of clusters at best resolution: 4
Number of PCs used: 10
Best visualization used PC2 + PC3
Standard p-value: 0.0330
Corrected p-value: 0.3530

All results saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/all_resolution_results_expression.csv

Final summary saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/FINAL_SUMMARY.txt

[Find Optimal Resolution RNA-seq] Total runtime: 402.97 seconds

RNA analysis completed successfully!

✓ RNA pipeline completed successfully!

============================================================
PIPELINE EXECUTION SUMMARY
============================================================
RNA Pipeline: ⚠ PARTIAL
  - preprocessing: ✓
  - cell_type_cluster: ✓
  - dimensionality_reduction: ✓
  - sample_distance_calculation: ✗
  - trajectory_analysis: ✓
  - trajectory_dge: ✗
  - cluster_dge: ✗
  - visualization: ✗

Results saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample
Status file: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/sys_log/main_process_status.json
Execution time: 1007.1303 seconds
