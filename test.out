======================================
 Job ID:            17711612
 Job Name:          test
 Partition:         gpu
 Node List:         compute-170
 CPUs per Task:     16
 Memory Alloc:      819200
 GPU Requested:     1
 Start Time:        Sat Jun 21 02:11:48 PM EDT 2025
======================================
Checking GPU status...
Sat Jun 21 14:11:51 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 555.42.06              Driver Version: 555.42.06      CUDA Version: 12.5     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H100 NVL                Off |   00000000:D1:00.0 Off |                    0 |
| N/A   43C    P0             90W /  400W |       1MiB /  95830MiB |      3%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Starting main.py...
Start of Process

Resuming process from previous progress:
{
    "preprocessing": true,
    "cell_type_cluster": true,
    "sample_distance_calculation": true,
    "DimensionalityReduction": true,
    "trajectory_analysis": true,
    "visualize_data": true,
    "initialization": false
}
Linux system detected.


Enabling managed memory for RMM...


[cell_types_atac] No cell type annotation found. Performing clustering at resolution 0.96.
[cell_types_atac] Building neighborhood graph...
[cell_types_atac] No target clusters specified. Using standard Leiden clustering (resolution=0.96)...
[cell_types_atac] Found 27 clusters after Leiden clustering.
[cell_types_atac] Finished assigning cell types.
[standardize] Converted categorical to string format
[standardize] Final cell types (n=27): ['1', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '2', '20', '21', '22', '23', '24', '25', '26', '27', '3', '4', '5', '6', '7', '8', '9']
[cell_types_atac] Total runtime: 25.89 seconds
Processing X_DR_proportion...

The CCA score for X_DR_proportion is 0.7043

Saved CCA plot to: /dcl01/hongkai/data/data/hjiang/result/CCA/pca_2d_cca_proportion.pdf
Processing X_DR_expression...

The CCA score for X_DR_expression is 0.0235

Saved CCA plot to: /dcl01/hongkai/data/data/hjiang/result/CCA/pca_2d_cca_expression.pdf
CCA analysis completed.

[CCA] Total runtime: 0.51 seconds

P-value for observed correlation 0.7043007777070076: 0.002
[CCA p-test] Runtime: 0.91 seconds
P-value for observed correlation 0.02350454819123003: 0.993
[CCA p-test] Runtime: 0.90 seconds
Starting ATAC resolution optimization for X_DR_expression...
Using representation: X_DM_harmony with 20 components
Testing resolutions from 0.01 to 1.00...


Testing resolution: 0.10

Resolution 0.10: CCA Score = 0.2967


Testing resolution: 0.20

Resolution 0.20: CCA Score = 0.3137


Testing resolution: 0.30

Resolution 0.30: CCA Score = 0.3252


Testing resolution: 0.40

Resolution 0.40: CCA Score = 0.2835


Testing resolution: 0.50

Resolution 0.50: CCA Score = 0.2673


Testing resolution: 0.60

Resolution 0.60: CCA Score = 0.3142


Testing resolution: 0.70

Resolution 0.70: CCA Score = 0.3689


Testing resolution: 0.80

Resolution 0.80: CCA Score = 0.2736


Testing resolution: 0.90

Resolution 0.90: CCA Score = 0.2921


Testing resolution: 1.00

Resolution 1.00: CCA Score = 0.4306

Best resolution from first pass: 1.00
Best CCA score: 0.4306

Fine-tuning search from 0.95 to 1.00...
Fine-tuned Resolution 0.950: Score 0.3295
Fine-tuned Resolution 0.960: Score 0.4476
Fine-tuned Resolution 0.970: Score 0.2864
Fine-tuned Resolution 0.980: Score 0.4019
Fine-tuned Resolution 0.990: Score 0.2799
Fine-tuned Resolution 1.000: Score 0.4306

Final best resolution: 0.960
Final best CCA score: 0.4476
Plot saved to: /dcl01/hongkai/data/data/hjiang/result/ATAC/CCA_test/resolution_vs_cca_score_atac_X_DR_expression.png
Resolution scores saved to: /dcl01/hongkai/data/data/hjiang/result/ATAC/CCA_test/resolution_scores_atac_X_DR_expression.csv

[Find Optimal Resolution ATAC] Total runtime: 282.65 seconds

End of Process

Finished main.py.
End Time: Sat Jun 21 02:18:29 PM EDT 2025
