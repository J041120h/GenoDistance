Linux system detected with GPU enabled.
Resuming process from previous progress:
{
    "rna": {
        "preprocessing": true,
        "cell_type_cluster": true,
        "dimensionality_reduction": true,
        "sample_distance_calculation": false,
        "trajectory_analysis": false,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "atac": {
        "preprocessing": false,
        "cell_type_cluster": false,
        "dimensionality_reduction": false,
        "sample_distance_calculation": false,
        "trajectory_analysis": false,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "multiomics": {
        "glue_integration": false,
        "glue_preprocessing": false,
        "glue_training": false,
        "glue_gene_activity": false,
        "glue_cell_types": false,
        "glue_visualization": false,
        "integration_preprocessing": false,
        "dimensionality_reduction": false,
        "embedding_visualization": false,
        "optimal_resolution": false
    },
    "system_info": {
        "platform": "Linux",
        "python_version": "3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]",
        "use_gpu": true,
        "linux_system": true
    }
}

============================================================
RUNNING MULTIOMICS PIPELINE
============================================================
Starting multi-modal pipeline with output directory: /dcl01/hongkai/data/data/hjiang/Data/multi_omics_testing/multiomics
Initial status flags: {'glue_integration': False, 'glue_preprocessing': False, 'glue_training': False, 'glue_gene_activity': False, 'glue_cell_types': False, 'glue_visualization': False, 'integration_preprocessing': False, 'dimensionality_reduction': False, 'embedding_visualization': False, 'optimal_resolution': False}
Step 1: Running GLUE integration...
  Sub-steps: Preprocessing=True, Training=True, Gene Activity=False, Cell Types=False, Visualization=False
Running preprocessing...

🚀 Starting GLUE preprocessing pipeline...

   Feature selection mode: All Features

📊 Loading data files...
   RNA: /dcl01/hongkai/data/data/hjiang/Data/multi_omics_testing/rna_pseudobulk.h5ad
   ATAC: /dcl01/hongkai/data/data/hjiang/Data/multi_omics_testing/atac_pseudobulk.h5ad
✅ Data loaded successfully
   RNA shape: (44, 1624)
   ATAC shape: (44, 3575859)

📋 Standardizing existing sample columns...
✅ Sample column standardization complete

🧬 Setting up Ensembl annotation...
   Release: 98
   Species: homo_sapiens
✅ Ensembl annotation ready

🧬 Preprocessing scRNA-seq data...
   Using all 1624 genes
   Computing 10 PCA components
✅ RNA preprocessing complete

🏔️ Preprocessing scATAC-seq data...
   Using all 3575859 peaks
   Computing 50 LSI components (15 iterations)
✅ ATAC preprocessing complete

🗺️ Processing gene coordinates...
   Processing 1624 genes...
✅ Gene coordinate processing complete
   1624 genes retained
   Final RNA shape: (44, 1624)

🏔️ Processing ATAC peak coordinates...
   Processing 3575859 peaks...
✅ ATAC peak coordinates extracted successfully

🕸️ Constructing guidance graph...
   Using all features for graph construction
[INFO] check_graph: Checking variable coverage...
[INFO] check_graph: Checking edge attributes...
[INFO] check_graph: Checking self-loops...
[INFO] check_graph: Checking graph symmetry...
[INFO] check_graph: All checks passed!
✅ Guidance graph constructed successfully
   Nodes: 3,577,483
   Edges: 4,062,607

🧹 Preparing data for saving...
🧹 Cleaning AnnData object for HDF5 compatibility...
   Processing column: tissue
   Processing column: n_cells
✅ AnnData cleaning complete
🧹 Cleaning AnnData object for HDF5 compatibility...
   Processing column: tissue
   Processing column: n_cells
✅ AnnData cleaning complete
💾 Saving preprocessed data...
   Output directory: /dcl01/hongkai/data/data/hjiang/Data/multi_omics_testing/multiomics/integration/glue
   Saving RNA data...
   Saving ATAC data...
   Saving guidance graph...

🎉 GLUE preprocessing pipeline completed successfully!

Preprocessing completed.
Running training...



🚀 Starting GLUE training pipeline...



   Feature mode: All Features
   Output directory: /dcl01/hongkai/data/da