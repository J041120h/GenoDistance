======================================
 Job ID:            17715445
 Job Name:          test
 Partition:         gpu
 Node List:         compute-170
 CPUs per Task:     16
 Memory Alloc:      819200
 GPU Requested:     1
 Start Time:        Sun Jun 22 06:35:20 PM EDT 2025
======================================
Checking GPU status...
Sun Jun 22 18:35:23 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 555.42.06              Driver Version: 555.42.06      CUDA Version: 12.5     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H100 NVL                Off |   00000000:D1:00.0 Off |                    0 |
| N/A   43C    P0             91W /  400W |       1MiB /  95830MiB |      3%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Starting main.py...
GPU Memory: 99.99 GB
GPU Memory Available: 0.00 GB


 Finding optimal resolution begins 



=== Converting sev.level to numeric ===
Converting severity data to numeric...
Original unique values: [1.0, 2.0, 3.0, 4.0]
âœ“ Direct numeric conversion successful
Conversion complete: 162916/162916 values converted
Final range: [1.000, 4.000]
Variance: 1.332256
=== Data Quality Check ===
Missing values in sev.level: 0
Missing values in modality: 0

Severity level distribution:
sev.level
2.0    57870
1.0    46180
4.0    43880
3.0    14986
Name: count, dtype: int64

Modality distribution:
modality
ATAC    88215
RNA     74701
Name: count, dtype: int64

RNA - Severity variance: 1.191391
RNA - Unique severity levels: 4

ATAC - Severity variance: 1.350928
ATAC - Unique severity levels: 4
Starting integrated resolution optimization...
Optimization target: ATAC
Using representation: X_glue with 30 components
Testing resolutions from 0.01 to 1.00...
Computing p-values with 1000 simulations per resolution

=== FIRST PASS: Coarse Search ===


Testing resolution: 0.10

RNA expression CCA Score: 0.9357, p-value: 0.0740
RNA proportion CCA Score: 0.5544, p-value: 0.0070
ATAC expression CCA Score: 1.0000, p-value: 0.0620
ATAC proportion CCA Score: 0.5964, p-value: 0.0420
Resolution 0.10: Optimization Score = 1.0000


Testing resolution: 0.20

RNA expression CCA Score: 0.9391, p-value: 0.0710
RNA proportion CCA Score: 0.5656, p-value: 0.0090
ATAC expression CCA Score: 1.0000, p-value: 0.1060
ATAC proportion CCA Score: 0.3712, p-value: 0.6000
Resolution 0.20: Optimization Score = 1.0000


Testing resolution: 0.30

RNA expression CCA Score: 0.9371, p-value: 0.0730
RNA proportion CCA Score: 0.7605, p-value: 0.0020
ATAC expression CCA Score: 1.0000, p-value: 0.2500
ATAC proportion CCA Score: 0.8120, p-value: 0.0370
Resolution 0.30: Optimization Score = 1.0000


Testing resolution: 0.40

RNA expression CCA Score: 0.9258, p-value: 0.1330
RNA proportion CCA Score: 0.6924, p-value: 0.0150
ATAC expression CCA Score: 1.0000, p-value: 0.0590
ATAC proportion CCA Score: 0.7725, p-value: 0.1120
Resolution 0.40: Optimization Score = 1.0000


Testing resolution: 0.50

RNA expression CCA Score: 0.9465, p-value: 0.0370
RNA proportion CCA Score: 0.7354, p-value: 0.0340
ATAC expression CCA Score: 1.0000, p-value: 0.2330
ATAC proportion CCA Score: 0.9375, p-value: 0.0010
Resolution 0.50: Optimization Score = 1.0000


Testing resolution: 0.60

RNA expression CCA Score: 0.9035, p-value: 0.2920
RNA proportion CCA Score: 0.7984, p-value: 0.0100
ATAC expression CCA Score: 1.0000, p-value: 0.0640
ATAC proportion CCA Score: 0.9056, p-value: 0.0830
Resolution 0.60: Optimization Score = 1.0000


Testing resolution: 0.70

RNA expression CCA Score: 0.9227, p-value: 0.1590
RNA proportion CCA Score: 0.7849, p-value: 0.0170
ATAC expression CCA Score: 1.0000, p-value: 0.3560
ATAC proportion CCA Score: 0.9264, p-value: 0.0480
Resolution 0.70: Optimization Score = 1.0000


Testing resolution: 0.80

RNA expression CCA Score: 0.8429, p-value: 0.7960
RNA proportion CCA Score: 0.9087, p-value: 0.0020
ATAC expression CCA Score: 1.0000, p-value: 0.0410
ATAC proportion CCA Score: 0.9808, p-value: 0.6290
Resolution 0.80: Optimization Score = 1.0000


Testing resolution: 0.90

RNA expression CCA Score: 0.8460, p-value: 0.7430
RNA proportion CCA Score: 0.8963, p-value: 0.0170
ATAC expression CCA Score: 1.0000, p-value: 0.4060
ATAC proportion CCA Score: 1.0000, p-value: 0.6920
Resolution 0.90: Optimization Score = 1.0000


Testing resolution: 1.00

RNA expression CCA Score: 0.8886, p-value: 0.4230
RNA proportion CCA Score: 0.9296, p-value: 0.0910
ATAC expression CCA Score: 1.0000, p-value: 0.5570
ATAC proportion CCA Score: 1.0000, p-value: 0.8410
Resolution 1.00: Optimization Score = 1.0000

Best resolution from first pass: 0.90
Best optimization score: 1.0000

=== SECOND PASS: Fine-tuned Search ===
Fine-tuning search from 0.85 to 0.95...

Testing fine-tuned resolution: 0.850
Fine-tuned Resolution 0.850: Score 1.0000

Testing fine-tuned resolution: 0.860
Fine-tuned Resolution 0.860: Score 1.0000

Testing fine-tuned resolution: 0.870
Fine-tuned Resolution 0.870: Score 1.0000

Testing fine-tuned resolution: 0.880
Fine-tuned Resolution 0.880: Score 1.0000

Testing fine-tuned resolution: 0.890
Fine-tuned Resolution 0.890: Score 1.0000

Testing fine-tuned resolution: 0.910
Fine-tuned Resolution 0.910: Score 1.0000

Testing fine-tuned resolution: 0.920
Fine-tuned Resolution 0.920: Score 1.0000

Testing fine-tuned resolution: 0.930
Fine-tuned Resolution 0.930: Score 1.0000

Testing fine-tuned resolution: 0.940
Fine-tuned Resolution 0.940: Score 1.0000

Testing fine-tuned resolution: 0.950
Fine-tuned Resolution 0.950: Score 1.0000

=== FINAL RESULTS ===
Best resolution: 0.880
Best optimization score (atac): 1.0000
Best RNA scores - Expression: 0.8535, Proportion: 0.9574
Best ATAC scores - Expression: 1.0000, Proportion: 1.0000

Comprehensive results saved to: /dcl01/hongkai/data/data/hjiang/result/integration_test/CCA_resolution_optimization_integration_atac/resolution_scores_comprehensive_integration_atac.csv
Comprehensive plot saved to: /dcl01/hongkai/data/data/hjiang/result/integration_test/CCA_resolution_optimization_integration_atac/resolution_optimization_comprehensive_integration_atac.png
P-value summary saved to: /dcl01/hongkai/data/data/hjiang/result/integration_test/CCA_resolution_optimization_integration_atac/pvalue_results/pvalue_summary_integration_atac.txt

[Find Optimal Resolution Integration] Total runtime: 542.09 seconds

Finished main.py.
End Time: Sun Jun 22 06:47:43 PM EDT 2025
