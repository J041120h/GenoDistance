
============================================================
STARTING DEBUG MODE - RNA-ATAC CORRELATION ANALYSIS
============================================================


[DEBUG] ===== INPUT DATA INFO =====
[DEBUG] RNA data shape: (12402, 36591)
[DEBUG] First 5 RNA cell names: ['ENCSR284PXA_AAACAGCCAAATACCT-1', 'ENCSR284PXA_AAACAGCCAAATATCC-1', 'ENCSR284PXA_AAACAGCCAACCTGGT-1', 'ENCSR284PXA_AAACAGCCACAGAAAC-1', 'ENCSR284PXA_AAACAGCCAGTTGCGT-1']
[DEBUG] First 5 RNA gene names: ['ENSG00000243485', 'ENSG00000237613', 'ENSG00000186092', 'ENSG00000238009', 'ENSG00000239945']
[DEBUG] RNA X type: <class 'numpy.ndarray'>

[DEBUG] ATAC data shape: (12402, 27569)
[DEBUG] First 5 ATAC cell names: ['ENCSR284PXA_AAACAGCCAAATACCT-1', 'ENCSR284PXA_AAACAGCCAAATATCC-1', 'ENCSR284PXA_AAACAGCCAACCTGGT-1', 'ENCSR284PXA_AAACAGCCACAGAAAC-1', 'ENCSR284PXA_AAACAGCCAGTTGCGT-1']
[DEBUG] First 5 ATAC gene names: ['RP11-34P13.8', 'RP11-34P13.7', 'FO538757.2', 'FO538757.1', 'AP006222.2']
[DEBUG] ATAC X type: <class 'scipy.sparse._csc.csc_matrix'>

[DEBUG] ===== CELL PAIRING =====
[DEBUG] Total RNA cells: 12402 | Total ATAC cells: 12402
[DEBUG] Common cells found: 12402
[DEBUG] After subsetting to common cells → RNA: (12402, 36591), ATAC: (12402, 27569)

[DEBUG] ===== GENE ALIGNMENT =====
[DEBUG] Overlap by current var_names: 0
[DEBUG] No shared genes. Attempting ID unification (Ensembl/Symbol)…
[unify] Unifying on: SYMBOL
[unify] Shared unified IDs: 19872
[unify] Saved mapping → /users/hjiang/r/signac_outputs/results_corr/gene_id_mapping_unified.csv
[DEBUG] Unified & aligned genes: 19872
[DEBUG] Sampled down to 1000 genes

[DEBUG] ===== FINAL MATRICES =====
[DEBUG] Final matrix shape: 12402 cells × 1000 genes

[DEBUG] ===== PER-CELL CORRELATIONS =====
[DEBUG] Cell 0 (ENCSR284PXA_AAACAGCCAAATACCT-1): 198 non-zero genes, corr=-0.310
[DEBUG] Cell 1 (ENCSR284PXA_AAACAGCCAAATATCC-1): 398 non-zero genes, corr=-0.063
[DEBUG] Cell 2 (ENCSR284PXA_AAACAGCCAACCTGGT-1): 206 non-zero genes, corr=-0.237
[DEBUG] Valid per-cell correlations: 12402/12402

[DEBUG] ===== PER-GENE CORRELATIONS =====
[DEBUG] Gene 0 (ABHD15): 36 co-expressing cells, corr=-0.233
[DEBUG] Gene 1 (ABHD5): 1135 co-expressing cells, corr=-0.030
[DEBUG] Gene 2 (ABLIM2): 21 co-expressing cells, corr=-0.067
[DEBUG] Gene 3 (ABLIM3): 273 co-expressing cells, corr=0.052
[correlation] Saved:
  /users/hjiang/r/signac_outputs/results_corr/per_cell_correlations.csv
  /users/hjiang/r/signac_outputs/results_corr/per_gene_correlations.csv
  /users/hjiang/r/signac_outputs/results_corr/correlation_plots.png

[DEBUG] ===== CORRELATION SUMMARY =====
[DEBUG] Per-cell correlation - Mean: -0.256, Median: -0.239
[DEBUG] Per-gene correlation - Mean: -0.050, Median: -0.058

============================================================
DEBUG MODE COMPLETE
============================================================

