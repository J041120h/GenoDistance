Resuming process from previous progress:
{
    "rna": {
        "preprocessing": true,
        "cell_type_cluster": true,
        "dimensionality_reduction": true,
        "sample_distance_calculation": true,
        "trajectory_analysis": true,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "atac": {
        "preprocessing": false,
        "cell_type_cluster": false,
        "dimensionality_reduction": false,
        "sample_distance_calculation": false,
        "trajectory_analysis": false,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "multiomics": {
        "glue_integration": false,
        "glue_preprocessing": false,
        "glue_training": false,
        "glue_gene_activity": false,
        "glue_cell_types": false,
        "glue_visualization": false,
        "integration_preprocessing": false,
        "dimensionality_reduction": false,
        "embedding_visualization": false,
        "optimal_resolution": false
    },
    "system_info": {
        "platform": "Linux",
        "python_version": "3.10.18 | packaged by conda-forge | (main, Jun  4 2025, 14:45:41) [GCC 13.3.0]",
        "use_gpu": false,
        "linux_system": false
    }
}

============================================================
RUNNING RNA PIPELINE
============================================================
Starting RNA wrapper function with provided parameters...
Reading Pseudobulk from provided or default path: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/pseudobulk/pseudobulk_sample.h5ad

Running sample distance: cosine

[Seed Control] Scanpy seed set to 42
Computing cosine distance using dimension reduction results...
Data type: ATAC (affects DR method prioritization)
Available sample metadata columns: ['study', 'age', 'sex', 'severity', 'batch', 'sev.level']
Number of samples: 405
Computing sample distances using expression dimension reduction (X_DR_expression)...
Distance check results saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/Sample_distance/cosine/expression_DR_distance/distance_check_results_expression_DR_cosine.txt
Score for expression_DR (cosine): 1.115113
Summary updated in /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/summary_sample.csv
Distance check completed for expression_DR: score = 1.115113
Sample distance heatmap saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/Sample_distance/cosine/expression_DR_distance/sample_distance_expression_DR_heatmap.pdf
expression_DR-based distance matrix saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/Sample_distance/cosine/expression_DR_distance
Computing sample distances using proportion dimension reduction (X_DR_proportion)...
Distance check results saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/Sample_distance/cosine/proportion_DR_distance/distance_check_results_proportion_DR_cosine.txt
Score for proportion_DR (cosine): 1.202119
Summary updated in /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/summary_sample.csv
Distance check completed for proportion_DR: score = 1.202119
Sample distance heatmap saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/Sample_distance/cosine/proportion_DR_distance/sample_distance_proportion_DR_heatmap.pdf
proportion_DR-based distance matrix saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/Sample_distance/cosine/proportion_DR_distance
Sample distance computations completed for: expression_DR, proportion_DR
Distance statistics summary saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/Sample_distance/cosine/distance_statistics_summary_cosine.csv

Running sample distance: correlation

[Seed Control] Scanpy seed set to 42
Computing correlation distance using dimension reduction results...
Data type: ATAC (affects DR method prioritization)
Available sample metadata columns: ['study', 'age', 'sex', 'severity', 'batch', 'sev.level']
Number of samples: 405
Computing sample distances using expression dimension reduction (X_DR_expression)...
Distance check results saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/Sample_distance/correlation/expression_DR_distance/distance_check_results_expression_DR_correlation.txt
Score for expression_DR (correlation): 1.112590
Summary updated in /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/summary_sample.csv
Distance check completed for expression_DR: score = 1.112590
Sample distance heatmap saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/Sample_distance/correlation/expression_DR_distance/sample_distance_expression_DR_heatmap.pdf
expression_DR-based distance matrix saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/Sample_distance/correlation/expression_DR_distance
Computing sample distances using proportion dimension reduction (X_DR_proportion)...
Distance check results saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/Sample_distance/correlation/proportion_DR_distance/distance_check_results_proportion_DR_correlation.txt
Score for proportion_DR (correlation): 1.203635
Summary updated in /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/summary_sample.csv
Distance check completed for proportion_DR: score = 1.203635
Sample distance heatmap saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/Sample_distance/correlation/proportion_DR_distance/sample_distance_proportion_DR_heatmap.pdf
proportion_DR-based distance matrix saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/Sample_distance/correlation/proportion_DR_distance
Sample distance computations completed for: expression_DR, proportion_DR
Distance statistics summary saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/Sample_distance/correlation/distance_statistics_summary_correlation.csv
Sample distance calculation completed. Results saved in /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/Sample_distance
Starting trajectory analysis...
[Seed Control] Scanpy seed set to 42

Processing X_DR_proportion...
[Seed Control] Scanpy seed set to 42
Warning: Only 5 components available, using all of them.
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.4357
PC1 + PC3: CCA score = 0.4430
PC1 + PC4: CCA score = 0.4460
PC1 + PC5: CCA score = 0.4561
PC2 + PC3: CCA score = 0.0991
PC2 + PC4: CCA score = 0.1114
PC2 + PC5: CCA score = 0.1156
PC3 + PC4: CCA score = 0.1373
PC3 + PC5: CCA score = 0.1124
PC4 + PC5: CCA score = 0.1175
Best combination: PC1 + PC5 with score 0.4561
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/CCA/pca_10d_cca_proportion.pdf
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/CCA/pca_10d_cca_proportion_contributions.pdf

Processing X_DR_expression...
[Seed Control] Scanpy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2821
PC1 + PC3: CCA score = 0.3254
PC1 + PC4: CCA score = 0.3407
PC1 + PC5: CCA score = 0.2794
PC1 + PC6: CCA score = 0.4232
PC1 + PC7: CCA score = 0.3467
PC1 + PC8: CCA score = 0.3395
PC1 + PC9: CCA score = 0.3745
PC1 + PC10: CCA score = 0.3882
PC2 + PC3: CCA score = 0.1903
PC2 + PC4: CCA score = 0.2156
PC2 + PC5: CCA score = 0.0917
PC2 + PC6: CCA score = 0.3308
PC2 + PC7: CCA score = 0.2249
PC2 + PC8: CCA score = 0.2136
PC2 + PC9: CCA score = 0.2658
PC2 + PC10: CCA score = 0.2848
PC3 + PC4: CCA score = 0.2697
PC3 + PC5: CCA score = 0.1863
PC3 + PC6: CCA score = 0.3684
PC3 + PC7: CCA score = 0.2773
PC3 + PC8: CCA score = 0.2682
PC3 + PC9: CCA score = 0.3113
PC3 + PC10: CCA score = 0.3277
PC4 + PC5: CCA score = 0.2120
PC4 + PC6: CCA score = 0.3821
PC4 + PC7: CCA score = 0.2952
PC4 + PC8: CCA score = 0.2866
PC4 + PC9: CCA score = 0.3274
PC4 + PC10: CCA score = 0.3430
PC5 + PC6: CCA score = 0.3285
PC5 + PC7: CCA score = 0.2215
PC5 + PC8: CCA score = 0.2100
PC5 + PC9: CCA score = 0.2629
PC5 + PC10: CCA score = 0.2821
PC6 + PC7: CCA score = 0.3874
PC6 + PC8: CCA score = 0.3810
PC6 + PC9: CCA score = 0.4125
PC6 + PC10: CCA score = 0.4250
PC7 + PC8: CCA score = 0.2937
PC7 + PC9: CCA score = 0.3336
PC7 + PC10: CCA score = 0.3489
PC8 + PC9: CCA score = 0.3261
PC8 + PC10: CCA score = 0.3417
PC9 + PC10: CCA score = 0.3766
Best combination: PC6 + PC10 with score 0.4250
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/CCA/pca_10d_cca_expression.pdf
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/CCA/pca_10d_cca_expression_contributions.pdf
Saved proportion pseudotime data to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/CCA/pseudotime_proportion.csv
Saved expression pseudotime data to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/CCA/pseudotime_expression.csv

==================================================
CCA ANALYSIS SUMMARY
==================================================
X_DR_proportion: CCA score = 0.4561 (using PC1 + PC5)
X_DR_expression: CCA score = 0.4250 (using PC6 + PC10)

Total runtime: 0.58 seconds
==================================================
P-value for observed correlation 0.45614199979802356: 0.0
[CCA p-test] Runtime: 0.67 seconds
P-value for observed correlation 0.42497877034547754: 0.0
[CCA p-test] Runtime: 0.68 seconds
RNA analysis completed successfully!

✓ RNA pipeline completed successfully!

============================================================
PIPELINE EXECUTION SUMMARY
============================================================
RNA Pipeline: ⚠ PARTIAL
  - preprocessing: ✓
  - cell_type_cluster: ✓
  - dimensionality_reduction: ✓
  - sample_distance_calculation: ✓
  - trajectory_analysis: ✓
  - trajectory_dge: ✗
  - cluster_dge: ✗
  - visualization: ✗

Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample
Status file: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/sys_log/main_process_status.json
Execution time: 626.9606 seconds
