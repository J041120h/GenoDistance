Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/retina/embeddings/sample_expression_embedding.csv
Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  Using first 2 dimensions (PC1 and PC2) for CCA...
  CCA score (PC1 & PC2): 0.7793
  Saved trajectory plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots/trajectory_SD_expression.png
============================================================
Multimodal Integration Evaluation: SD_expression
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10

--- 1. Paired Sample Distance (lower = better) ---
  Number of pairs: 12
  Mean paired distance: 14.9796
  Std paired distance:  11.6609
  Median paired distance: 9.3134

--- 2. Modality Mixing (higher = better) ---
  Modalities: ['ATAC', 'RNA']
  iLISI mean:       1.2500
  iLISI normalized: 0.6250
  ASW modality:     0.4948

--- 3. Trajectory Analysis (age) using PC1 & PC2 (higher = better) ---
  Dimension pair: (1, 2) (PC1 & PC2)
  CCA score:           0.7793
  Pseudotime-age corr: 0.7792
  Age range:           70.0 - 165.0

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/evaluation_details/SD_expression
Trajectory plots saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/summary.csv with column 'SD_expression'
Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/retina/embeddings/sample_proportion_embedding.csv
Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  Using first 2 dimensions (PC1 and PC2) for CCA...
  CCA score (PC1 & PC2): 0.9782
  Saved trajectory plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots/trajectory_SD_proportion.png
============================================================
Multimodal Integration Evaluation: SD_proportion
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10

--- 1. Paired Sample Distance (lower = better) ---
  Number of pairs: 12
  Mean paired distance: 0.0721
  Std paired distance:  0.0409
  Median paired distance: 0.0735

--- 2. Modality Mixing (higher = better) ---
  Modalities: ['ATAC', 'RNA']
  iLISI mean:       1.7500
  iLISI normalized: 0.8750
  ASW modality:     0.5345

--- 3. Trajectory Analysis (age) using PC1 & PC2 (higher = better) ---
  Dimension pair: (1, 2) (PC1 & PC2)
  CCA score:           0.9782
  Pseudotime-age corr: -0.9635
  Age range:           70.0 - 165.0

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/evaluation_details/SD_proportion
Trajectory plots saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/summary.csv with column 'SD_proportion'
Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/pilot/wasserstein_distance_mds_10d.csv
Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  Using first 2 dimensions (PC1 and PC2) for CCA...
  CCA score (PC1 & PC2): 0.8328
  Saved trajectory plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots/trajectory_pilot.png
============================================================
Multimodal Integration Evaluation: pilot
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10

--- 1. Paired Sample Distance (lower = better) ---
  Number of pairs: 12
  Mean paired distance: 0.5413
  Std paired distance:  0.0976
  Median paired distance: 0.5025

--- 2. Modality Mixing (higher = better) ---
  Modalities: ['ATAC', 'RNA']
  iLISI mean:       1.0000
  iLISI normalized: 0.5000
  ASW modality:     0.1312

--- 3. Trajectory Analysis (age) using PC1 & PC2 (higher = better) ---
  Dimension pair: (1, 2) (PC1 & PC2)
  CCA score:           0.8328
  Pseudotime-age corr: -0.7855
  Age range:           70.0 - 165.0

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/evaluation_details/pilot
Trajectory plots saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/summary.csv with column 'pilot'
Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/pseudobulk/pseudobulk/pca_embeddings.csv
Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  Using first 2 dimensions (PC1 and PC2) for CCA...
  CCA score (PC1 & PC2): 0.8561
  Saved trajectory plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots/trajectory_pseudobulk.png
============================================================
Multimodal Integration Evaluation: pseudobulk
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10

--- 1. Paired Sample Distance (lower = better) ---
  Number of pairs: 12
  Mean paired distance: 31.9184
  Std paired distance:  3.5055
  Median paired distance: 30.7693

--- 2. Modality Mixing (higher = better) ---
  Modalities: ['ATAC', 'RNA']
  iLISI mean:       1.0000
  iLISI normalized: 0.5000
  ASW modality:     0.1689

--- 3. Trajectory Analysis (age) using PC1 & PC2 (higher = better) ---
  Dimension pair: (1, 2) (PC1 & PC2)
  CCA score:           0.8561
  Pseudotime-age corr: -0.8470
  Age range:           70.0 - 165.0

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/evaluation_details/pseudobulk
Trajectory plots saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/summary.csv with column 'pseudobulk'
Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/QOT/24_qot_distance_matrix_mds_10d.csv
Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  Using first 2 dimensions (PC1 and PC2) for CCA...
  CCA score (PC1 & PC2): 0.9215
  Saved trajectory plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots/trajectory_QOT.png
============================================================
Multimodal Integration Evaluation: QOT
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10

--- 1. Paired Sample Distance (lower = better) ---
  Number of pairs: 12
  Mean paired distance: 0.3179
  Std paired distance:  0.1276
  Median paired distance: 0.3034

--- 2. Modality Mixing (higher = better) ---
  Modalities: ['ATAC', 'RNA']
  iLISI mean:       1.5833
  iLISI normalized: 0.7917
  ASW modality:     0.5201

--- 3. Trajectory Analysis (age) using PC1 & PC2 (higher = better) ---
  Dimension pair: (1, 2) (PC1 & PC2)
  CCA score:           0.9215
  Pseudotime-age corr: -0.9168
  Age range:           70.0 - 165.0

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/evaluation_details/QOT
Trajectory plots saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/summary.csv with column 'QOT'
Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/GEDI/gedi_sample_embedding.csv
Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  Using first 2 dimensions (PC1 and PC2) for CCA...
  CCA score (PC1 & PC2): 0.3330
  Saved trajectory plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots/trajectory_GEDI.png
============================================================
Multimodal Integration Evaluation: GEDI
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10

--- 1. Paired Sample Distance (lower = better) ---
  Number of pairs: 12
  Mean paired distance: 3.3914
  Std paired distance:  0.6222
  Median paired distance: 3.3367

--- 2. Modality Mixing (higher = better) ---
  Modalities: ['ATAC', 'RNA']
  iLISI mean:       1.0000
  iLISI normalized: 0.5000
  ASW modality:     0.2137

--- 3. Trajectory Analysis (age) using PC1 & PC2 (higher = better) ---
  Dimension pair: (1, 2) (PC1 & PC2)
  CCA score:           0.3330
  Pseudotime-age corr: 0.3066
  Age range:           70.0 - 165.0

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/evaluation_details/GEDI
Trajectory plots saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/summary.csv with column 'GEDI'
Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/Gloscope/knn_divergence_mds_10d.csv
Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  Using first 2 dimensions (PC1 and PC2) for CCA...
  CCA score (PC1 & PC2): 0.7784
  Saved trajectory plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots/trajectory_Gloscope.png
============================================================
Multimodal Integration Evaluation: Gloscope
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10

--- 1. Paired Sample Distance (lower = better) ---
  Number of pairs: 12
  Mean paired distance: 55.2163
  Std paired distance:  5.1895
  Median paired distance: 53.7521

--- 2. Modality Mixing (higher = better) ---
  Modalities: ['ATAC', 'RNA']
  iLISI mean:       1.0000
  iLISI normalized: 0.5000
  ASW modality:     0.1533

--- 3. Trajectory Analysis (age) using PC1 & PC2 (higher = better) ---
  Dimension pair: (1, 2) (PC1 & PC2)
  CCA score:           0.7784
  Pseudotime-age corr: -0.7782
  Age range:           70.0 - 165.0

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/evaluation_details/Gloscope
Trajectory plots saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/summary.csv with column 'Gloscope'
Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/MFA/sample_embeddings.csv
Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  Using first 2 dimensions (PC1 and PC2) for CCA...
  CCA score (PC1 & PC2): 0.1607
  Saved trajectory plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots/trajectory_MFA.png
============================================================
Multimodal Integration Evaluation: MFA
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10

--- 1. Paired Sample Distance (lower = better) ---
  Number of pairs: 12
  Mean paired distance: 3.6392
  Std paired distance:  0.0614
  Median paired distance: 3.6479

--- 2. Modality Mixing (higher = better) ---
  Modalities: ['ATAC', 'RNA']
  iLISI mean:       1.0000
  iLISI normalized: 0.5000
  ASW modality:     0.0369

--- 3. Trajectory Analysis (age) using PC1 & PC2 (higher = better) ---
  Dimension pair: (1, 2) (PC1 & PC2)
  CCA score:           0.1607
  Pseudotime-age corr: -0.1526
  Age range:           70.0 - 165.0

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/evaluation_details/MFA
Trajectory plots saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/summary.csv with column 'MFA'
Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/mustard/sample_embedding.csv
Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  Using first 2 dimensions (PC1 and PC2) for CCA...
  CCA score (PC1 & PC2): 0.5204
  Saved trajectory plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots/trajectory_mustard.png
============================================================
Multimodal Integration Evaluation: mustard
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10

--- 1. Paired Sample Distance (lower = better) ---
  Number of pairs: 12
  Mean paired distance: 0.8459
  Std paired distance:  0.0322
  Median paired distance: 0.8483

--- 2. Modality Mixing (higher = better) ---
  Modalities: ['ATAC', 'RNA']
  iLISI mean:       1.0000
  iLISI normalized: 0.5000
  ASW modality:     0.1935

--- 3. Trajectory Analysis (age) using PC1 & PC2 (higher = better) ---
  Dimension pair: (1, 2) (PC1 & PC2)
  CCA score:           0.5204
  Pseudotime-age corr: 0.3239
  Age range:           70.0 - 165.0

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/evaluation_details/mustard
Trajectory plots saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/summary.csv with column 'mustard'
Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/scPoli/sample_embeddings_full.csv
Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  Using first 2 dimensions (PC1 and PC2) for CCA...
  CCA score (PC1 & PC2): 0.6477
  Saved trajectory plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots/trajectory_scPoli.png
============================================================
Multimodal Integration Evaluation: scPoli
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10

--- 1. Paired Sample Distance (lower = better) ---
  Number of pairs: 12
  Mean paired distance: 1.3111
  Std paired distance:  0.0437
  Median paired distance: 1.3105

--- 2. Modality Mixing (higher = better) ---
  Modalities: ['ATAC', 'RNA']
  iLISI mean:       1.0000
  iLISI normalized: 0.5000
  ASW modality:     0.3436

--- 3. Trajectory Analysis (age) using PC1 & PC2 (higher = better) ---
  Dimension pair: (1, 2) (PC1 & PC2)
  CCA score:           0.6477
  Pseudotime-age corr: 0.6474
  Age range:           70.0 - 165.0

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/evaluation_details/scPoli
Trajectory plots saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/trajectory_plots
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_retina/summary.csv with column 'scPoli'
Multimodal Integration Benchmark module loaded.
Use evaluate_multimodal_integration() to run evaluation.
