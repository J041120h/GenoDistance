======================================
 Job ID:            21708269
 Job Name:          test
 Partition:         gpu
 Node List:         compute-170
 CPUs per Task:     16
 Memory Alloc:      1024000
 GPU Requested:     1
 Start Time:        Mon Sep  1 02:57:26 AM EDT 2025
======================================
Checking GPU status...
Mon Sep  1 02:57:29 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 555.42.06              Driver Version: 555.42.06      CUDA Version: 12.5     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H100 NVL                Off |   00000000:D1:00.0 Off |                    0 |
| N/A   44C    P0             90W /  400W |       1MiB /  95830MiB |      3%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Starting main.py...
Linux system detected with GPU enabled.
Resuming process from previous progress:
{
    "rna": {
        "preprocessing": false,
        "cell_type_cluster": false,
        "dimensionality_reduction": false,
        "sample_distance_calculation": false,
        "trajectory_analysis": false,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "atac": {
        "preprocessing": false,
        "cell_type_cluster": false,
        "dimensionality_reduction": false,
        "sample_distance_calculation": false,
        "trajectory_analysis": false,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "multiomics": {
        "glue_integration": false,
        "glue_preprocessing": false,
        "glue_training": false,
        "glue_gene_activity": false,
        "glue_cell_types": false,
        "glue_visualization": false,
        "integration_preprocessing": false,
        "dimensionality_reduction": false,
        "embedding_visualization": false,
        "optimal_resolution": false
    },
    "system_info": {
        "platform": "Linux",
        "python_version": "3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]",
        "use_gpu": true,
        "linux_system": true
    }
}

============================================================
RUNNING MULTIOMICS PIPELINE
============================================================
Starting multi-modal pipeline with output directory: /dcs07/hongkai/data/harry/result/multiomics
Initial status flags: {'glue_integration': False, 'glue_preprocessing': False, 'glue_training': False, 'glue_gene_activity': False, 'glue_cell_types': False, 'glue_visualization': False, 'integration_preprocessing': False, 'dimensionality_reduction': False, 'embedding_visualization': False, 'optimal_resolution': False}
Step 1: Running GLUE integration...
  Sub-steps: Preprocessing=False, Training=False, Gene Activity=True, Cell Types=True, Visualization=True
Computing gene activity...
üöÄ GPU acceleration enabled (cuML/CuPy detected)

üß¨ Computing gene activity using raw RNA counts and merging data...
   k_neighbors: 10
   metric: cosine
   weight method: cosine similarity
   Processed RNA shape: (430595, 36591)
   Raw RNA shape: (430595, 36601)
   ATAC shape: (430595, 3576085)
   ‚ö†Ô∏è  Gene indices don't match between processed and raw RNA, aligning...
   Aligned to 36591 common genes
üîç Finding k-nearest RNA neighbors for each ATAC cell...
   k-NN search completed in 6.87 seconds

üìê Computing cosine similarity weights...
   Cosine similarity computation completed in 0.03 seconds
   Average cosine similarity: 0.9248

üßÆ Computing weighted gene activity using raw RNA counts...
   Computing activity for 36591 genes across 430595 ATAC cells
   Progress: 5.7% (5/87 batches)
   Progress: 11.5% (10/87 batches)
   Progress: 17.2% (15/87 batches)
   Progress: 23.0% (20/87 batches)
   Progress: 28.7% (25/87 batches)
   Progress: 34.5% (30/87 batches)
   Progress: 40.2% (35/87 batches)
   Progress: 46.0% (40/87 batches)
   Progress: 51.7% (45/87 batches)
   Progress: 57.5% (50/87 batches)
   Progress: 63.2% (55/87 batches)
   Progress: 69.0% (60/87 batches)
   Progress: 74.7% (65/87 batches)
   Progress: 80.5% (70/87 batches)
   Progress: 86.2% (75/87 batches)
   Progress: 92.0% (80/87 batches)
   Progress: 97.7% (85/87 batches)
   Gene activity computation completed in 312.60 seconds

üîç Validating gene activity counts...
   Final count range: [0.000, 4109.112]

üì¶ Creating gene activity AnnData object...
üîó Merging gene activity data with raw RNA data...
Finished main.py.
End Time: Mon Sep  1 03:26:26 AM EDT 2025
