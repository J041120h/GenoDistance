2025-11-30 19:37:06,757 - INFO - Initialized BenchmarkWrapper (explicit paths) with:
2025-11-30 19:37:06,757 - INFO -   Meta CSV:          /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:06,758 - INFO -   Pseudotime CSV:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/CCA/pseudotime_expression.csv
2025-11-30 19:37:06,758 - INFO -   Embedding CSV:     /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/correlation/expression_DR_distance/expression_DR_coordinates.csv
2025-11-30 19:37:06,758 - INFO -   Method name:       SD_expression
2025-11-30 19:37:06,758 - INFO -   Output base dir:   /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample
2025-11-30 19:37:06,758 - INFO -   Run output dir:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/benchmark_results_SD_expression
2025-11-30 19:37:06,758 - INFO -   Summary CSV:       /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv
2025-11-30 19:37:06,758 - INFO - 
==================================================
2025-11-30 19:37:06,758 - INFO - Running embedding_visualization...
2025-11-30 19:37:06,758 - INFO - ==================================================
2025-11-30 19:37:06,758 - INFO - Running Embedding Visualization...
2025-11-30 19:37:06,758 - INFO - Loading metadata from: /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:06,763 - INFO - Loading embeddings from: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/correlation/expression_DR_distance/expression_DR_coordinates.csv
2025-11-30 19:37:06,766 - INFO - Performing PCA to 2 components...
2025-11-30 19:37:06,768 - INFO - Variance explained by PC1: 25.22%
2025-11-30 19:37:06,768 - INFO - Variance explained by PC2: 14.45%
2025-11-30 19:37:07,246 - INFO - Embedding visualization completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/benchmark_results_SD_expression/embedding_visualization
2025-11-30 19:37:07,246 - INFO - 
==================================================
2025-11-30 19:37:07,246 - INFO - Running trajectory_anova...
2025-11-30 19:37:07,246 - INFO - ==================================================
2025-11-30 19:37:07,246 - INFO - Running Trajectory ANOVA Analysis...
2025-11-30 19:37:07,626 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:07,629 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:07,630 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:09,030 - INFO - Trajectory ANOVA completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/benchmark_results_SD_expression/trajectory_anova
2025-11-30 19:37:09,030 - INFO - 
==================================================
2025-11-30 19:37:09,030 - INFO - Running batch_removal...
2025-11-30 19:37:09,030 - INFO - ==================================================
2025-11-30 19:37:09,030 - INFO - Running Batch Removal Evaluation...
Note: dropping 516 metadata rows without data match.
2025-11-30 19:37:09,055 - INFO - Batch removal evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/benchmark_results_SD_expression/batch_removal
2025-11-30 19:37:09,055 - INFO - 
==================================================
2025-11-30 19:37:09,055 - INFO - Running ari_clustering...
2025-11-30 19:37:09,055 - INFO - ==================================================
2025-11-30 19:37:09,055 - INFO - Running ARI Clustering Evaluation...
Reading metadata and data files...
Found severity levels: [np.int64(1), np.int64(2), np.int64(3), np.int64(4)]
Loaded embedding with shape (25, 10) (samples × dimensions)
Note: dropping 516 metadata rows without data match.
Found 4 unique severity levels: [1 2 3 4]
Using 4 clusters for KNN clustering
Performing KNN clustering with k=20...
Computing ARI and other metrics...
Generating visualizations...
2025-11-30 19:37:09,793 - INFO - ARI clustering evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/benchmark_results_SD_expression/ari_clustering
2025-11-30 19:37:09,793 - INFO - 
==================================================
2025-11-30 19:37:09,793 - INFO - Running trajectory_analysis...
2025-11-30 19:37:09,793 - INFO - ==================================================
2025-11-30 19:37:09,793 - INFO - Running Trajectory Analysis...
2025-11-30 19:37:10,571 - INFO - Trajectory analysis completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/benchmark_results_SD_expression/trajectory_analysis
2025-11-30 19:37:10,571 - INFO - 
==================================================
2025-11-30 19:37:10,571 - INFO - Running pseudotime_embeddings_custom...
2025-11-30 19:37:10,571 - INFO - ==================================================
2025-11-30 19:37:10,571 - INFO - Running Custom Pseudotime Embeddings Benchmark (simple schema)...
2025-11-30 19:37:10,866 - INFO - [DEBUG] embedding_visualization result keys: ['variance_explained', 'n_samples', 'n_features', 'sev_level_range', 'unique_batches', 'batch_labels', 'output_plot', 'output_pca']
2025-11-30 19:37:10,866 - INFO - [DEBUG] trajectory_anova result keys: ['anova_table', 'model', 'desc_stats', 'posthoc', 'data', 'pseudotime_col', 'n_samples', 'n_batches', 'n_severity_levels', 'model_type']
2025-11-30 19:37:10,867 - INFO - [DEBUG] batch_removal result keys: ['n_samples', 'batches', 'iLISI_mean', 'iLISI_std', 'iLISI_norm_mean', 'ASW_batch_overall', 'per_sample_path', 'summary_path']
2025-11-30 19:37:10,867 - INFO - [DEBUG] ari_clustering result keys: ['metrics', 'interpretation', 'n_samples', 'severity_levels', 'per_sample_path', 'summary_path', 'metrics_json_path']
2025-11-30 19:37:10,867 - INFO - [DEBUG] trajectory_analysis result keys: ['spearman_corr', 'spearman_p', 'n_samples', 'data', 'pseudotime_col']
2025-11-30 19:37:10,867 - INFO - [DEBUG] pseudotime_embeddings_custom result keys: ['paths', 'anova_anchor', 'anova_anchor_scipy', 'nn_gap_summary', 'nn_gap_per_sample']
2025-11-30 19:37:10,867 - INFO - [DEBUG] Collected metrics: {'n_samples': 25, 'batch_partial_eta_sq': 0.8584313290364478, 'severity_partial_eta_sq': 0.8212711295639733, 'interaction_partial_eta_sq': 0.43983160133772975, 'iLISI_norm': 0.36296069311093615, 'ASW_batch': 0.6365411591704168, 'ARI': -0.008813847297440799, 'NMI': 0.18549695549959574, 'Avg_Purity': np.float64(0.8409090909090909), 'Spearman_Correlation': np.float64(0.5698190744087281), 'Spearman_pval': np.float64(0.0029440323384801637), 'Mean_NN_Severity_Gap': 0.9375, 'Custom_ANOVA_pval': np.float64(0.06139916649528827)}
2025-11-30 19:37:10,872 - INFO - Updated summary CSV at: /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv with column 'SD_expression-25'
2025-11-30 19:37:10,873 - INFO - Initialized BenchmarkWrapper (explicit paths) with:
2025-11-30 19:37:10,873 - INFO -   Meta CSV:          /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:10,873 - INFO -   Pseudotime CSV:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/CCA/pseudotime_expression.csv
2025-11-30 19:37:10,873 - INFO -   Embedding CSV:     /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/Sample_distance/correlation/expression_DR_distance/expression_DR_coordinates.csv
2025-11-30 19:37:10,873 - INFO -   Method name:       SD_expression
2025-11-30 19:37:10,873 - INFO -   Output base dir:   /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample
2025-11-30 19:37:10,873 - INFO -   Run output dir:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/benchmark_results_SD_expression
2025-11-30 19:37:10,873 - INFO -   Summary CSV:       /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv
2025-11-30 19:37:10,873 - INFO - 
==================================================
2025-11-30 19:37:10,873 - INFO - Running embedding_visualization...
2025-11-30 19:37:10,873 - INFO - ==================================================
2025-11-30 19:37:10,873 - INFO - Running Embedding Visualization...
2025-11-30 19:37:10,874 - INFO - Loading metadata from: /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:10,875 - INFO - Loading embeddings from: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/Sample_distance/correlation/expression_DR_distance/expression_DR_coordinates.csv
2025-11-30 19:37:10,877 - INFO - Performing PCA to 2 components...
2025-11-30 19:37:10,878 - INFO - Variance explained by PC1: 17.38%
2025-11-30 19:37:10,878 - INFO - Variance explained by PC2: 14.14%
2025-11-30 19:37:11,422 - INFO - Embedding visualization completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/benchmark_results_SD_expression/embedding_visualization
2025-11-30 19:37:11,423 - INFO - 
==================================================
2025-11-30 19:37:11,423 - INFO - Running trajectory_anova...
2025-11-30 19:37:11,423 - INFO - ==================================================
2025-11-30 19:37:11,423 - INFO - Running Trajectory ANOVA Analysis...
2025-11-30 19:37:11,891 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:11,893 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:11,894 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:13,353 - INFO - Trajectory ANOVA completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/benchmark_results_SD_expression/trajectory_anova
2025-11-30 19:37:13,353 - INFO - 
==================================================
2025-11-30 19:37:13,353 - INFO - Running batch_removal...
2025-11-30 19:37:13,353 - INFO - ==================================================
2025-11-30 19:37:13,353 - INFO - Running Batch Removal Evaluation...
Note: dropping 491 metadata rows without data match.
2025-11-30 19:37:13,375 - INFO - Batch removal evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/benchmark_results_SD_expression/batch_removal
2025-11-30 19:37:13,376 - INFO - 
==================================================
2025-11-30 19:37:13,376 - INFO - Running ari_clustering...
2025-11-30 19:37:13,376 - INFO - ==================================================
2025-11-30 19:37:13,376 - INFO - Running ARI Clustering Evaluation...
Reading metadata and data files...
Found severity levels: [np.int64(1), np.int64(2), np.int64(3), np.int64(4)]
Loaded embedding with shape (50, 10) (samples × dimensions)
Note: dropping 491 metadata rows without data match.
Found 4 unique severity levels: [1 2 3 4]
Using 4 clusters for KNN clustering
Performing KNN clustering with k=20...
Computing ARI and other metrics...
Generating visualizations...
2025-11-30 19:37:14,100 - INFO - ARI clustering evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/benchmark_results_SD_expression/ari_clustering
2025-11-30 19:37:14,100 - INFO - 
==================================================
2025-11-30 19:37:14,100 - INFO - Running trajectory_analysis...
2025-11-30 19:37:14,100 - INFO - ==================================================
2025-11-30 19:37:14,100 - INFO - Running Trajectory Analysis...
2025-11-30 19:37:14,964 - INFO - Trajectory analysis completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/benchmark_results_SD_expression/trajectory_analysis
2025-11-30 19:37:14,964 - INFO - 
==================================================
2025-11-30 19:37:14,964 - INFO - Running pseudotime_embeddings_custom...
2025-11-30 19:37:14,964 - INFO - ==================================================
2025-11-30 19:37:14,964 - INFO - Running Custom Pseudotime Embeddings Benchmark (simple schema)...
2025-11-30 19:37:15,238 - INFO - [DEBUG] embedding_visualization result keys: ['variance_explained', 'n_samples', 'n_features', 'sev_level_range', 'unique_batches', 'batch_labels', 'output_plot', 'output_pca']
2025-11-30 19:37:15,238 - INFO - [DEBUG] trajectory_anova result keys: ['anova_table', 'model', 'desc_stats', 'posthoc', 'data', 'pseudotime_col', 'n_samples', 'n_batches', 'n_severity_levels', 'model_type']
2025-11-30 19:37:15,238 - INFO - [DEBUG] batch_removal result keys: ['n_samples', 'batches', 'iLISI_mean', 'iLISI_std', 'iLISI_norm_mean', 'ASW_batch_overall', 'per_sample_path', 'summary_path']
2025-11-30 19:37:15,238 - INFO - [DEBUG] ari_clustering result keys: ['metrics', 'interpretation', 'n_samples', 'severity_levels', 'per_sample_path', 'summary_path', 'metrics_json_path']
2025-11-30 19:37:15,238 - INFO - [DEBUG] trajectory_analysis result keys: ['spearman_corr', 'spearman_p', 'n_samples', 'data', 'pseudotime_col']
2025-11-30 19:37:15,238 - INFO - [DEBUG] pseudotime_embeddings_custom result keys: ['paths', 'anova_anchor', 'anova_anchor_scipy', 'nn_gap_summary', 'nn_gap_per_sample']
2025-11-30 19:37:15,239 - INFO - [DEBUG] Collected metrics: {'n_samples': 50, 'batch_partial_eta_sq': 0.8677617411572616, 'severity_partial_eta_sq': -5.820955657811523e-14, 'interaction_partial_eta_sq': 0.782714589749288, 'iLISI_norm': 0.24854388158328278, 'ASW_batch': 0.6797226284456669, 'ARI': 0.02455433884869058, 'NMI': 0.1283541033267712, 'Avg_Purity': np.float64(0.8457446808510638), 'Spearman_Correlation': np.float64(0.5683904265690919), 'Spearman_pval': np.float64(1.662800984589114e-05), 'Mean_NN_Severity_Gap': 1.4482758620689655, 'Custom_ANOVA_pval': np.float64(0.3366132531279883)}
2025-11-30 19:37:15,243 - INFO - Updated summary CSV at: /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv with column 'SD_expression-50'
2025-11-30 19:37:15,245 - INFO - Initialized BenchmarkWrapper (explicit paths) with:
2025-11-30 19:37:15,245 - INFO -   Meta CSV:          /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:15,245 - INFO -   Pseudotime CSV:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample/rna/CCA/pseudotime_expression.csv
2025-11-30 19:37:15,245 - INFO -   Embedding CSV:     /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample/rna/Sample_distance/correlation/expression_DR_distance/expression_DR_coordinates.csv
2025-11-30 19:37:15,245 - INFO -   Method name:       SD_expression
2025-11-30 19:37:15,245 - INFO -   Output base dir:   /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample
2025-11-30 19:37:15,245 - INFO -   Run output dir:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample/benchmark_results_SD_expression
2025-11-30 19:37:15,245 - INFO -   Summary CSV:       /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv
2025-11-30 19:37:15,245 - INFO - 
==================================================
2025-11-30 19:37:15,245 - INFO - Running embedding_visualization...
2025-11-30 19:37:15,245 - INFO - ==================================================
2025-11-30 19:37:15,245 - INFO - Running Embedding Visualization...
2025-11-30 19:37:15,246 - INFO - Loading metadata from: /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:15,247 - INFO - Loading embeddings from: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample/rna/Sample_distance/correlation/expression_DR_distance/expression_DR_coordinates.csv
2025-11-30 19:37:15,249 - INFO - Performing PCA to 2 components...
2025-11-30 19:37:15,250 - INFO - Variance explained by PC1: 26.79%
2025-11-30 19:37:15,250 - INFO - Variance explained by PC2: 15.67%
2025-11-30 19:37:15,735 - INFO - Embedding visualization completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample/benchmark_results_SD_expression/embedding_visualization
2025-11-30 19:37:15,736 - INFO - 
==================================================
2025-11-30 19:37:15,736 - INFO - Running trajectory_anova...
2025-11-30 19:37:15,736 - INFO - ==================================================
2025-11-30 19:37:15,736 - INFO - Running Trajectory ANOVA Analysis...
2025-11-30 19:37:16,096 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:16,098 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:16,099 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:17,707 - INFO - Trajectory ANOVA completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample/benchmark_results_SD_expression/trajectory_anova
2025-11-30 19:37:17,707 - INFO - 
==================================================
2025-11-30 19:37:17,707 - INFO - Running batch_removal...
2025-11-30 19:37:17,707 - INFO - ==================================================
2025-11-30 19:37:17,707 - INFO - Running Batch Removal Evaluation...
Note: dropping 441 metadata rows without data match.
2025-11-30 19:37:17,739 - INFO - Batch removal evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample/benchmark_results_SD_expression/batch_removal
2025-11-30 19:37:17,739 - INFO - 
==================================================
2025-11-30 19:37:17,739 - INFO - Running ari_clustering...
2025-11-30 19:37:17,739 - INFO - ==================================================
2025-11-30 19:37:17,739 - INFO - Running ARI Clustering Evaluation...
Reading metadata and data files...
Found severity levels: [np.int64(1), np.int64(2), np.int64(3), np.int64(4)]
Loaded embedding with shape (100, 10) (samples × dimensions)
Note: dropping 441 metadata rows without data match.
Found 4 unique severity levels: [1 2 3 4]
Using 4 clusters for KNN clustering
Performing KNN clustering with k=20...
Computing ARI and other metrics...
Generating visualizations...
2025-11-30 19:37:18,456 - INFO - ARI clustering evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample/benchmark_results_SD_expression/ari_clustering
2025-11-30 19:37:18,456 - INFO - 
==================================================
2025-11-30 19:37:18,456 - INFO - Running trajectory_analysis...
2025-11-30 19:37:18,456 - INFO - ==================================================
2025-11-30 19:37:18,456 - INFO - Running Trajectory Analysis...
2025-11-30 19:37:19,252 - INFO - Trajectory analysis completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample/benchmark_results_SD_expression/trajectory_analysis
2025-11-30 19:37:19,252 - INFO - 
==================================================
2025-11-30 19:37:19,252 - INFO - Running pseudotime_embeddings_custom...
2025-11-30 19:37:19,252 - INFO - ==================================================
2025-11-30 19:37:19,252 - INFO - Running Custom Pseudotime Embeddings Benchmark (simple schema)...
2025-11-30 19:37:19,536 - INFO - [DEBUG] embedding_visualization result keys: ['variance_explained', 'n_samples', 'n_features', 'sev_level_range', 'unique_batches', 'batch_labels', 'output_plot', 'output_pca']
2025-11-30 19:37:19,536 - INFO - [DEBUG] trajectory_anova result keys: ['anova_table', 'model', 'desc_stats', 'posthoc', 'data', 'pseudotime_col', 'n_samples', 'n_batches', 'n_severity_levels', 'model_type']
2025-11-30 19:37:19,536 - INFO - [DEBUG] batch_removal result keys: ['n_samples', 'batches', 'iLISI_mean', 'iLISI_std', 'iLISI_norm_mean', 'ASW_batch_overall', 'per_sample_path', 'summary_path']
2025-11-30 19:37:19,536 - INFO - [DEBUG] ari_clustering result keys: ['metrics', 'interpretation', 'n_samples', 'severity_levels', 'per_sample_path', 'summary_path', 'metrics_json_path']
2025-11-30 19:37:19,536 - INFO - [DEBUG] trajectory_analysis result keys: ['spearman_corr', 'spearman_p', 'n_samples', 'data', 'pseudotime_col']
2025-11-30 19:37:19,536 - INFO - [DEBUG] pseudotime_embeddings_custom result keys: ['paths', 'anova_anchor', 'anova_anchor_scipy', 'nn_gap_summary', 'nn_gap_per_sample']
2025-11-30 19:37:19,536 - INFO - [DEBUG] Collected metrics: {'n_samples': 100, 'batch_partial_eta_sq': 0.5229772794506542, 'severity_partial_eta_sq': 1.2803697547348807e-13, 'interaction_partial_eta_sq': 0.17709147426476857, 'iLISI_norm': 0.20320132502830884, 'ASW_batch': 0.5265442372844228, 'ARI': -0.005934254209591774, 'NMI': 0.04700371576657798, 'Avg_Purity': np.float64(0.845360824742268), 'Spearman_Correlation': np.float64(0.5885143573570603), 'Spearman_pval': np.float64(1.2010447364677603e-10), 'Mean_NN_Severity_Gap': 1.3709677419354838, 'Custom_ANOVA_pval': np.float64(7.975940288621127e-09)}
2025-11-30 19:37:19,541 - INFO - Updated summary CSV at: /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv with column 'SD_expression-100'
2025-11-30 19:37:19,552 - INFO - Initialized BenchmarkWrapper (explicit paths) with:
2025-11-30 19:37:19,553 - INFO -   Meta CSV:          /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:19,553 - INFO -   Pseudotime CSV:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample/rna/CCA/pseudotime_expression.csv
2025-11-30 19:37:19,553 - INFO -   Embedding CSV:     /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample/rna/Sample_distance/correlation/expression_DR_distance/expression_DR_coordinates.csv
2025-11-30 19:37:19,553 - INFO -   Method name:       SD_expression
2025-11-30 19:37:19,553 - INFO -   Output base dir:   /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample
2025-11-30 19:37:19,553 - INFO -   Run output dir:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample/benchmark_results_SD_expression
2025-11-30 19:37:19,553 - INFO -   Summary CSV:       /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv
2025-11-30 19:37:19,553 - INFO - 
==================================================
2025-11-30 19:37:19,553 - INFO - Running embedding_visualization...
2025-11-30 19:37:19,553 - INFO - ==================================================
2025-11-30 19:37:19,553 - INFO - Running Embedding Visualization...
2025-11-30 19:37:19,553 - INFO - Loading metadata from: /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:19,554 - INFO - Loading embeddings from: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample/rna/Sample_distance/correlation/expression_DR_distance/expression_DR_coordinates.csv
2025-11-30 19:37:19,577 - INFO - Performing PCA to 2 components...
2025-11-30 19:37:19,578 - INFO - Variance explained by PC1: 35.97%
2025-11-30 19:37:19,578 - INFO - Variance explained by PC2: 16.73%
2025-11-30 19:37:20,116 - INFO - Embedding visualization completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample/benchmark_results_SD_expression/embedding_visualization
2025-11-30 19:37:20,116 - INFO - 
==================================================
2025-11-30 19:37:20,116 - INFO - Running trajectory_anova...
2025-11-30 19:37:20,116 - INFO - ==================================================
2025-11-30 19:37:20,116 - INFO - Running Trajectory ANOVA Analysis...
2025-11-30 19:37:20,759 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:20,762 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:20,763 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:22,386 - INFO - Trajectory ANOVA completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample/benchmark_results_SD_expression/trajectory_anova
2025-11-30 19:37:22,386 - INFO - 
==================================================
2025-11-30 19:37:22,386 - INFO - Running batch_removal...
2025-11-30 19:37:22,386 - INFO - ==================================================
2025-11-30 19:37:22,386 - INFO - Running Batch Removal Evaluation...
Note: dropping 341 metadata rows without data match.
2025-11-30 19:37:22,412 - INFO - Batch removal evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample/benchmark_results_SD_expression/batch_removal
2025-11-30 19:37:22,412 - INFO - 
==================================================
2025-11-30 19:37:22,412 - INFO - Running ari_clustering...
2025-11-30 19:37:22,412 - INFO - ==================================================
2025-11-30 19:37:22,412 - INFO - Running ARI Clustering Evaluation...
Reading metadata and data files...
Found severity levels: [np.int64(1), np.int64(2), np.int64(3), np.int64(4)]
Loaded embedding with shape (200, 10) (samples × dimensions)
Note: dropping 341 metadata rows without data match.
Found 4 unique severity levels: [1 2 3 4]
Using 4 clusters for KNN clustering
Performing KNN clustering with k=20...
Computing ARI and other metrics...
Generating visualizations...
2025-11-30 19:37:23,183 - INFO - ARI clustering evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample/benchmark_results_SD_expression/ari_clustering
2025-11-30 19:37:23,183 - INFO - 
==================================================
2025-11-30 19:37:23,183 - INFO - Running trajectory_analysis...
2025-11-30 19:37:23,183 - INFO - ==================================================
2025-11-30 19:37:23,183 - INFO - Running Trajectory Analysis...
2025-11-30 19:37:24,062 - INFO - Trajectory analysis completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample/benchmark_results_SD_expression/trajectory_analysis
2025-11-30 19:37:24,062 - INFO - 
==================================================
2025-11-30 19:37:24,062 - INFO - Running pseudotime_embeddings_custom...
2025-11-30 19:37:24,062 - INFO - ==================================================
2025-11-30 19:37:24,062 - INFO - Running Custom Pseudotime Embeddings Benchmark (simple schema)...
2025-11-30 19:37:24,355 - INFO - [DEBUG] embedding_visualization result keys: ['variance_explained', 'n_samples', 'n_features', 'sev_level_range', 'unique_batches', 'batch_labels', 'output_plot', 'output_pca']
2025-11-30 19:37:24,355 - INFO - [DEBUG] trajectory_anova result keys: ['anova_table', 'model', 'desc_stats', 'posthoc', 'data', 'pseudotime_col', 'n_samples', 'n_batches', 'n_severity_levels', 'model_type']
2025-11-30 19:37:24,355 - INFO - [DEBUG] batch_removal result keys: ['n_samples', 'batches', 'iLISI_mean', 'iLISI_std', 'iLISI_norm_mean', 'ASW_batch_overall', 'per_sample_path', 'summary_path']
2025-11-30 19:37:24,355 - INFO - [DEBUG] ari_clustering result keys: ['metrics', 'interpretation', 'n_samples', 'severity_levels', 'per_sample_path', 'summary_path', 'metrics_json_path']
2025-11-30 19:37:24,355 - INFO - [DEBUG] trajectory_analysis result keys: ['spearman_corr', 'spearman_p', 'n_samples', 'data', 'pseudotime_col']
2025-11-30 19:37:24,355 - INFO - [DEBUG] pseudotime_embeddings_custom result keys: ['paths', 'anova_anchor', 'anova_anchor_scipy', 'nn_gap_summary', 'nn_gap_per_sample']
2025-11-30 19:37:24,355 - INFO - [DEBUG] Collected metrics: {'n_samples': 200, 'batch_partial_eta_sq': 0.3985702068033998, 'severity_partial_eta_sq': -3.109915532177289e-11, 'interaction_partial_eta_sq': 0.6759355503143234, 'iLISI_norm': 0.13803564435248875, 'ASW_batch': 0.40074456372524936, 'ARI': -0.02494445648106602, 'NMI': 0.07121216354138266, 'Avg_Purity': np.float64(0.6942744755244755), 'Spearman_Correlation': np.float64(0.5742210251367883), 'Spearman_pval': np.float64(6.1434702645538e-19), 'Mean_NN_Severity_Gap': 1.317829457364341, 'Custom_ANOVA_pval': np.float64(9.348194114415153e-15)}
2025-11-30 19:37:24,360 - INFO - Updated summary CSV at: /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv with column 'SD_expression-200'
2025-11-30 19:37:24,362 - INFO - Initialized BenchmarkWrapper (explicit paths) with:
2025-11-30 19:37:24,362 - INFO -   Meta CSV:          /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:24,362 - INFO -   Pseudotime CSV:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_279_sample/rna/CCA/pseudotime_expression.csv
2025-11-30 19:37:24,362 - INFO -   Embedding CSV:     /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_279_sample/rna/Sample_distance/correlation/expression_DR_distance/expression_DR_coordinates.csv
2025-11-30 19:37:24,362 - INFO -   Method name:       SD_expression
2025-11-30 19:37:24,362 - INFO -   Output base dir:   /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_279_sample
2025-11-30 19:37:24,362 - INFO -   Run output dir:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_279_sample/benchmark_results_SD_expression
2025-11-30 19:37:24,362 - INFO -   Summary CSV:       /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv
2025-11-30 19:37:24,362 - INFO - 
==================================================
2025-11-30 19:37:24,362 - INFO - Running embedding_visualization...
2025-11-30 19:37:24,362 - INFO - ==================================================
2025-11-30 19:37:24,362 - INFO - Running Embedding Visualization...
2025-11-30 19:37:24,362 - INFO - Loading metadata from: /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:24,363 - INFO - Loading embeddings from: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_279_sample/rna/Sample_distance/correlation/expression_DR_distance/expression_DR_coordinates.csv
2025-11-30 19:37:24,377 - INFO - Performing PCA to 2 components...
2025-11-30 19:37:24,378 - INFO - Variance explained by PC1: 37.22%
2025-11-30 19:37:24,378 - INFO - Variance explained by PC2: 17.27%
2025-11-30 19:37:24,874 - INFO - Embedding visualization completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_279_sample/benchmark_results_SD_expression/embedding_visualization
2025-11-30 19:37:24,875 - INFO - 
==================================================
2025-11-30 19:37:24,875 - INFO - Running trajectory_anova...
2025-11-30 19:37:24,875 - INFO - ==================================================
2025-11-30 19:37:24,875 - INFO - Running Trajectory ANOVA Analysis...
2025-11-30 19:37:25,101 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:25,104 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:25,104 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:26,289 - INFO - Trajectory ANOVA completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_279_sample/benchmark_results_SD_expression/trajectory_anova
2025-11-30 19:37:26,289 - INFO - 
==================================================
2025-11-30 19:37:26,289 - INFO - Running batch_removal...
2025-11-30 19:37:26,289 - INFO - ==================================================
2025-11-30 19:37:26,289 - INFO - Running Batch Removal Evaluation...
Note: dropping 292 metadata rows without data match.
2025-11-30 19:37:26,311 - ERROR - Error in batch removal evaluation: Number of labels is 1. Valid values are 2 to n_samples - 1 (inclusive)
2025-11-30 19:37:26,311 - INFO - 
==================================================
2025-11-30 19:37:26,311 - INFO - Running ari_clustering...
2025-11-30 19:37:26,311 - INFO - ==================================================
2025-11-30 19:37:26,311 - INFO - Running ARI Clustering Evaluation...
Reading metadata and data files...
Found severity levels: [np.int64(1), np.int64(2), np.int64(3), np.int64(4)]
Loaded embedding with shape (249, 10) (samples × dimensions)
Note: dropping 292 metadata rows without data match.
Found 4 unique severity levels: [1 2 3 4]
Using 4 clusters for KNN clustering
Performing KNN clustering with k=20...
Computing ARI and other metrics...
Generating visualizations...
2025-11-30 19:37:27,141 - INFO - ARI clustering evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_279_sample/benchmark_results_SD_expression/ari_clustering
2025-11-30 19:37:27,141 - INFO - 
==================================================
2025-11-30 19:37:27,141 - INFO - Running trajectory_analysis...
2025-11-30 19:37:27,141 - INFO - ==================================================
2025-11-30 19:37:27,141 - INFO - Running Trajectory Analysis...
2025-11-30 19:37:27,967 - INFO - Trajectory analysis completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_279_sample/benchmark_results_SD_expression/trajectory_analysis
2025-11-30 19:37:27,968 - INFO - 
==================================================
2025-11-30 19:37:27,968 - INFO - Running pseudotime_embeddings_custom...
2025-11-30 19:37:27,968 - INFO - ==================================================
2025-11-30 19:37:27,968 - INFO - Running Custom Pseudotime Embeddings Benchmark (simple schema)...
2025-11-30 19:37:28,118 - INFO - [DEBUG] embedding_visualization result keys: ['variance_explained', 'n_samples', 'n_features', 'sev_level_range', 'unique_batches', 'batch_labels', 'output_plot', 'output_pca']
2025-11-30 19:37:28,118 - INFO - [DEBUG] trajectory_anova result keys: ['anova_table', 'model', 'desc_stats', 'posthoc', 'data', 'pseudotime_col', 'n_samples', 'n_batches', 'n_severity_levels', 'model_type']
2025-11-30 19:37:28,118 - WARNING - Skipping batch_removal in summary - status was not 'success'
2025-11-30 19:37:28,119 - INFO - [DEBUG] ari_clustering result keys: ['metrics', 'interpretation', 'n_samples', 'severity_levels', 'per_sample_path', 'summary_path', 'metrics_json_path']
2025-11-30 19:37:28,119 - INFO - [DEBUG] trajectory_analysis result keys: ['spearman_corr', 'spearman_p', 'n_samples', 'data', 'pseudotime_col']
2025-11-30 19:37:28,119 - INFO - [DEBUG] pseudotime_embeddings_custom result keys: ['paths', 'anova_anchor', 'anova_anchor_scipy', 'nn_gap_summary', 'nn_gap_per_sample']
2025-11-30 19:37:28,119 - INFO - [DEBUG] Collected metrics: {'n_samples': 249, 'severity_partial_eta_sq': 0.45262358985843626, 'ARI': 0.0024678549821651875, 'NMI': 0.02368600242929913, 'Avg_Purity': np.float64(0.8526422764227642), 'Spearman_Correlation': np.float64(0.6807132218091799), 'Spearman_pval': np.float64(3.0549052698708e-35), 'Custom_ANOVA_pval': np.float64(7.376885364049659e-32)}
2025-11-30 19:37:28,123 - INFO - Updated summary CSV at: /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv with column 'SD_expression-249'
2025-11-30 19:37:28,125 - INFO - Initialized BenchmarkWrapper (explicit paths) with:
2025-11-30 19:37:28,125 - INFO -   Meta CSV:          /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:28,125 - INFO -   Pseudotime CSV:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/CCA/pseudotime_expression.csv
2025-11-30 19:37:28,125 - INFO -   Embedding CSV:     /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/Sample_distance/correlation/expression_DR_distance/expression_DR_coordinates.csv
2025-11-30 19:37:28,125 - INFO -   Method name:       SD_expression
2025-11-30 19:37:28,125 - INFO -   Output base dir:   /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample
2025-11-30 19:37:28,125 - INFO -   Run output dir:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/benchmark_results_SD_expression
2025-11-30 19:37:28,125 - INFO -   Summary CSV:       /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv
2025-11-30 19:37:28,125 - INFO - 
==================================================
2025-11-30 19:37:28,125 - INFO - Running embedding_visualization...
2025-11-30 19:37:28,125 - INFO - ==================================================
2025-11-30 19:37:28,125 - INFO - Running Embedding Visualization...
2025-11-30 19:37:28,125 - INFO - Loading metadata from: /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:28,126 - INFO - Loading embeddings from: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/Sample_distance/correlation/expression_DR_distance/expression_DR_coordinates.csv
2025-11-30 19:37:28,147 - INFO - Performing PCA to 2 components...
2025-11-30 19:37:28,148 - INFO - Variance explained by PC1: 30.25%
2025-11-30 19:37:28,148 - INFO - Variance explained by PC2: 27.72%
2025-11-30 19:37:28,708 - INFO - Embedding visualization completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/benchmark_results_SD_expression/embedding_visualization
2025-11-30 19:37:28,708 - INFO - 
==================================================
2025-11-30 19:37:28,708 - INFO - Running trajectory_anova...
2025-11-30 19:37:28,708 - INFO - ==================================================
2025-11-30 19:37:28,708 - INFO - Running Trajectory ANOVA Analysis...
2025-11-30 19:37:28,801 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:28,804 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:28,804 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:30,539 - INFO - Trajectory ANOVA completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/benchmark_results_SD_expression/trajectory_anova
2025-11-30 19:37:30,539 - INFO - 
==================================================
2025-11-30 19:37:30,539 - INFO - Running batch_removal...
2025-11-30 19:37:30,539 - INFO - ==================================================
2025-11-30 19:37:30,539 - INFO - Running Batch Removal Evaluation...
Note: dropping 136 metadata rows without data match.
2025-11-30 19:37:30,570 - INFO - Batch removal evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/benchmark_results_SD_expression/batch_removal
2025-11-30 19:37:30,570 - INFO - 
==================================================
2025-11-30 19:37:30,570 - INFO - Running ari_clustering...
2025-11-30 19:37:30,570 - INFO - ==================================================
2025-11-30 19:37:30,570 - INFO - Running ARI Clustering Evaluation...
Reading metadata and data files...
Found severity levels: [np.int64(1), np.int64(2), np.int64(3), np.int64(4)]
Loaded embedding with shape (405, 10) (samples × dimensions)
Note: dropping 136 metadata rows without data match.
Found 4 unique severity levels: [1 2 3 4]
Using 4 clusters for KNN clustering
Performing KNN clustering with k=20...
Computing ARI and other metrics...
Generating visualizations...
2025-11-30 19:37:31,369 - INFO - ARI clustering evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/benchmark_results_SD_expression/ari_clustering
2025-11-30 19:37:31,369 - INFO - 
==================================================
2025-11-30 19:37:31,369 - INFO - Running trajectory_analysis...
2025-11-30 19:37:31,369 - INFO - ==================================================
2025-11-30 19:37:31,369 - INFO - Running Trajectory Analysis...
2025-11-30 19:37:32,198 - INFO - Trajectory analysis completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/benchmark_results_SD_expression/trajectory_analysis
2025-11-30 19:37:32,198 - INFO - 
==================================================
2025-11-30 19:37:32,198 - INFO - Running pseudotime_embeddings_custom...
2025-11-30 19:37:32,198 - INFO - ==================================================
2025-11-30 19:37:32,199 - INFO - Running Custom Pseudotime Embeddings Benchmark (simple schema)...
2025-11-30 19:37:32,484 - INFO - [DEBUG] embedding_visualization result keys: ['variance_explained', 'n_samples', 'n_features', 'sev_level_range', 'unique_batches', 'batch_labels', 'output_plot', 'output_pca']
2025-11-30 19:37:32,484 - INFO - [DEBUG] trajectory_anova result keys: ['anova_table', 'model', 'desc_stats', 'posthoc', 'data', 'pseudotime_col', 'n_samples', 'n_batches', 'n_severity_levels', 'model_type']
2025-11-30 19:37:32,484 - INFO - [DEBUG] batch_removal result keys: ['n_samples', 'batches', 'iLISI_mean', 'iLISI_std', 'iLISI_norm_mean', 'ASW_batch_overall', 'per_sample_path', 'summary_path']
2025-11-30 19:37:32,484 - INFO - [DEBUG] ari_clustering result keys: ['metrics', 'interpretation', 'n_samples', 'severity_levels', 'per_sample_path', 'summary_path', 'metrics_json_path']
2025-11-30 19:37:32,484 - INFO - [DEBUG] trajectory_analysis result keys: ['spearman_corr', 'spearman_p', 'n_samples', 'data', 'pseudotime_col']
2025-11-30 19:37:32,484 - INFO - [DEBUG] pseudotime_embeddings_custom result keys: ['paths', 'anova_anchor', 'anova_anchor_scipy', 'nn_gap_summary', 'nn_gap_per_sample']
2025-11-30 19:37:32,484 - INFO - [DEBUG] Collected metrics: {'n_samples': 405, 'batch_partial_eta_sq': 0.02657576468891505, 'severity_partial_eta_sq': -0.4334117686277097, 'interaction_partial_eta_sq': 0.16182230615683058, 'iLISI_norm': 0.21525154012313175, 'ASW_batch': 0.6017209672087214, 'ARI': -0.0001792428282822988, 'NMI': 0.01347038815734094, 'Avg_Purity': np.float64(0.8457711442786069), 'Spearman_Correlation': np.float64(0.5665419499211982), 'Spearman_pval': np.float64(9.315373812532913e-36), 'Mean_NN_Severity_Gap': 1.0040160642570282, 'Custom_ANOVA_pval': np.float64(1.125904301200268e-25)}
2025-11-30 19:37:32,489 - INFO - Updated summary CSV at: /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv with column 'SD_expression-405'
2025-11-30 19:37:32,490 - INFO - Initialized BenchmarkWrapper (explicit paths) with:
2025-11-30 19:37:32,490 - INFO -   Meta CSV:          /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:32,490 - INFO -   Pseudotime CSV:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/CCA/pseudotime_proportion.csv
2025-11-30 19:37:32,490 - INFO -   Embedding CSV:     /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/correlation/proportion_DR_distance/proportion_DR_coordinates.csv
2025-11-30 19:37:32,490 - INFO -   Method name:       SD_proportion
2025-11-30 19:37:32,490 - INFO -   Output base dir:   /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample
2025-11-30 19:37:32,490 - INFO -   Run output dir:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/benchmark_results_SD_proportion
2025-11-30 19:37:32,490 - INFO -   Summary CSV:       /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv
2025-11-30 19:37:32,490 - INFO - 
==================================================
2025-11-30 19:37:32,491 - INFO - Running embedding_visualization...
2025-11-30 19:37:32,491 - INFO - ==================================================
2025-11-30 19:37:32,491 - INFO - Running Embedding Visualization...
2025-11-30 19:37:32,491 - INFO - Loading metadata from: /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:32,492 - INFO - Loading embeddings from: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/correlation/proportion_DR_distance/proportion_DR_coordinates.csv
2025-11-30 19:37:32,494 - INFO - Performing PCA to 2 components...
2025-11-30 19:37:32,495 - INFO - Variance explained by PC1: 67.31%
2025-11-30 19:37:32,495 - INFO - Variance explained by PC2: 22.81%
2025-11-30 19:37:33,019 - INFO - Embedding visualization completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/benchmark_results_SD_proportion/embedding_visualization
2025-11-30 19:37:33,019 - INFO - 
==================================================
2025-11-30 19:37:33,019 - INFO - Running trajectory_anova...
2025-11-30 19:37:33,019 - INFO - ==================================================
2025-11-30 19:37:33,019 - INFO - Running Trajectory ANOVA Analysis...
2025-11-30 19:37:33,091 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:33,093 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:33,094 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:34,439 - INFO - Trajectory ANOVA completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/benchmark_results_SD_proportion/trajectory_anova
2025-11-30 19:37:34,439 - INFO - 
==================================================
2025-11-30 19:37:34,439 - INFO - Running batch_removal...
2025-11-30 19:37:34,440 - INFO - ==================================================
2025-11-30 19:37:34,440 - INFO - Running Batch Removal Evaluation...
Note: dropping 516 metadata rows without data match.
2025-11-30 19:37:34,462 - INFO - Batch removal evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/benchmark_results_SD_proportion/batch_removal
2025-11-30 19:37:34,462 - INFO - 
==================================================
2025-11-30 19:37:34,462 - INFO - Running ari_clustering...
2025-11-30 19:37:34,462 - INFO - ==================================================
2025-11-30 19:37:34,462 - INFO - Running ARI Clustering Evaluation...
Reading metadata and data files...
Found severity levels: [np.int64(1), np.int64(2), np.int64(3), np.int64(4)]
Loaded embedding with shape (25, 5) (samples × dimensions)
Note: dropping 516 metadata rows without data match.
Found 4 unique severity levels: [1 2 3 4]
Using 4 clusters for KNN clustering
Performing KNN clustering with k=20...
Computing ARI and other metrics...
Generating visualizations...
2025-11-30 19:37:35,160 - INFO - ARI clustering evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/benchmark_results_SD_proportion/ari_clustering
2025-11-30 19:37:35,160 - INFO - 
==================================================
2025-11-30 19:37:35,160 - INFO - Running trajectory_analysis...
2025-11-30 19:37:35,160 - INFO - ==================================================
2025-11-30 19:37:35,160 - INFO - Running Trajectory Analysis...
2025-11-30 19:37:36,047 - INFO - Trajectory analysis completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/benchmark_results_SD_proportion/trajectory_analysis
2025-11-30 19:37:36,047 - INFO - 
==================================================
2025-11-30 19:37:36,047 - INFO - Running pseudotime_embeddings_custom...
2025-11-30 19:37:36,048 - INFO - ==================================================
2025-11-30 19:37:36,048 - INFO - Running Custom Pseudotime Embeddings Benchmark (simple schema)...
2025-11-30 19:37:36,344 - INFO - [DEBUG] embedding_visualization result keys: ['variance_explained', 'n_samples', 'n_features', 'sev_level_range', 'unique_batches', 'batch_labels', 'output_plot', 'output_pca']
2025-11-30 19:37:36,344 - INFO - [DEBUG] trajectory_anova result keys: ['anova_table', 'model', 'desc_stats', 'posthoc', 'data', 'pseudotime_col', 'n_samples', 'n_batches', 'n_severity_levels', 'model_type']
2025-11-30 19:37:36,344 - INFO - [DEBUG] batch_removal result keys: ['n_samples', 'batches', 'iLISI_mean', 'iLISI_std', 'iLISI_norm_mean', 'ASW_batch_overall', 'per_sample_path', 'summary_path']
2025-11-30 19:37:36,344 - INFO - [DEBUG] ari_clustering result keys: ['metrics', 'interpretation', 'n_samples', 'severity_levels', 'per_sample_path', 'summary_path', 'metrics_json_path']
2025-11-30 19:37:36,344 - INFO - [DEBUG] trajectory_analysis result keys: ['spearman_corr', 'spearman_p', 'n_samples', 'data', 'pseudotime_col']
2025-11-30 19:37:36,344 - INFO - [DEBUG] pseudotime_embeddings_custom result keys: ['paths', 'anova_anchor', 'anova_anchor_scipy', 'nn_gap_summary', 'nn_gap_per_sample']
2025-11-30 19:37:36,344 - INFO - [DEBUG] Collected metrics: {'n_samples': 25, 'batch_partial_eta_sq': 0.13306134564173552, 'severity_partial_eta_sq': 0.029914818165712828, 'interaction_partial_eta_sq': 0.5121884622586885, 'iLISI_norm': 0.3839071383616441, 'ASW_batch': 0.7011503233982412, 'ARI': 0.023322837167102525, 'NMI': 0.13355141306621834, 'Avg_Purity': np.float64(0.44294871794871793), 'Spearman_Correlation': np.float64(-0.4069558921486448), 'Spearman_pval': np.float64(0.04349200363859849), 'Mean_NN_Severity_Gap': 1.0625, 'Custom_ANOVA_pval': np.float64(0.18200882107868768)}
2025-11-30 19:37:36,353 - INFO - Updated summary CSV at: /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv with column 'SD_proportion-25'
2025-11-30 19:37:36,355 - INFO - Initialized BenchmarkWrapper (explicit paths) with:
2025-11-30 19:37:36,355 - INFO -   Meta CSV:          /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:36,355 - INFO -   Pseudotime CSV:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/CCA/pseudotime_proportion.csv
2025-11-30 19:37:36,355 - INFO -   Embedding CSV:     /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/Sample_distance/correlation/proportion_DR_distance/proportion_DR_coordinates.csv
2025-11-30 19:37:36,355 - INFO -   Method name:       SD_proportion
2025-11-30 19:37:36,355 - INFO -   Output base dir:   /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample
2025-11-30 19:37:36,355 - INFO -   Run output dir:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/benchmark_results_SD_proportion
2025-11-30 19:37:36,355 - INFO -   Summary CSV:       /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv
2025-11-30 19:37:36,355 - INFO - 
==================================================
2025-11-30 19:37:36,355 - INFO - Running embedding_visualization...
2025-11-30 19:37:36,355 - INFO - ==================================================
2025-11-30 19:37:36,355 - INFO - Running Embedding Visualization...
2025-11-30 19:37:36,355 - INFO - Loading metadata from: /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:36,356 - INFO - Loading embeddings from: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/rna/Sample_distance/correlation/proportion_DR_distance/proportion_DR_coordinates.csv
2025-11-30 19:37:36,358 - INFO - Performing PCA to 2 components...
2025-11-30 19:37:36,359 - INFO - Variance explained by PC1: 67.12%
2025-11-30 19:37:36,359 - INFO - Variance explained by PC2: 14.91%
2025-11-30 19:37:36,846 - INFO - Embedding visualization completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/benchmark_results_SD_proportion/embedding_visualization
2025-11-30 19:37:36,846 - INFO - 
==================================================
2025-11-30 19:37:36,846 - INFO - Running trajectory_anova...
2025-11-30 19:37:36,846 - INFO - ==================================================
2025-11-30 19:37:36,846 - INFO - Running Trajectory ANOVA Analysis...
2025-11-30 19:37:36,931 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:36,933 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:36,934 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:38,437 - INFO - Trajectory ANOVA completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/benchmark_results_SD_proportion/trajectory_anova
2025-11-30 19:37:38,437 - INFO - 
==================================================
2025-11-30 19:37:38,437 - INFO - Running batch_removal...
2025-11-30 19:37:38,437 - INFO - ==================================================
2025-11-30 19:37:38,437 - INFO - Running Batch Removal Evaluation...
Note: dropping 491 metadata rows without data match.
2025-11-30 19:37:38,460 - INFO - Batch removal evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/benchmark_results_SD_proportion/batch_removal
2025-11-30 19:37:38,460 - INFO - 
==================================================
2025-11-30 19:37:38,460 - INFO - Running ari_clustering...
2025-11-30 19:37:38,460 - INFO - ==================================================
2025-11-30 19:37:38,460 - INFO - Running ARI Clustering Evaluation...
Reading metadata and data files...
Found severity levels: [np.int64(1), np.int64(2), np.int64(3), np.int64(4)]
Loaded embedding with shape (50, 5) (samples × dimensions)
Note: dropping 491 metadata rows without data match.
Found 4 unique severity levels: [1 2 3 4]
Using 4 clusters for KNN clustering
Performing KNN clustering with k=20...
Computing ARI and other metrics...
Generating visualizations...
2025-11-30 19:37:39,262 - INFO - ARI clustering evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/benchmark_results_SD_proportion/ari_clustering
2025-11-30 19:37:39,262 - INFO - 
==================================================
2025-11-30 19:37:39,262 - INFO - Running trajectory_analysis...
2025-11-30 19:37:39,262 - INFO - ==================================================
2025-11-30 19:37:39,262 - INFO - Running Trajectory Analysis...
2025-11-30 19:37:40,065 - INFO - Trajectory analysis completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_50_sample/benchmark_results_SD_proportion/trajectory_analysis
2025-11-30 19:37:40,065 - INFO - 
==================================================
2025-11-30 19:37:40,065 - INFO - Running pseudotime_embeddings_custom...
2025-11-30 19:37:40,065 - INFO - ==================================================
2025-11-30 19:37:40,065 - INFO - Running Custom Pseudotime Embeddings Benchmark (simple schema)...
2025-11-30 19:37:40,344 - INFO - [DEBUG] embedding_visualization result keys: ['variance_explained', 'n_samples', 'n_features', 'sev_level_range', 'unique_batches', 'batch_labels', 'output_plot', 'output_pca']
2025-11-30 19:37:40,344 - INFO - [DEBUG] trajectory_anova result keys: ['anova_table', 'model', 'desc_stats', 'posthoc', 'data', 'pseudotime_col', 'n_samples', 'n_batches', 'n_severity_levels', 'model_type']
2025-11-30 19:37:40,345 - INFO - [DEBUG] batch_removal result keys: ['n_samples', 'batches', 'iLISI_mean', 'iLISI_std', 'iLISI_norm_mean', 'ASW_batch_overall', 'per_sample_path', 'summary_path']
2025-11-30 19:37:40,345 - INFO - [DEBUG] ari_clustering result keys: ['metrics', 'interpretation', 'n_samples', 'severity_levels', 'per_sample_path', 'summary_path', 'metrics_json_path']
2025-11-30 19:37:40,345 - INFO - [DEBUG] trajectory_analysis result keys: ['spearman_corr', 'spearman_p', 'n_samples', 'data', 'pseudotime_col']
2025-11-30 19:37:40,345 - INFO - [DEBUG] pseudotime_embeddings_custom result keys: ['paths', 'anova_anchor', 'anova_anchor_scipy', 'nn_gap_summary', 'nn_gap_per_sample']
2025-11-30 19:37:40,345 - INFO - [DEBUG] Collected metrics: {'n_samples': 50, 'batch_partial_eta_sq': 0.01740888508384606, 'severity_partial_eta_sq': -1.9331183354460246e-13, 'interaction_partial_eta_sq': 0.558566123916496, 'iLISI_norm': 0.24673253370734102, 'ASW_batch': 0.7217642083803018, 'ARI': 0.013346855120667769, 'NMI': 0.13237357170084, 'Avg_Purity': np.float64(0.8532608695652174), 'Spearman_Correlation': np.float64(0.3943142512900271), 'Spearman_pval': np.float64(0.004604138157657705), 'Mean_NN_Severity_Gap': 0.9655172413793104, 'Custom_ANOVA_pval': np.float64(0.013133603835864587)}
2025-11-30 19:37:40,350 - INFO - Updated summary CSV at: /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv with column 'SD_proportion-50'
2025-11-30 19:37:40,351 - INFO - Initialized BenchmarkWrapper (explicit paths) with:
2025-11-30 19:37:40,351 - INFO -   Meta CSV:          /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:40,351 - INFO -   Pseudotime CSV:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample/rna/CCA/pseudotime_proportion.csv
2025-11-30 19:37:40,351 - INFO -   Embedding CSV:     /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample/rna/Sample_distance/correlation/proportion_DR_distance/proportion_DR_coordinates.csv
2025-11-30 19:37:40,351 - INFO -   Method name:       SD_proportion
2025-11-30 19:37:40,351 - INFO -   Output base dir:   /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample
2025-11-30 19:37:40,351 - INFO -   Run output dir:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample/benchmark_results_SD_proportion
2025-11-30 19:37:40,351 - INFO -   Summary CSV:       /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv
2025-11-30 19:37:40,351 - INFO - 
==================================================
2025-11-30 19:37:40,351 - INFO - Running embedding_visualization...
2025-11-30 19:37:40,351 - INFO - ==================================================
2025-11-30 19:37:40,351 - INFO - Running Embedding Visualization...
2025-11-30 19:37:40,352 - INFO - Loading metadata from: /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:40,353 - INFO - Loading embeddings from: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample/rna/Sample_distance/correlation/proportion_DR_distance/proportion_DR_coordinates.csv
2025-11-30 19:37:40,355 - INFO - Performing PCA to 2 components...
2025-11-30 19:37:40,356 - INFO - Variance explained by PC1: 71.71%
2025-11-30 19:37:40,356 - INFO - Variance explained by PC2: 18.60%
2025-11-30 19:37:40,848 - INFO - Embedding visualization completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample/benchmark_results_SD_proportion/embedding_visualization
2025-11-30 19:37:40,848 - INFO - 
==================================================
2025-11-30 19:37:40,848 - INFO - Running trajectory_anova...
2025-11-30 19:37:40,848 - INFO - ==================================================
2025-11-30 19:37:40,848 - INFO - Running Trajectory ANOVA Analysis...
2025-11-30 19:37:40,936 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:40,939 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:40,940 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:42,571 - INFO - Trajectory ANOVA completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample/benchmark_results_SD_proportion/trajectory_anova
2025-11-30 19:37:42,571 - INFO - 
==================================================
2025-11-30 19:37:42,571 - INFO - Running batch_removal...
2025-11-30 19:37:42,571 - INFO - ==================================================
2025-11-30 19:37:42,571 - INFO - Running Batch Removal Evaluation...
Note: dropping 441 metadata rows without data match.
2025-11-30 19:37:42,595 - INFO - Batch removal evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample/benchmark_results_SD_proportion/batch_removal
2025-11-30 19:37:42,595 - INFO - 
==================================================
2025-11-30 19:37:42,595 - INFO - Running ari_clustering...
2025-11-30 19:37:42,595 - INFO - ==================================================
2025-11-30 19:37:42,595 - INFO - Running ARI Clustering Evaluation...
Reading metadata and data files...
Found severity levels: [np.int64(1), np.int64(2), np.int64(3), np.int64(4)]
Loaded embedding with shape (100, 5) (samples × dimensions)
Note: dropping 441 metadata rows without data match.
Found 4 unique severity levels: [1 2 3 4]
Using 4 clusters for KNN clustering
Performing KNN clustering with k=20...
Computing ARI and other metrics...
Generating visualizations...
2025-11-30 19:37:43,318 - INFO - ARI clustering evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample/benchmark_results_SD_proportion/ari_clustering
2025-11-30 19:37:43,318 - INFO - 
==================================================
2025-11-30 19:37:43,318 - INFO - Running trajectory_analysis...
2025-11-30 19:37:43,318 - INFO - ==================================================
2025-11-30 19:37:43,318 - INFO - Running Trajectory Analysis...
2025-11-30 19:37:44,129 - INFO - Trajectory analysis completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_100_sample/benchmark_results_SD_proportion/trajectory_analysis
2025-11-30 19:37:44,129 - INFO - 
==================================================
2025-11-30 19:37:44,129 - INFO - Running pseudotime_embeddings_custom...
2025-11-30 19:37:44,129 - INFO - ==================================================
2025-11-30 19:37:44,129 - INFO - Running Custom Pseudotime Embeddings Benchmark (simple schema)...
2025-11-30 19:37:44,484 - INFO - [DEBUG] embedding_visualization result keys: ['variance_explained', 'n_samples', 'n_features', 'sev_level_range', 'unique_batches', 'batch_labels', 'output_plot', 'output_pca']
2025-11-30 19:37:44,484 - INFO - [DEBUG] trajectory_anova result keys: ['anova_table', 'model', 'desc_stats', 'posthoc', 'data', 'pseudotime_col', 'n_samples', 'n_batches', 'n_severity_levels', 'model_type']
2025-11-30 19:37:44,484 - INFO - [DEBUG] batch_removal result keys: ['n_samples', 'batches', 'iLISI_mean', 'iLISI_std', 'iLISI_norm_mean', 'ASW_batch_overall', 'per_sample_path', 'summary_path']
2025-11-30 19:37:44,485 - INFO - [DEBUG] ari_clustering result keys: ['metrics', 'interpretation', 'n_samples', 'severity_levels', 'per_sample_path', 'summary_path', 'metrics_json_path']
2025-11-30 19:37:44,485 - INFO - [DEBUG] trajectory_analysis result keys: ['spearman_corr', 'spearman_p', 'n_samples', 'data', 'pseudotime_col']
2025-11-30 19:37:44,485 - INFO - [DEBUG] pseudotime_embeddings_custom result keys: ['paths', 'anova_anchor', 'anova_anchor_scipy', 'nn_gap_summary', 'nn_gap_per_sample']
2025-11-30 19:37:44,485 - INFO - [DEBUG] Collected metrics: {'n_samples': 100, 'batch_partial_eta_sq': 0.06593805360160729, 'severity_partial_eta_sq': 6.014397210863844e-14, 'interaction_partial_eta_sq': 0.3171505041952705, 'iLISI_norm': 0.22524877324820014, 'ASW_batch': 0.7288170488170256, 'ARI': 0.008707200415389377, 'NMI': 0.05452084141633478, 'Avg_Purity': np.float64(0.5994623655913979), 'Spearman_Correlation': np.float64(0.42554434315032097), 'Spearman_pval': np.float64(1.0164070382803738e-05), 'Mean_NN_Severity_Gap': 0.9193548387096774, 'Custom_ANOVA_pval': np.float64(0.000657559421255384)}
2025-11-30 19:37:44,490 - INFO - Updated summary CSV at: /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv with column 'SD_proportion-100'
2025-11-30 19:37:44,511 - INFO - Initialized BenchmarkWrapper (explicit paths) with:
2025-11-30 19:37:44,511 - INFO -   Meta CSV:          /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:44,511 - INFO -   Pseudotime CSV:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample/rna/CCA/pseudotime_proportion.csv
2025-11-30 19:37:44,511 - INFO -   Embedding CSV:     /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample/rna/Sample_distance/correlation/proportion_DR_distance/proportion_DR_coordinates.csv
2025-11-30 19:37:44,511 - INFO -   Method name:       SD_proportion
2025-11-30 19:37:44,511 - INFO -   Output base dir:   /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample
2025-11-30 19:37:44,511 - INFO -   Run output dir:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample/benchmark_results_SD_proportion
2025-11-30 19:37:44,511 - INFO -   Summary CSV:       /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv
2025-11-30 19:37:44,511 - INFO - 
==================================================
2025-11-30 19:37:44,511 - INFO - Running embedding_visualization...
2025-11-30 19:37:44,511 - INFO - ==================================================
2025-11-30 19:37:44,511 - INFO - Running Embedding Visualization...
2025-11-30 19:37:44,511 - INFO - Loading metadata from: /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:44,512 - INFO - Loading embeddings from: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample/rna/Sample_distance/correlation/proportion_DR_distance/proportion_DR_coordinates.csv
2025-11-30 19:37:44,538 - INFO - Performing PCA to 2 components...
2025-11-30 19:37:44,539 - INFO - Variance explained by PC1: 65.93%
2025-11-30 19:37:44,539 - INFO - Variance explained by PC2: 23.57%
2025-11-30 19:37:45,083 - INFO - Embedding visualization completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample/benchmark_results_SD_proportion/embedding_visualization
2025-11-30 19:37:45,083 - INFO - 
==================================================
2025-11-30 19:37:45,083 - INFO - Running trajectory_anova...
2025-11-30 19:37:45,083 - INFO - ==================================================
2025-11-30 19:37:45,083 - INFO - Running Trajectory ANOVA Analysis...
2025-11-30 19:37:45,544 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:45,547 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:45,548 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:47,178 - INFO - Trajectory ANOVA completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample/benchmark_results_SD_proportion/trajectory_anova
2025-11-30 19:37:47,178 - INFO - 
==================================================
2025-11-30 19:37:47,178 - INFO - Running batch_removal...
2025-11-30 19:37:47,178 - INFO - ==================================================
2025-11-30 19:37:47,178 - INFO - Running Batch Removal Evaluation...
Note: dropping 341 metadata rows without data match.
2025-11-30 19:37:47,203 - INFO - Batch removal evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample/benchmark_results_SD_proportion/batch_removal
2025-11-30 19:37:47,203 - INFO - 
==================================================
2025-11-30 19:37:47,203 - INFO - Running ari_clustering...
2025-11-30 19:37:47,203 - INFO - ==================================================
2025-11-30 19:37:47,203 - INFO - Running ARI Clustering Evaluation...
Reading metadata and data files...
Found severity levels: [np.int64(1), np.int64(2), np.int64(3), np.int64(4)]
Loaded embedding with shape (200, 5) (samples × dimensions)
Note: dropping 341 metadata rows without data match.
Found 4 unique severity levels: [1 2 3 4]
Using 4 clusters for KNN clustering
Performing KNN clustering with k=20...
Computing ARI and other metrics...
Generating visualizations...
2025-11-30 19:37:48,062 - INFO - ARI clustering evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample/benchmark_results_SD_proportion/ari_clustering
2025-11-30 19:37:48,062 - INFO - 
==================================================
2025-11-30 19:37:48,062 - INFO - Running trajectory_analysis...
2025-11-30 19:37:48,062 - INFO - ==================================================
2025-11-30 19:37:48,062 - INFO - Running Trajectory Analysis...
2025-11-30 19:37:48,880 - INFO - Trajectory analysis completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_200_sample/benchmark_results_SD_proportion/trajectory_analysis
2025-11-30 19:37:48,881 - INFO - 
==================================================
2025-11-30 19:37:48,881 - INFO - Running pseudotime_embeddings_custom...
2025-11-30 19:37:48,881 - INFO - ==================================================
2025-11-30 19:37:48,881 - INFO - Running Custom Pseudotime Embeddings Benchmark (simple schema)...
2025-11-30 19:37:49,157 - INFO - [DEBUG] embedding_visualization result keys: ['variance_explained', 'n_samples', 'n_features', 'sev_level_range', 'unique_batches', 'batch_labels', 'output_plot', 'output_pca']
2025-11-30 19:37:49,157 - INFO - [DEBUG] trajectory_anova result keys: ['anova_table', 'model', 'desc_stats', 'posthoc', 'data', 'pseudotime_col', 'n_samples', 'n_batches', 'n_severity_levels', 'model_type']
2025-11-30 19:37:49,158 - INFO - [DEBUG] batch_removal result keys: ['n_samples', 'batches', 'iLISI_mean', 'iLISI_std', 'iLISI_norm_mean', 'ASW_batch_overall', 'per_sample_path', 'summary_path']
2025-11-30 19:37:49,158 - INFO - [DEBUG] ari_clustering result keys: ['metrics', 'interpretation', 'n_samples', 'severity_levels', 'per_sample_path', 'summary_path', 'metrics_json_path']
2025-11-30 19:37:49,158 - INFO - [DEBUG] trajectory_analysis result keys: ['spearman_corr', 'spearman_p', 'n_samples', 'data', 'pseudotime_col']
2025-11-30 19:37:49,158 - INFO - [DEBUG] pseudotime_embeddings_custom result keys: ['paths', 'anova_anchor', 'anova_anchor_scipy', 'nn_gap_summary', 'nn_gap_per_sample']
2025-11-30 19:37:49,158 - INFO - [DEBUG] Collected metrics: {'n_samples': 200, 'batch_partial_eta_sq': 0.35946618591504326, 'severity_partial_eta_sq': -9.613005380487597e-13, 'interaction_partial_eta_sq': 0.5999705724291391, 'iLISI_norm': 0.20391622226787096, 'ASW_batch': 0.6227628075830477, 'ARI': 0.01003109903759166, 'NMI': 0.0350730241848499, 'Avg_Purity': np.float64(0.6801919720767888), 'Spearman_Correlation': np.float64(0.4887668462748759), 'Spearman_pval': np.float64(2.091301636032891e-13), 'Mean_NN_Severity_Gap': 1.1550387596899225, 'Custom_ANOVA_pval': np.float64(1.903064452062996e-14)}
2025-11-30 19:37:49,163 - INFO - Updated summary CSV at: /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv with column 'SD_proportion-200'
2025-11-30 19:37:49,164 - INFO - Initialized BenchmarkWrapper (explicit paths) with:
2025-11-30 19:37:49,164 - INFO -   Meta CSV:          /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:49,164 - INFO -   Pseudotime CSV:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_279_sample/rna/CCA/pseudotime_proportion.csv
2025-11-30 19:37:49,164 - INFO -   Embedding CSV:     /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_279_sample/rna/Sample_distance/correlation/proportion_DR_distance/proportion_DR_coordinates.csv
2025-11-30 19:37:49,164 - INFO -   Method name:       SD_proportion
2025-11-30 19:37:49,164 - INFO -   Output base dir:   /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_279_sample
2025-11-30 19:37:49,164 - INFO -   Run output dir:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_279_sample/benchmark_results_SD_proportion
2025-11-30 19:37:49,164 - INFO -   Summary CSV:       /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv
2025-11-30 19:37:49,164 - INFO - 
==================================================
2025-11-30 19:37:49,164 - INFO - Running embedding_visualization...
2025-11-30 19:37:49,164 - INFO - ==================================================
2025-11-30 19:37:49,164 - INFO - Running Embedding Visualization...
2025-11-30 19:37:49,165 - INFO - Loading metadata from: /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:49,166 - INFO - Loading embeddings from: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_279_sample/rna/Sample_distance/correlation/proportion_DR_distance/proportion_DR_coordinates.csv
2025-11-30 19:37:49,188 - INFO - Performing PCA to 2 components...
2025-11-30 19:37:49,189 - INFO - Variance explained by PC1: 66.44%
2025-11-30 19:37:49,190 - INFO - Variance explained by PC2: 26.92%
2025-11-30 19:37:49,722 - INFO - Embedding visualization completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_279_sample/benchmark_results_SD_proportion/embedding_visualization
2025-11-30 19:37:49,722 - INFO - 
==================================================
2025-11-30 19:37:49,722 - INFO - Running trajectory_anova...
2025-11-30 19:37:49,722 - INFO - ==================================================
2025-11-30 19:37:49,722 - INFO - Running Trajectory ANOVA Analysis...
2025-11-30 19:37:49,969 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:49,972 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:49,973 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:51,252 - INFO - Trajectory ANOVA completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_279_sample/benchmark_results_SD_proportion/trajectory_anova
2025-11-30 19:37:51,252 - INFO - 
==================================================
2025-11-30 19:37:51,252 - INFO - Running batch_removal...
2025-11-30 19:37:51,252 - INFO - ==================================================
2025-11-30 19:37:51,252 - INFO - Running Batch Removal Evaluation...
Note: dropping 292 metadata rows without data match.
2025-11-30 19:37:51,274 - ERROR - Error in batch removal evaluation: Number of labels is 1. Valid values are 2 to n_samples - 1 (inclusive)
2025-11-30 19:37:51,274 - INFO - 
==================================================
2025-11-30 19:37:51,274 - INFO - Running ari_clustering...
2025-11-30 19:37:51,274 - INFO - ==================================================
2025-11-30 19:37:51,274 - INFO - Running ARI Clustering Evaluation...
Reading metadata and data files...
Found severity levels: [np.int64(1), np.int64(2), np.int64(3), np.int64(4)]
Loaded embedding with shape (249, 5) (samples × dimensions)
Note: dropping 292 metadata rows without data match.
Found 4 unique severity levels: [1 2 3 4]
Using 4 clusters for KNN clustering
Performing KNN clustering with k=20...
Computing ARI and other metrics...
Generating visualizations...
2025-11-30 19:37:52,059 - INFO - ARI clustering evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_279_sample/benchmark_results_SD_proportion/ari_clustering
2025-11-30 19:37:52,059 - INFO - 
==================================================
2025-11-30 19:37:52,059 - INFO - Running trajectory_analysis...
2025-11-30 19:37:52,059 - INFO - ==================================================
2025-11-30 19:37:52,059 - INFO - Running Trajectory Analysis...
2025-11-30 19:37:52,877 - INFO - Trajectory analysis completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_279_sample/benchmark_results_SD_proportion/trajectory_analysis
2025-11-30 19:37:52,877 - INFO - 
==================================================
2025-11-30 19:37:52,877 - INFO - Running pseudotime_embeddings_custom...
2025-11-30 19:37:52,877 - INFO - ==================================================
2025-11-30 19:37:52,877 - INFO - Running Custom Pseudotime Embeddings Benchmark (simple schema)...
2025-11-30 19:37:53,021 - INFO - [DEBUG] embedding_visualization result keys: ['variance_explained', 'n_samples', 'n_features', 'sev_level_range', 'unique_batches', 'batch_labels', 'output_plot', 'output_pca']
2025-11-30 19:37:53,022 - INFO - [DEBUG] trajectory_anova result keys: ['anova_table', 'model', 'desc_stats', 'posthoc', 'data', 'pseudotime_col', 'n_samples', 'n_batches', 'n_severity_levels', 'model_type']
2025-11-30 19:37:53,022 - WARNING - Skipping batch_removal in summary - status was not 'success'
2025-11-30 19:37:53,022 - INFO - [DEBUG] ari_clustering result keys: ['metrics', 'interpretation', 'n_samples', 'severity_levels', 'per_sample_path', 'summary_path', 'metrics_json_path']
2025-11-30 19:37:53,022 - INFO - [DEBUG] trajectory_analysis result keys: ['spearman_corr', 'spearman_p', 'n_samples', 'data', 'pseudotime_col']
2025-11-30 19:37:53,022 - INFO - [DEBUG] pseudotime_embeddings_custom result keys: ['paths', 'anova_anchor', 'anova_anchor_scipy', 'nn_gap_summary', 'nn_gap_per_sample']
2025-11-30 19:37:53,022 - INFO - [DEBUG] Collected metrics: {'n_samples': 249, 'severity_partial_eta_sq': 0.33267992139024577, 'ARI': 0.023515789033126625, 'NMI': 0.08309209488422498, 'Avg_Purity': np.float64(0.8319915254237288), 'Spearman_Correlation': np.float64(0.5632855042985769), 'Spearman_pval': np.float64(3.0121901368253696e-22), 'Custom_ANOVA_pval': np.float64(2.2043774353408165e-21)}
2025-11-30 19:37:53,026 - INFO - Updated summary CSV at: /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv with column 'SD_proportion-249'
2025-11-30 19:37:53,042 - INFO - Initialized BenchmarkWrapper (explicit paths) with:
2025-11-30 19:37:53,042 - INFO -   Meta CSV:          /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:53,042 - INFO -   Pseudotime CSV:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/CCA/pseudotime_proportion.csv
2025-11-30 19:37:53,042 - INFO -   Embedding CSV:     /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/Sample_distance/correlation/proportion_DR_distance/proportion_DR_coordinates.csv
2025-11-30 19:37:53,042 - INFO -   Method name:       SD_proportion
2025-11-30 19:37:53,042 - INFO -   Output base dir:   /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample
2025-11-30 19:37:53,042 - INFO -   Run output dir:    /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/benchmark_results_SD_proportion
2025-11-30 19:37:53,042 - INFO -   Summary CSV:       /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv
2025-11-30 19:37:53,042 - INFO - 
==================================================
2025-11-30 19:37:53,042 - INFO - Running embedding_visualization...
2025-11-30 19:37:53,042 - INFO - ==================================================
2025-11-30 19:37:53,042 - INFO - Running Embedding Visualization...
2025-11-30 19:37:53,043 - INFO - Loading metadata from: /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 19:37:53,044 - INFO - Loading embeddings from: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/rna/Sample_distance/correlation/proportion_DR_distance/proportion_DR_coordinates.csv
2025-11-30 19:37:53,066 - INFO - Performing PCA to 2 components...
2025-11-30 19:37:53,067 - INFO - Variance explained by PC1: 57.96%
2025-11-30 19:37:53,068 - INFO - Variance explained by PC2: 24.00%
2025-11-30 19:37:53,667 - INFO - Embedding visualization completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/benchmark_results_SD_proportion/embedding_visualization
2025-11-30 19:37:53,667 - INFO - 
==================================================
2025-11-30 19:37:53,667 - INFO - Running trajectory_anova...
2025-11-30 19:37:53,667 - INFO - ==================================================
2025-11-30 19:37:53,668 - INFO - Running Trajectory ANOVA Analysis...
2025-11-30 19:37:54,419 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:54,422 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:54,422 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 19:37:56,106 - INFO - Trajectory ANOVA completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/benchmark_results_SD_proportion/trajectory_anova
2025-11-30 19:37:56,106 - INFO - 
==================================================
2025-11-30 19:37:56,106 - INFO - Running batch_removal...
2025-11-30 19:37:56,106 - INFO - ==================================================
2025-11-30 19:37:56,106 - INFO - Running Batch Removal Evaluation...
Note: dropping 136 metadata rows without data match.
2025-11-30 19:37:56,137 - INFO - Batch removal evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/benchmark_results_SD_proportion/batch_removal
2025-11-30 19:37:56,137 - INFO - 
==================================================
2025-11-30 19:37:56,137 - INFO - Running ari_clustering...
2025-11-30 19:37:56,137 - INFO - ==================================================
2025-11-30 19:37:56,137 - INFO - Running ARI Clustering Evaluation...
Reading metadata and data files...
Found severity levels: [np.int64(1), np.int64(2), np.int64(3), np.int64(4)]
Loaded embedding with shape (405, 5) (samples × dimensions)
Note: dropping 136 metadata rows without data match.
Found 4 unique severity levels: [1 2 3 4]
Using 4 clusters for KNN clustering
Performing KNN clustering with k=20...
Computing ARI and other metrics...
Generating visualizations...
2025-11-30 19:37:56,971 - INFO - ARI clustering evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/benchmark_results_SD_proportion/ari_clustering
2025-11-30 19:37:56,971 - INFO - 
==================================================
2025-11-30 19:37:56,971 - INFO - Running trajectory_analysis...
2025-11-30 19:37:56,971 - INFO - ==================================================
2025-11-30 19:37:56,971 - INFO - Running Trajectory Analysis...
2025-11-30 19:37:57,865 - INFO - Trajectory analysis completed. Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_400_sample/benchmark_results_SD_proportion/trajectory_analysis
2025-11-30 19:37:57,865 - INFO - 
==================================================
2025-11-30 19:37:57,865 - INFO - Running pseudotime_embeddings_custom...
2025-11-30 19:37:57,865 - INFO - ==================================================
2025-11-30 19:37:57,865 - INFO - Running Custom Pseudotime Embeddings Benchmark (simple schema)...
2025-11-30 19:37:58,152 - INFO - [DEBUG] embedding_visualization result keys: ['variance_explained', 'n_samples', 'n_features', 'sev_level_range', 'unique_batches', 'batch_labels', 'output_plot', 'output_pca']
2025-11-30 19:37:58,152 - INFO - [DEBUG] trajectory_anova result keys: ['anova_table', 'model', 'desc_stats', 'posthoc', 'data', 'pseudotime_col', 'n_samples', 'n_batches', 'n_severity_levels', 'model_type']
2025-11-30 19:37:58,152 - INFO - [DEBUG] batch_removal result keys: ['n_samples', 'batches', 'iLISI_mean', 'iLISI_std', 'iLISI_norm_mean', 'ASW_batch_overall', 'per_sample_path', 'summary_path']
2025-11-30 19:37:58,152 - INFO - [DEBUG] ari_clustering result keys: ['metrics', 'interpretation', 'n_samples', 'severity_levels', 'per_sample_path', 'summary_path', 'metrics_json_path']
2025-11-30 19:37:58,152 - INFO - [DEBUG] trajectory_analysis result keys: ['spearman_corr', 'spearman_p', 'n_samples', 'data', 'pseudotime_col']
2025-11-30 19:37:58,152 - INFO - [DEBUG] pseudotime_embeddings_custom result keys: ['paths', 'anova_anchor', 'anova_anchor_scipy', 'nn_gap_summary', 'nn_gap_per_sample']
2025-11-30 19:37:58,153 - INFO - [DEBUG] Collected metrics: {'n_samples': 405, 'batch_partial_eta_sq': 0.1618702748346198, 'severity_partial_eta_sq': 0.03899491360943528, 'interaction_partial_eta_sq': 0.19176500332134064, 'iLISI_norm': 0.18321966458768713, 'ASW_batch': 0.6062958644517839, 'ARI': 0.001112199053254593, 'NMI': 0.019615808149086294, 'Avg_Purity': np.float64(0.8453865336658354), 'Spearman_Correlation': np.float64(-0.47544737826582595), 'Spearman_pval': np.float64(3.118494174709249e-24), 'Mean_NN_Severity_Gap': 0.9919678714859438, 'Custom_ANOVA_pval': np.float64(2.8358971553788233e-23)}
2025-11-30 19:37:58,157 - INFO - Updated summary CSV at: /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv with column 'SD_proportion-405'
