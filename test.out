Resuming process from previous progress:
{
    "rna": {
        "preprocessing": true,
        "cell_type_cluster": true,
        "dimensionality_reduction": true,
        "sample_distance_calculation": false,
        "trajectory_analysis": true,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "atac": {
        "preprocessing": false,
        "cell_type_cluster": false,
        "dimensionality_reduction": false,
        "sample_distance_calculation": false,
        "trajectory_analysis": false,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "multiomics": {
        "glue_integration": false,
        "glue_preprocessing": false,
        "glue_training": false,
        "glue_gene_activity": false,
        "glue_cell_types": false,
        "glue_visualization": false,
        "integration_preprocessing": false,
        "dimensionality_reduction": false,
        "embedding_visualization": false,
        "optimal_resolution": false
    },
    "system_info": {
        "platform": "Linux",
        "python_version": "3.10.18 | packaged by conda-forge | (main, Jun  4 2025, 14:45:41) [GCC 13.3.0]",
        "use_gpu": false,
        "linux_system": false
    }
}

============================================================
RUNNING RNA PIPELINE
============================================================
Starting RNA wrapper function with provided parameters...
Starting preprocessing...
=== Reading input dataset ===
Raw shape: 46712 cells × 14881 genes
All required columns are present in adata.obs.
Type of adata.X: <class 'scipy.sparse._csc.csc_matrix'>
adata.X dtype: float64
adata.X is sparse: True
Converting adata.X from float64 to float32
After initial filtering: 46570 cells × 9943 genes
After mitochondrial filtering: 46516 cells × 9943 genes
After gene exclusion filtering: 46516 cells × 9930 genes
After sample filtering: 46516 cells × 9930 genes
Number of samples remaining: 25
After final gene filtering: 46516 cells × 9930 genes
Processed shape: 46516 cells × 9930 genes
Preprocessing complete!
=== [CPU] Processing data for clustering ===
=== [CPU] Running Harmony integration ===
Variables to regress: sample
	Initialization is completed.
	Completed 1 / 30 iteration(s).
	Completed 2 / 30 iteration(s).
	Completed 3 / 30 iteration(s).
	Completed 4 / 30 iteration(s).
	Completed 5 / 30 iteration(s).
	Completed 6 / 30 iteration(s).
	Completed 7 / 30 iteration(s).
	Completed 8 / 30 iteration(s).
	Completed 9 / 30 iteration(s).
Reach convergence after 9 iteration(s).
End of harmony for adata_cluster.
=== [CPU] Processing data for sample differences ===
Total runtime: 130.12 seconds
Starting cell type clustering at resolution: 0.7
[cell_types] No cell type annotation found. Performing clustering.
[cell_types] Building neighborhood graph...
[cell_types] No target clusters specified. Using standard Leiden clustering (resolution=0.7)...
[cell_types] Found 12 clusters after Leiden clustering.
[cell_types] Finished assigning cell types.
[cell_types] Computing UMAP...
[cell_types] Generating UMAP visualizations...
[generate_umap_visualizations] Generating UMAP plots...
[generate_umap_visualizations] → Plotting UMAP colored by 'cell_type' (12 categories)
[generate_umap_visualizations] ✓ Saved: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/preprocess/umap_cell_type.png
[cell_types] Saved AnnData object to /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/preprocess/adata_cell.h5ad
[cell_types] Total runtime: 30.54 seconds
[cell_types] Saved AnnData object to /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/preprocess/adata_sample.h5ad
Starting dimensionality reduction...
Processing 12 cell types across 25 samples
Creating layer for 1
Creating layer for 10
Creating layer for 11
Creating layer for 12
Creating layer for 2
Creating layer for 3
Creating layer for 4
Creating layer for 5
Creating layer for 6
Creating layer for 7
Creating layer for 8
Creating layer for 9

Processing cell type: 1
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 10
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 11
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 12
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 2
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 3
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 4
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 5
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 6
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 7
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 8
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Processing cell type: 9
  Selecting top 2000 HVGs
  Selected 2000 HVGs

Concatenating all cell type HVGs into single AnnData
Applying final HVG selection on 24000 concatenated genes
Final HVG selection: 2000 genes

Creating final HVG expression matrix

Total runtime: 21.12 seconds
Final HVG matrix shape: (12, 25)
Final AnnData shape: (25, 2000)
[process_anndata_with_dimension_reduction] Starting dimension reduction computation...
[process_anndata_with_dimension_reduction] Results will be stored under unified keys:
  - X_DR_expression: for expression data
  - X_DR_proportion: for proportion data
[process_anndata_with_dimension_reduction] RNA mode: Will use PCA for expression data
[process_anndata_with_dimension_reduction] ✓ Created output directories:
  - count_output_dir: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/preprocess
  - pseudobulk_output_dir: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/pseudobulk
[process_anndata_with_dimension_reduction] Using n_expression_components=10, n_proportion_components=5
[process_anndata_with_dimension_reduction] Data dimensions: expression=(25, 2000), proportion=(25, 12)
[DimRed] Computing PCA for RNA data with 10 components on (25, 2000) data
[PCA] Success. Shape: (25, 10)
[Storage] Stored X_DR_expression in both adata and pseudobulk_anndata (shape: (25, 10))
[Storage] Stored X_pca_expression_method in both adata and pseudobulk_anndata (shape: (25, 10))
[PCA] Stored variance information in both objects
[DimRed] Completed - results stored as X_DR_expression in both adata and pseudobulk_anndata
[process_anndata_with_dimension_reduction] ✓ Expression dimension reduction completed successfully
[run_dimension_reduction_proportion] Computing PCA with 5 components...
[run_dimension_reduction_proportion] Harmony failed: No module named 'harmonypy'. Using PCA only.
[run_dimension_reduction_proportion] Completed using PCA. Shape: (25, 5)
[process_anndata_with_dimension_reduction] ✓ Proportion dimension reduction completed successfully
[process_anndata_with_dimension_reduction] Preparing to save results...
[process_anndata_with_dimension_reduction] Target file paths:
  - adata: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/preprocess/adata_sample.h5ad
  - pseudobulk_anndata: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/pseudobulk/pseudobulk_sample.h5ad
[Save] Saving adata to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/preprocess/adata_sample.h5ad
[Save] ✓ Successfully saved adata (207.0 MB)
[Save] Saving pseudobulk_anndata to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/pseudobulk/pseudobulk_sample.h5ad
[Save] ✓ Successfully saved pseudobulk_anndata (0.4 MB)
[process_anndata_with_dimension_reduction] ✓ All files saved successfully

[process_anndata_with_dimension_reduction] === SUMMARY ===
Total runtime: 14.36 seconds
Expression dimension reduction: ✓ SUCCESS
Proportion dimension reduction: ✓ SUCCESS
Results available under unified keys:
  - X_DR_expression in both adata.uns and pseudobulk_anndata.uns
  - X_DR_proportion in both adata.uns and pseudobulk_anndata.uns
File saving: ✓ ATTEMPTED
Starting trajectory analysis...

Processing X_DR_proportion...
Warning: Only 5 components available, using all of them.
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3379
PC1 + PC3: CCA score = 0.3657
PC1 + PC4: CCA score = 0.3237
PC1 + PC5: CCA score = 0.2980
PC2 + PC3: CCA score = 0.2687
PC2 + PC4: CCA score = 0.2079
PC2 + PC5: CCA score = 0.1650
PC3 + PC4: CCA score = 0.2506
PC3 + PC5: CCA score = 0.2164
PC4 + PC5: CCA score = 0.1336
Best combination: PC1 + PC3 with score 0.3657
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/CCA/pca_10d_cca_proportion.pdf

Processing X_DR_expression...
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2240
PC1 + PC3: CCA score = 0.3079
PC1 + PC4: CCA score = 0.4132
PC1 + PC5: CCA score = 0.0655
PC1 + PC6: CCA score = 0.3034
PC1 + PC7: CCA score = 0.0483
PC1 + PC8: CCA score = 0.0555
PC1 + PC9: CCA score = 0.1701
PC1 + PC10: CCA score = 0.0773
PC2 + PC3: CCA score = 0.3804
PC2 + PC4: CCA score = 0.4697
PC2 + PC5: CCA score = 0.2329
PC2 + PC6: CCA score = 0.3768
PC2 + PC7: CCA score = 0.2286
PC2 + PC8: CCA score = 0.2302
PC2 + PC9: CCA score = 0.2809
PC2 + PC10: CCA score = 0.2364
PC3 + PC4: CCA score = 0.5150
PC3 + PC5: CCA score = 0.3144
PC3 + PC6: CCA score = 0.4320
PC3 + PC7: CCA score = 0.3113
PC3 + PC8: CCA score = 0.3125
PC3 + PC9: CCA score = 0.3514
PC3 + PC10: CCA score = 0.3170
PC4 + PC5: CCA score = 0.4180
PC4 + PC6: CCA score = 0.5123
PC4 + PC7: CCA score = 0.4157
PC4 + PC8: CCA score = 0.4166
PC4 + PC9: CCA score = 0.4466
PC4 + PC10: CCA score = 0.4200
PC5 + PC6: CCA score = 0.3100
PC5 + PC7: CCA score = 0.0800
PC5 + PC8: CCA score = 0.0845
PC5 + PC9: CCA score = 0.1817
PC5 + PC10: CCA score = 0.1002
PC6 + PC7: CCA score = 0.3068
PC6 + PC8: CCA score = 0.3080
PC6 + PC9: CCA score = 0.3475
PC6 + PC10: CCA score = 0.3127
PC7 + PC8: CCA score = 0.0720
PC7 + PC9: CCA score = 0.1762
PC7 + PC10: CCA score = 0.0898
PC8 + PC9: CCA score = 0.1783
PC8 + PC10: CCA score = 0.0939
PC9 + PC10: CCA score = 0.1862
Best combination: PC3 + PC4 with score 0.5150
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/CCA/pca_10d_cca_expression.pdf
Saved proportion pseudotime data to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/CCA/pseudotime_proportion.csv
Saved expression pseudotime data to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/CCA/pseudotime_expression.csv

==================================================
CCA ANALYSIS SUMMARY
==================================================
X_DR_proportion: CCA score = 0.3657 (using PC1 + PC3)
X_DR_expression: CCA score = 0.5150 (using PC3 + PC4)

Total runtime: 0.90 seconds
==================================================
P-value for observed correlation 0.3656925622530156: 0.21
[CCA p-test] Runtime: 0.69 seconds
P-value for observed correlation 0.5150206943277725: 0.014
[CCA p-test] Runtime: 0.68 seconds
Directory setup: 0.01 seconds
Starting RNA-seq resolution optimization for X_DR_proportion...
Using representation: X_pca with 20 components
Using 10 PCs for CCA analysis
Testing resolutions from 0.01 to 1.00...
Will compute corrected p-values with 1000 simulations per resolution

=== FIRST PASS: Coarse Search ===


Testing resolution: 0.100

  Cell clustering: 24.40 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 5
  Pseudobulk computation: 9.76 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.100: CCA Score = 0.4878 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3283
PC1 + PC3: CCA score = 0.2769
PC1 + PC4: CCA score = 0.2681
PC1 + PC5: CCA score = 0.4340
PC2 + PC3: CCA score = 0.2159
PC2 + PC4: CCA score = 0.2045
PC2 + PC5: CCA score = 0.3979
PC3 + PC4: CCA score = 0.1036
PC3 + PC5: CCA score = 0.3566
PC4 + PC5: CCA score = 0.3499
Best combination: PC1 + PC5 with score 0.4340
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.100/cca_plot_res_0.100.png
Created CCA visualization plot using PC1 + PC5 (viz score: 0.4340)
  Null distribution (1000 sims): 0.91 seconds
Resolution 0.100: Standard p-value = 0.3480
TOTAL for resolution 0.100: 35.47 seconds


Testing resolution: 0.200

  Cell clustering: 23.69 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 6
  Pseudobulk computation: 10.31 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.200: CCA Score = 0.5395 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3267
PC1 + PC3: CCA score = 0.2646
PC1 + PC4: CCA score = 0.2550
PC1 + PC5: CCA score = 0.4942
PC2 + PC3: CCA score = 0.2162
PC2 + PC4: CCA score = 0.2043
PC2 + PC5: CCA score = 0.4701
PC3 + PC4: CCA score = 0.0711
PC3 + PC5: CCA score = 0.4293
PC4 + PC5: CCA score = 0.4234
Best combination: PC1 + PC5 with score 0.4942
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.200/cca_plot_res_0.200.png
Created CCA visualization plot using PC1 + PC5 (viz score: 0.4942)
  Null distribution (1000 sims): 0.90 seconds
Resolution 0.200: Standard p-value = 0.1950
TOTAL for resolution 0.200: 35.31 seconds


Testing resolution: 0.300

  Cell clustering: 27.37 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 9
  Pseudobulk computation: 15.98 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.300: CCA Score = 0.4207 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3377
PC1 + PC3: CCA score = 0.3231
PC1 + PC4: CCA score = 0.2842
PC1 + PC5: CCA score = 0.2840
PC2 + PC3: CCA score = 0.2885
PC2 + PC4: CCA score = 0.2441
PC2 + PC5: CCA score = 0.2439
PC3 + PC4: CCA score = 0.2235
PC3 + PC5: CCA score = 0.2232
PC4 + PC5: CCA score = 0.1618
Best combination: PC1 + PC2 with score 0.3377
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.300/cca_plot_res_0.300.png
Created CCA visualization plot using PC1 + PC2 (viz score: 0.3377)
  Null distribution (1000 sims): 0.89 seconds
Resolution 0.300: Standard p-value = 0.5390
TOTAL for resolution 0.300: 44.59 seconds


Testing resolution: 0.400

  Cell clustering: 23.71 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 8
  Pseudobulk computation: 15.29 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.400: CCA Score = 0.4227 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3383
PC1 + PC3: CCA score = 0.3700
PC1 + PC4: CCA score = 0.3106
PC1 + PC5: CCA score = 0.2911
PC2 + PC3: CCA score = 0.2865
PC2 + PC4: CCA score = 0.2041
PC2 + PC5: CCA score = 0.1730
PC3 + PC4: CCA score = 0.2532
PC3 + PC5: CCA score = 0.2288
PC4 + PC5: CCA score = 0.1093
Best combination: PC1 + PC3 with score 0.3700
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.400/cca_plot_res_0.400.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3700)
  Null distribution (1000 sims): 0.91 seconds
Resolution 0.400: Standard p-value = 0.5460
TOTAL for resolution 0.400: 40.29 seconds


Testing resolution: 0.500

  Cell clustering: 23.63 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 8
  Pseudobulk computation: 15.30 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.500: CCA Score = 0.4099 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3380
PC1 + PC3: CCA score = 0.3465
PC1 + PC4: CCA score = 0.3183
PC1 + PC5: CCA score = 0.2947
PC2 + PC3: CCA score = 0.2542
PC2 + PC4: CCA score = 0.2142
PC2 + PC5: CCA score = 0.1773
PC3 + PC4: CCA score = 0.2275
PC3 + PC5: CCA score = 0.1931
PC4 + PC5: CCA score = 0.1362
Best combination: PC1 + PC3 with score 0.3465
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.500/cca_plot_res_0.500.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3465)
  Null distribution (1000 sims): 0.90 seconds
Resolution 0.500: Standard p-value = 0.5970
TOTAL for resolution 0.500: 40.20 seconds


Testing resolution: 0.600

  Cell clustering: 27.41 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 9
  Pseudobulk computation: 16.47 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.600: CCA Score = 0.4254 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3494
PC1 + PC3: CCA score = 0.3659
PC1 + PC4: CCA score = 0.3273
PC1 + PC5: CCA score = 0.3020
PC2 + PC3: CCA score = 0.2716
PC2 + PC4: CCA score = 0.2169
PC2 + PC5: CCA score = 0.1763
PC3 + PC4: CCA score = 0.2425
PC3 + PC5: CCA score = 0.2071
PC4 + PC5: CCA score = 0.1271
Best combination: PC1 + PC3 with score 0.3659
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.600/cca_plot_res_0.600.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3659)
  Null distribution (1000 sims): 0.88 seconds
Resolution 0.600: Standard p-value = 0.5300
TOTAL for resolution 0.600: 45.12 seconds


Testing resolution: 0.700

  Cell clustering: 23.51 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 12
  Pseudobulk computation: 19.61 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.700: CCA Score = 0.4218 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3379
PC1 + PC3: CCA score = 0.3657
PC1 + PC4: CCA score = 0.3237
PC1 + PC5: CCA score = 0.2980
PC2 + PC3: CCA score = 0.2687
PC2 + PC4: CCA score = 0.2079
PC2 + PC5: CCA score = 0.1650
PC3 + PC4: CCA score = 0.2506
PC3 + PC5: CCA score = 0.2164
PC4 + PC5: CCA score = 0.1336
Best combination: PC1 + PC3 with score 0.3657
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.700/cca_plot_res_0.700.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3657)
  Null distribution (1000 sims): 0.89 seconds
Resolution 0.700: Standard p-value = 0.5390
TOTAL for resolution 0.700: 44.40 seconds


Testing resolution: 0.800

  Cell clustering: 23.46 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 14
  Pseudobulk computation: 21.80 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.800: CCA Score = 0.4216 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3157
PC1 + PC3: CCA score = 0.3477
PC1 + PC4: CCA score = 0.2900
PC1 + PC5: CCA score = 0.2595
PC2 + PC3: CCA score = 0.3017
PC2 + PC4: CCA score = 0.2329
PC2 + PC5: CCA score = 0.1936
PC3 + PC4: CCA score = 0.2747
PC3 + PC5: CCA score = 0.2424
PC4 + PC5: CCA score = 0.1480
Best combination: PC1 + PC3 with score 0.3477
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.800/cca_plot_res_0.800.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3477)
  Null distribution (1000 sims): 0.89 seconds
Resolution 0.800: Standard p-value = 0.5330
TOTAL for resolution 0.800: 46.52 seconds


Testing resolution: 0.900

  Cell clustering: 23.45 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 15
  Pseudobulk computation: 22.89 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.900: CCA Score = 0.4316 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3142
PC1 + PC3: CCA score = 0.3567
PC1 + PC4: CCA score = 0.2753
PC1 + PC5: CCA score = 0.2720
PC2 + PC3: CCA score = 0.3157
PC2 + PC4: CCA score = 0.2195
PC2 + PC5: CCA score = 0.2153
PC3 + PC4: CCA score = 0.2770
PC3 + PC5: CCA score = 0.2736
PC4 + PC5: CCA score = 0.1530
Best combination: PC1 + PC3 with score 0.3567
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.900/cca_plot_res_0.900.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3567)
  Null distribution (1000 sims): 0.90 seconds
Resolution 0.900: Standard p-value = 0.5120
TOTAL for resolution 0.900: 47.63 seconds


Testing resolution: 1.000

  Cell clustering: 23.49 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 14
  Pseudobulk computation: 21.88 seconds
  Dimension reduction: 0.01 seconds
Resolution 1.000: CCA Score = 0.4179 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3131
PC1 + PC3: CCA score = 0.3489
PC1 + PC4: CCA score = 0.2781
PC1 + PC5: CCA score = 0.2617
PC2 + PC3: CCA score = 0.3041
PC2 + PC4: CCA score = 0.2193
PC2 + PC5: CCA score = 0.1980
PC3 + PC4: CCA score = 0.2679
PC3 + PC5: CCA score = 0.2508
PC4 + PC5: CCA score = 0.1361
Best combination: PC1 + PC3 with score 0.3489
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_1.000/cca_plot_res_1.000.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3489)
  Null distribution (1000 sims): 0.90 seconds
Resolution 1.000: Standard p-value = 0.5770
TOTAL for resolution 1.000: 46.64 seconds

COARSE SEARCH TOTAL: 426.20 seconds

Best resolution from first pass: 0.20
Best CCA score: 0.5395

=== SECOND PASS: Fine-tuned Search ===
Fine-tuning search from 0.18 to 0.22...


Testing resolution: 0.180

  Cell clustering: 23.64 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 6
  Pseudobulk computation: 9.96 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.180: CCA Score = 0.5401 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3259
PC1 + PC3: CCA score = 0.2646
PC1 + PC4: CCA score = 0.2550
PC1 + PC5: CCA score = 0.4954
PC2 + PC3: CCA score = 0.2150
PC2 + PC4: CCA score = 0.2030
PC2 + PC5: CCA score = 0.4708
PC3 + PC4: CCA score = 0.0708
PC3 + PC5: CCA score = 0.4306
PC4 + PC5: CCA score = 0.4248
Best combination: PC1 + PC5 with score 0.4954
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.180/cca_plot_res_0.180.png
Created CCA visualization plot using PC1 + PC5 (viz score: 0.4954)
  Null distribution (1000 sims): 0.90 seconds
Resolution 0.180: Standard p-value = 0.2090
TOTAL for resolution 0.180: 34.90 seconds


Testing resolution: 0.190

  Cell clustering: 24.02 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 6
  Pseudobulk computation: 9.79 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.190: CCA Score = 0.5378 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3274
PC1 + PC3: CCA score = 0.2651
PC1 + PC4: CCA score = 0.2554
PC1 + PC5: CCA score = 0.4920
PC2 + PC3: CCA score = 0.2170
PC2 + PC4: CCA score = 0.2051
PC2 + PC5: CCA score = 0.4678
PC3 + PC4: CCA score = 0.0715
PC3 + PC5: CCA score = 0.4265
PC4 + PC5: CCA score = 0.4206
Best combination: PC1 + PC5 with score 0.4920
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.190/cca_plot_res_0.190.png
Created CCA visualization plot using PC1 + PC5 (viz score: 0.4920)
  Null distribution (1000 sims): 0.89 seconds
Resolution 0.190: Standard p-value = 0.2400
TOTAL for resolution 0.190: 35.03 seconds


Testing resolution: 0.210

  Cell clustering: 23.32 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 6
  Pseudobulk computation: 9.76 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.210: CCA Score = 0.5323 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3238
PC1 + PC3: CCA score = 0.2564
PC1 + PC4: CCA score = 0.2696
PC1 + PC5: CCA score = 0.4779
PC2 + PC3: CCA score = 0.2123
PC2 + PC4: CCA score = 0.2280
PC2 + PC5: CCA score = 0.4558
PC3 + PC4: CCA score = 0.1136
PC3 + PC5: CCA score = 0.4106
PC4 + PC5: CCA score = 0.4190
Best combination: PC1 + PC5 with score 0.4779
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.210/cca_plot_res_0.210.png
Created CCA visualization plot using PC1 + PC5 (viz score: 0.4779)
  Null distribution (1000 sims): 0.90 seconds
Resolution 0.210: Standard p-value = 0.2390
TOTAL for resolution 0.210: 34.33 seconds


Testing resolution: 0.220

  Cell clustering: 23.84 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 6
  Pseudobulk computation: 9.86 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.220: CCA Score = 0.5379 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3249
PC1 + PC3: CCA score = 0.2556
PC1 + PC4: CCA score = 0.2629
PC1 + PC5: CCA score = 0.4872
PC2 + PC3: CCA score = 0.2134
PC2 + PC4: CCA score = 0.2222
PC2 + PC5: CCA score = 0.4664
PC3 + PC4: CCA score = 0.0955
PC3 + PC5: CCA score = 0.4211
PC4 + PC5: CCA score = 0.4256
Best combination: PC1 + PC5 with score 0.4872
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.220/cca_plot_res_0.220.png
Created CCA visualization plot using PC1 + PC5 (viz score: 0.4872)
  Null distribution (1000 sims): 0.91 seconds
Resolution 0.220: Standard p-value = 0.2250
TOTAL for resolution 0.220: 34.96 seconds

FINE SEARCH TOTAL: 139.22 seconds

=== GENERATING CORRECTED NULL DISTRIBUTION ===
Accounting for resolution selection bias...
  Corrected null distribution generation: 0.00 seconds
Corrected null distribution saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/corrected_null/corrected_null_distribution_proportion.npy

=== COMPUTING CORRECTED P-VALUES ===
  Corrected p-values computation: 3.43 seconds
Corrected null distribution plot saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/corrected_null/corrected_null_distribution.png
CORRECTED P-VALUES TOTAL: 3.70 seconds

=== FINAL RESULTS ===
Best resolution: 0.180
Best CCA score: 0.5401
Number of clusters at best resolution: 6
Number of PCs used: 5
Best visualization used PC1 + PC5
Standard p-value: 0.2090
Corrected p-value: 0.9750
Summary plot saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/summary/resolution_optimization_summary_X_DR_proportion.png
Summary report saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/summary/optimization_results_X_DR_proportion.txt
Detailed results saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/summary/detailed_results_X_DR_proportion.csv

All results saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/all_resolution_results_proportion.csv

Final summary saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/FINAL_SUMMARY.txt

[Find Optimal Resolution RNA-seq] Total runtime: 569.74 seconds

PERFORMANCE SUMMARY:
  Setup: 0.0s
  Coarse search: 426.2s (74.8%)
  Fine search: 139.2s (24.4%)
  Corrected p-values: 3.7s (0.6%)
Directory setup: 0.02 seconds
Starting RNA-seq resolution optimization for X_DR_expression...
Using representation: X_pca with 20 components
Using 10 PCs for CCA analysis
Testing resolutions from 0.01 to 1.00...
Will compute corrected p-values with 1000 simulations per resolution

=== FIRST PASS: Coarse Search ===


Testing resolution: 0.100

  Cell clustering: 23.61 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 5
  Pseudobulk computation: 9.30 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.100: CCA Score = 0.7163 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.4686
PC1 + PC3: CCA score = 0.4894
PC1 + PC4: CCA score = 0.5162
PC1 + PC5: CCA score = 0.4853
PC1 + PC6: CCA score = 0.4678
PC1 + PC7: CCA score = 0.5439
PC1 + PC8: CCA score = 0.5748
PC1 + PC9: CCA score = 0.4880
PC1 + PC10: CCA score = 0.4680
PC2 + PC3: CCA score = 0.1466
PC2 + PC4: CCA score = 0.2203
PC2 + PC5: CCA score = 0.1326
PC2 + PC6: CCA score = 0.0301
PC2 + PC7: CCA score = 0.2790
PC2 + PC8: CCA score = 0.3353
PC2 + PC9: CCA score = 0.1422
PC2 + PC10: CCA score = 0.0320
PC3 + PC4: CCA score = 0.2616
PC3 + PC5: CCA score = 0.1936
PC3 + PC6: CCA score = 0.1442
PC3 + PC7: CCA score = 0.3126
PC3 + PC8: CCA score = 0.3638
PC3 + PC9: CCA score = 0.2003
PC3 + PC10: CCA score = 0.1446
PC4 + PC5: CCA score = 0.2540
PC4 + PC6: CCA score = 0.2187
PC4 + PC7: CCA score = 0.3532
PC4 + PC8: CCA score = 0.3992
PC4 + PC9: CCA score = 0.2591
PC4 + PC10: CCA score = 0.2190
PC5 + PC6: CCA score = 0.1299
PC5 + PC7: CCA score = 0.3062
PC5 + PC8: CCA score = 0.3583
PC5 + PC9: CCA score = 0.1902
PC5 + PC10: CCA score = 0.1304
PC6 + PC7: CCA score = 0.2777
PC6 + PC8: CCA score = 0.3343
PC6 + PC9: CCA score = 0.1397
PC6 + PC10: CCA score = 0.0179
PC7 + PC8: CCA score = 0.4343
PC7 + PC9: CCA score = 0.3105
PC7 + PC10: CCA score = 0.2779
PC8 + PC9: CCA score = 0.3620
PC8 + PC10: CCA score = 0.3344
PC9 + PC10: CCA score = 0.1401
Best combination: PC1 + PC8 with score 0.5748
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.100/cca_plot_res_0.100.png
Created CCA visualization plot using PC1 + PC8 (viz score: 0.5748)
  Null distribution (1000 sims): 0.92 seconds
Resolution 0.100: Standard p-value = 0.2170
TOTAL for resolution 0.100: 34.21 seconds


Testing resolution: 0.200

  Cell clustering: 23.56 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 6
  Pseudobulk computation: 10.10 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.200: CCA Score = 0.7667 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.4461
PC1 + PC3: CCA score = 0.4468
PC1 + PC4: CCA score = 0.5478
PC1 + PC5: CCA score = 0.4805
PC1 + PC6: CCA score = 0.4556
PC1 + PC7: CCA score = 0.4763
PC1 + PC8: CCA score = 0.4912
PC1 + PC9: CCA score = 0.5188
PC1 + PC10: CCA score = 0.4542
PC2 + PC3: CCA score = 0.1595
PC2 + PC4: CCA score = 0.3547
PC2 + PC5: CCA score = 0.2381
PC2 + PC6: CCA score = 0.1825
PC2 + PC7: CCA score = 0.2295
PC2 + PC8: CCA score = 0.2589
PC2 + PC9: CCA score = 0.3080
PC2 + PC10: CCA score = 0.1790
PC3 + PC4: CCA score = 0.3557
PC3 + PC5: CCA score = 0.2395
PC3 + PC6: CCA score = 0.1844
PC3 + PC7: CCA score = 0.2310
PC3 + PC8: CCA score = 0.2602
PC3 + PC9: CCA score = 0.3092
PC3 + PC10: CCA score = 0.1809
PC4 + PC5: CCA score = 0.3972
PC4 + PC6: CCA score = 0.3666
PC4 + PC7: CCA score = 0.3921
PC4 + PC8: CCA score = 0.4100
PC4 + PC9: CCA score = 0.4427
PC4 + PC10: CCA score = 0.3649
PC5 + PC6: CCA score = 0.2555
PC5 + PC7: CCA score = 0.2909
PC5 + PC8: CCA score = 0.3146
PC5 + PC9: CCA score = 0.3561
PC5 + PC10: CCA score = 0.2529
PC6 + PC7: CCA score = 0.2475
PC6 + PC8: CCA score = 0.2750
PC6 + PC9: CCA score = 0.3217
PC6 + PC10: CCA score = 0.2015
PC7 + PC8: CCA score = 0.3081
PC7 + PC9: CCA score = 0.3505
PC7 + PC10: CCA score = 0.2449
PC8 + PC9: CCA score = 0.3704
PC8 + PC10: CCA score = 0.2726
PC9 + PC10: CCA score = 0.3197
Best combination: PC1 + PC4 with score 0.5478
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.200/cca_plot_res_0.200.png
Created CCA visualization plot using PC1 + PC4 (viz score: 0.5478)
  Null distribution (1000 sims): 0.93 seconds
Resolution 0.200: Standard p-value = 0.0550
TOTAL for resolution 0.200: 34.94 seconds


Testing resolution: 0.300

  Cell clustering: 24.67 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 9
  Pseudobulk computation: 16.33 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.300: CCA Score = 0.7707 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3776
PC1 + PC3: CCA score = 0.4119
PC1 + PC4: CCA score = 0.3834
PC1 + PC5: CCA score = 0.3553
PC1 + PC6: CCA score = 0.2674
PC1 + PC7: CCA score = 0.2682
PC1 + PC8: CCA score = 0.3181
PC1 + PC9: CCA score = 0.2719
PC1 + PC10: CCA score = 0.4951
PC2 + PC3: CCA score = 0.4164
PC2 + PC4: CCA score = 0.3883
PC2 + PC5: CCA score = 0.3605
PC2 + PC6: CCA score = 0.2744
PC2 + PC7: CCA score = 0.2752
PC2 + PC8: CCA score = 0.3240
PC2 + PC9: CCA score = 0.2788
PC2 + PC10: CCA score = 0.4989
PC3 + PC4: CCA score = 0.4217
PC3 + PC5: CCA score = 0.3963
PC3 + PC6: CCA score = 0.3199
PC3 + PC7: CCA score = 0.3206
PC3 + PC8: CCA score = 0.3633
PC3 + PC9: CCA score = 0.3237
PC3 + PC10: CCA score = 0.5253
PC4 + PC5: CCA score = 0.3666
PC4 + PC6: CCA score = 0.2823
PC4 + PC7: CCA score = 0.2832
PC4 + PC8: CCA score = 0.3308
PC4 + PC9: CCA score = 0.2866
PC4 + PC10: CCA score = 0.5033
PC5 + PC6: CCA score = 0.2427
PC5 + PC7: CCA score = 0.2437
PC5 + PC8: CCA score = 0.2976
PC5 + PC9: CCA score = 0.2477
PC5 + PC10: CCA score = 0.4822
PC6 + PC7: CCA score = 0.0683
PC6 + PC8: CCA score = 0.1841
PC6 + PC9: CCA score = 0.0815
PC6 + PC10: CCA score = 0.4217
PC7 + PC8: CCA score = 0.1853
PC7 + PC9: CCA score = 0.0843
PC7 + PC10: CCA score = 0.4222
PC8 + PC9: CCA score = 0.1906
PC8 + PC10: CCA score = 0.4555
PC9 + PC10: CCA score = 0.4246
Best combination: PC3 + PC10 with score 0.5253
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.300/cca_plot_res_0.300.png
Created CCA visualization plot using PC3 + PC10 (viz score: 0.5253)
  Null distribution (1000 sims): 0.91 seconds
Resolution 0.300: Standard p-value = 0.0500
TOTAL for resolution 0.300: 42.29 seconds


Testing resolution: 0.400

  Cell clustering: 23.91 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 8
  Pseudobulk computation: 15.42 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.400: CCA Score = 0.7635 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.6052
PC1 + PC3: CCA score = 0.1877
PC1 + PC4: CCA score = 0.2587
PC1 + PC5: CCA score = 0.4077
PC1 + PC6: CCA score = 0.1986
PC1 + PC7: CCA score = 0.2092
PC1 + PC8: CCA score = 0.1913
PC1 + PC9: CCA score = 0.2651
PC1 + PC10: CCA score = 0.1906
PC2 + PC3: CCA score = 0.5762
PC2 + PC4: CCA score = 0.6030
PC2 + PC5: CCA score = 0.6804
PC2 + PC6: CCA score = 0.5798
PC2 + PC7: CCA score = 0.5835
PC2 + PC8: CCA score = 0.5774
PC2 + PC9: CCA score = 0.6058
PC2 + PC10: CCA score = 0.5771
PC3 + PC4: CCA score = 0.1806
PC3 + PC5: CCA score = 0.3632
PC3 + PC6: CCA score = 0.0716
PC3 + PC7: CCA score = 0.0971
PC3 + PC8: CCA score = 0.0479
PC3 + PC9: CCA score = 0.1897
PC3 + PC10: CCA score = 0.0450
PC4 + PC5: CCA score = 0.4045
PC4 + PC6: CCA score = 0.1919
PC4 + PC7: CCA score = 0.2028
PC4 + PC8: CCA score = 0.1843
PC4 + PC9: CCA score = 0.2601
PC4 + PC10: CCA score = 0.1836
PC5 + PC6: CCA score = 0.3690
PC5 + PC7: CCA score = 0.3748
PC5 + PC8: CCA score = 0.3651
PC5 + PC9: CCA score = 0.4086
PC5 + PC10: CCA score = 0.3647
PC6 + PC7: CCA score = 0.1168
PC6 + PC8: CCA score = 0.0806
PC6 + PC9: CCA score = 0.2004
PC6 + PC10: CCA score = 0.0789
PC7 + PC8: CCA score = 0.1039
PC7 + PC9: CCA score = 0.2109
PC7 + PC10: CCA score = 0.1026
PC8 + PC9: CCA score = 0.1932
PC8 + PC10: CCA score = 0.0581
PC9 + PC10: CCA score = 0.1925
Best combination: PC2 + PC5 with score 0.6804
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.400/cca_plot_res_0.400.png
Created CCA visualization plot using PC2 + PC5 (viz score: 0.6804)
  Null distribution (1000 sims): 0.92 seconds
Resolution 0.400: Standard p-value = 0.0960
TOTAL for resolution 0.400: 40.63 seconds


Testing resolution: 0.500

  Cell clustering: 25.03 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 8
  Pseudobulk computation: 15.77 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.500: CCA Score = 0.7411 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.5317
PC1 + PC3: CCA score = 0.2466
PC1 + PC4: CCA score = 0.2192
PC1 + PC5: CCA score = 0.4336
PC1 + PC6: CCA score = 0.3101
PC1 + PC7: CCA score = 0.2355
PC1 + PC8: CCA score = 0.2797
PC1 + PC9: CCA score = 0.2192
PC1 + PC10: CCA score = 0.2412
PC2 + PC3: CCA score = 0.5019
PC2 + PC4: CCA score = 0.4890
PC2 + PC5: CCA score = 0.6157
PC2 + PC6: CCA score = 0.5359
PC2 + PC7: CCA score = 0.4965
PC2 + PC8: CCA score = 0.5190
PC2 + PC9: CCA score = 0.4890
PC2 + PC10: CCA score = 0.4993
PC3 + PC4: CCA score = 0.1313
PC3 + PC5: CCA score = 0.3965
PC3 + PC6: CCA score = 0.2556
PC3 + PC7: CCA score = 0.1570
PC3 + PC8: CCA score = 0.2178
PC3 + PC9: CCA score = 0.1314
PC3 + PC10: CCA score = 0.1655
PC4 + PC5: CCA score = 0.3801
PC4 + PC6: CCA score = 0.2293
PC4 + PC7: CCA score = 0.1090
PC4 + PC8: CCA score = 0.1862
PC4 + PC9: CCA score = 0.0671
PC4 + PC10: CCA score = 0.1209
PC5 + PC6: CCA score = 0.4388
PC5 + PC7: CCA score = 0.3897
PC5 + PC8: CCA score = 0.4179
PC5 + PC9: CCA score = 0.3801
PC5 + PC10: CCA score = 0.3932
PC6 + PC7: CCA score = 0.2449
PC6 + PC8: CCA score = 0.2877
PC6 + PC9: CCA score = 0.2294
PC6 + PC10: CCA score = 0.2505
PC7 + PC8: CCA score = 0.2051
PC7 + PC9: CCA score = 0.1091
PC7 + PC10: CCA score = 0.1484
PC8 + PC9: CCA score = 0.1863
PC8 + PC10: CCA score = 0.2117
PC9 + PC10: CCA score = 0.1210
Best combination: PC2 + PC5 with score 0.6157
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.500/cca_plot_res_0.500.png
Created CCA visualization plot using PC2 + PC5 (viz score: 0.6157)
  Null distribution (1000 sims): 0.93 seconds
Resolution 0.500: Standard p-value = 0.1440
TOTAL for resolution 0.500: 42.13 seconds


Testing resolution: 0.600

  Cell clustering: 24.25 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 9
  Pseudobulk computation: 17.24 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.600: CCA Score = 0.7698 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.5804
PC1 + PC3: CCA score = 0.2227
PC1 + PC4: CCA score = 0.3275
PC1 + PC5: CCA score = 0.2596
PC1 + PC6: CCA score = 0.3364
PC1 + PC7: CCA score = 0.2298
PC1 + PC8: CCA score = 0.1781
PC1 + PC9: CCA score = 0.2349
PC1 + PC10: CCA score = 0.1783
PC2 + PC3: CCA score = 0.5685
PC2 + PC4: CCA score = 0.6171
PC2 + PC5: CCA score = 0.5839
PC2 + PC6: CCA score = 0.6219
PC2 + PC7: CCA score = 0.5713
PC2 + PC8: CCA score = 0.5525
PC2 + PC9: CCA score = 0.5734
PC2 + PC10: CCA score = 0.5526
PC3 + PC4: CCA score = 0.3059
PC3 + PC5: CCA score = 0.2317
PC3 + PC6: CCA score = 0.3153
PC3 + PC7: CCA score = 0.1977
PC3 + PC8: CCA score = 0.1342
PC3 + PC9: CCA score = 0.2036
PC3 + PC10: CCA score = 0.1345
PC4 + PC5: CCA score = 0.3337
PC4 + PC6: CCA score = 0.3963
PC4 + PC7: CCA score = 0.3110
PC4 + PC8: CCA score = 0.2751
PC4 + PC9: CCA score = 0.3148
PC4 + PC10: CCA score = 0.2752
PC5 + PC6: CCA score = 0.3424
PC5 + PC7: CCA score = 0.2385
PC5 + PC8: CCA score = 0.1892
PC5 + PC9: CCA score = 0.2434
PC5 + PC10: CCA score = 0.1894
PC6 + PC7: CCA score = 0.3203
PC6 + PC8: CCA score = 0.2855
PC6 + PC9: CCA score = 0.3240
PC6 + PC10: CCA score = 0.2857
PC7 + PC8: CCA score = 0.1456
PC7 + PC9: CCA score = 0.2113
PC7 + PC10: CCA score = 0.1459
PC8 + PC9: CCA score = 0.1535
PC8 + PC10: CCA score = 0.0141
PC9 + PC10: CCA score = 0.1538
Best combination: PC2 + PC6 with score 0.6219
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.600/cca_plot_res_0.600.png
Created CCA visualization plot using PC2 + PC6 (viz score: 0.6219)
  Null distribution (1000 sims): 0.93 seconds
Resolution 0.600: Standard p-value = 0.0800
TOTAL for resolution 0.600: 42.81 seconds


Testing resolution: 0.700

  Cell clustering: 24.10 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 12
  Pseudobulk computation: 21.53 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.700: CCA Score = 0.6718 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2240
PC1 + PC3: CCA score = 0.3079
PC1 + PC4: CCA score = 0.4132
PC1 + PC5: CCA score = 0.0655
PC1 + PC6: CCA score = 0.3034
PC1 + PC7: CCA score = 0.0483
PC1 + PC8: CCA score = 0.0555
PC1 + PC9: CCA score = 0.1701
PC1 + PC10: CCA score = 0.0773
PC2 + PC3: CCA score = 0.3804
PC2 + PC4: CCA score = 0.4697
PC2 + PC5: CCA score = 0.2329
PC2 + PC6: CCA score = 0.3768
PC2 + PC7: CCA score = 0.2286
PC2 + PC8: CCA score = 0.2302
PC2 + PC9: CCA score = 0.2809
PC2 + PC10: CCA score = 0.2364
PC3 + PC4: CCA score = 0.5150
PC3 + PC5: CCA score = 0.3144
PC3 + PC6: CCA score = 0.4320
PC3 + PC7: CCA score = 0.3113
PC3 + PC8: CCA score = 0.3125
PC3 + PC9: CCA score = 0.3514
PC3 + PC10: CCA score = 0.3170
PC4 + PC5: CCA score = 0.4180
PC4 + PC6: CCA score = 0.5123
PC4 + PC7: CCA score = 0.4157
PC4 + PC8: CCA score = 0.4166
PC4 + PC9: CCA score = 0.4466
PC4 + PC10: CCA score = 0.4200
PC5 + PC6: CCA score = 0.3100
PC5 + PC7: CCA score = 0.0800
PC5 + PC8: CCA score = 0.0845
PC5 + PC9: CCA score = 0.1817
PC5 + PC10: CCA score = 0.1002
PC6 + PC7: CCA score = 0.3068
PC6 + PC8: CCA score = 0.3080
PC6 + PC9: CCA score = 0.3475
PC6 + PC10: CCA score = 0.3127
PC7 + PC8: CCA score = 0.0720
PC7 + PC9: CCA score = 0.1762
PC7 + PC10: CCA score = 0.0898
PC8 + PC9: CCA score = 0.1783
PC8 + PC10: CCA score = 0.0939
PC9 + PC10: CCA score = 0.1862
Best combination: PC3 + PC4 with score 0.5150
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.700/cca_plot_res_0.700.png
Created CCA visualization plot using PC3 + PC4 (viz score: 0.5150)
  Null distribution (1000 sims): 0.92 seconds
Resolution 0.700: Standard p-value = 0.3790
TOTAL for resolution 0.700: 46.93 seconds


Testing resolution: 0.800

  Cell clustering: 24.18 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 14
  Pseudobulk computation: 23.31 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.800: CCA Score = 0.7054 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2627
PC1 + PC3: CCA score = 0.2914
PC1 + PC4: CCA score = 0.4560
PC1 + PC5: CCA score = 0.3156
PC1 + PC6: CCA score = 0.4674
PC1 + PC7: CCA score = 0.3424
PC1 + PC8: CCA score = 0.3189
PC1 + PC9: CCA score = 0.2798
PC1 + PC10: CCA score = 0.2622
PC2 + PC3: CCA score = 0.1298
PC2 + PC4: CCA score = 0.3739
PC2 + PC5: CCA score = 0.1775
PC2 + PC6: CCA score = 0.3878
PC2 + PC7: CCA score = 0.2217
PC2 + PC8: CCA score = 0.1833
PC2 + PC9: CCA score = 0.1009
PC2 + PC10: CCA score = 0.0255
PC3 + PC4: CCA score = 0.3947
PC3 + PC5: CCA score = 0.2178
PC3 + PC6: CCA score = 0.4079
PC3 + PC7: CCA score = 0.2552
PC3 + PC8: CCA score = 0.2226
PC3 + PC9: CCA score = 0.1617
PC3 + PC10: CCA score = 0.1288
PC4 + PC5: CCA score = 0.4128
PC4 + PC6: CCA score = 0.5379
PC4 + PC7: CCA score = 0.4337
PC4 + PC8: CCA score = 0.4154
PC4 + PC9: CCA score = 0.3862
PC4 + PC10: CCA score = 0.3736
PC5 + PC6: CCA score = 0.4254
PC5 + PC7: CCA score = 0.2824
PC5 + PC8: CCA score = 0.2534
PC5 + PC9: CCA score = 0.2020
PC5 + PC10: CCA score = 0.1768
PC6 + PC7: CCA score = 0.4457
PC6 + PC8: CCA score = 0.4279
PC6 + PC9: CCA score = 0.3996
PC6 + PC10: CCA score = 0.3875
PC7 + PC8: CCA score = 0.2861
PC7 + PC9: CCA score = 0.2418
PC7 + PC10: CCA score = 0.2211
PC8 + PC9: CCA score = 0.2071
PC8 + PC10: CCA score = 0.1826
PC9 + PC10: CCA score = 0.0996
Best combination: PC4 + PC6 with score 0.5379
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.800/cca_plot_res_0.800.png
Created CCA visualization plot using PC4 + PC6 (viz score: 0.5379)
  Null distribution (1000 sims): 0.94 seconds
Resolution 0.800: Standard p-value = 0.2580
TOTAL for resolution 0.800: 48.81 seconds


Testing resolution: 0.900

  Cell clustering: 24.20 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 15
  Pseudobulk computation: 25.05 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.900: CCA Score = 0.7493 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2959
PC1 + PC3: CCA score = 0.3794
PC1 + PC4: CCA score = 0.5068
PC1 + PC5: CCA score = 0.3183
PC1 + PC6: CCA score = 0.3466
PC1 + PC7: CCA score = 0.3683
PC1 + PC8: CCA score = 0.4200
PC1 + PC9: CCA score = 0.3538
PC1 + PC10: CCA score = 0.3014
PC2 + PC3: CCA score = 0.2498
PC2 + PC4: CCA score = 0.4187
PC2 + PC5: CCA score = 0.1406
PC2 + PC6: CCA score = 0.1964
PC2 + PC7: CCA score = 0.2326
PC2 + PC8: CCA score = 0.3080
PC2 + PC9: CCA score = 0.2089
PC2 + PC10: CCA score = 0.0965
PC3 + PC4: CCA score = 0.4814
PC3 + PC5: CCA score = 0.2760
PC3 + PC6: CCA score = 0.3081
PC3 + PC7: CCA score = 0.3324
PC3 + PC8: CCA score = 0.3889
PC3 + PC9: CCA score = 0.3163
PC3 + PC10: CCA score = 0.2563
PC4 + PC5: CCA score = 0.4349
PC4 + PC6: CCA score = 0.4559
PC4 + PC7: CCA score = 0.4727
PC4 + PC8: CCA score = 0.5140
PC4 + PC9: CCA score = 0.4615
PC4 + PC10: CCA score = 0.4227
PC5 + PC6: CCA score = 0.2288
PC5 + PC7: CCA score = 0.2605
PC5 + PC8: CCA score = 0.3296
PC5 + PC9: CCA score = 0.2397
PC5 + PC10: CCA score = 0.1520
PC6 + PC7: CCA score = 0.2944
PC6 + PC8: CCA score = 0.3569
PC6 + PC9: CCA score = 0.2761
PC6 + PC10: CCA score = 0.2046
PC7 + PC8: CCA score = 0.3781
PC7 + PC9: CCA score = 0.3029
PC7 + PC10: CCA score = 0.2396
PC8 + PC9: CCA score = 0.3640
PC8 + PC10: CCA score = 0.3133
PC9 + PC10: CCA score = 0.2167
Best combination: PC4 + PC8 with score 0.5140
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.900/cca_plot_res_0.900.png
Created CCA visualization plot using PC4 + PC8 (viz score: 0.5140)
  Null distribution (1000 sims): 0.92 seconds
Resolution 0.900: Standard p-value = 0.1160
TOTAL for resolution 0.900: 50.53 seconds


Testing resolution: 1.000

  Cell clustering: 24.03 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 14
  Pseudobulk computation: 23.54 seconds
  Dimension reduction: 0.01 seconds
Resolution 1.000: CCA Score = 0.7428 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2857
PC1 + PC3: CCA score = 0.4119
PC1 + PC4: CCA score = 0.4861
PC1 + PC5: CCA score = 0.3515
PC1 + PC6: CCA score = 0.4288
PC1 + PC7: CCA score = 0.2782
PC1 + PC8: CCA score = 0.3040
PC1 + PC9: CCA score = 0.3100
PC1 + PC10: CCA score = 0.3300
PC2 + PC3: CCA score = 0.3111
PC2 + PC4: CCA score = 0.4043
PC2 + PC5: CCA score = 0.2252
PC2 + PC6: CCA score = 0.3331
PC2 + PC7: CCA score = 0.0672
PC2 + PC8: CCA score = 0.1399
PC2 + PC9: CCA score = 0.1525
PC2 + PC10: CCA score = 0.1898
PC3 + PC4: CCA score = 0.5014
PC3 + PC5: CCA score = 0.3724
PC3 + PC6: CCA score = 0.4461
PC3 + PC7: CCA score = 0.3042
PC3 + PC8: CCA score = 0.3280
PC3 + PC9: CCA score = 0.3335
PC3 + PC10: CCA score = 0.3522
PC4 + PC5: CCA score = 0.4532
PC4 + PC6: CCA score = 0.5154
PC4 + PC7: CCA score = 0.3989
PC4 + PC8: CCA score = 0.4174
PC4 + PC9: CCA score = 0.4218
PC4 + PC10: CCA score = 0.4367
PC5 + PC6: CCA score = 0.3910
PC5 + PC7: CCA score = 0.2155
PC5 + PC8: CCA score = 0.2480
PC5 + PC9: CCA score = 0.2553
PC5 + PC10: CCA score = 0.2792
PC6 + PC7: CCA score = 0.3266
PC6 + PC8: CCA score = 0.3489
PC6 + PC9: CCA score = 0.3542
PC6 + PC10: CCA score = 0.3718
PC7 + PC8: CCA score = 0.1237
PC7 + PC9: CCA score = 0.1378
PC7 + PC10: CCA score = 0.1782
PC8 + PC9: CCA score = 0.1845
PC8 + PC10: CCA score = 0.2164
PC9 + PC10: CCA score = 0.2247
Best combination: PC4 + PC6 with score 0.5154
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_1.000/cca_plot_res_1.000.png
Created CCA visualization plot using PC4 + PC6 (viz score: 0.5154)
  Null distribution (1000 sims): 0.94 seconds
Resolution 1.000: Standard p-value = 0.1270
TOTAL for resolution 1.000: 48.90 seconds

COARSE SEARCH TOTAL: 432.20 seconds

Best resolution from first pass: 0.30
Best CCA score: 0.7707

=== SECOND PASS: Fine-tuned Search ===
Fine-tuning search from 0.28 to 0.32...


Testing resolution: 0.280

  Cell clustering: 24.06 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 8
  Pseudobulk computation: 13.49 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.280: CCA Score = 0.7125 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.5971
PC1 + PC3: CCA score = 0.4027
PC1 + PC4: CCA score = 0.3806
PC1 + PC5: CCA score = 0.4340
PC1 + PC6: CCA score = 0.4075
PC1 + PC7: CCA score = 0.4139
PC1 + PC8: CCA score = 0.4095
PC1 + PC9: CCA score = 0.3841
PC1 + PC10: CCA score = 0.4024
PC2 + PC3: CCA score = 0.4785
PC2 + PC4: CCA score = 0.4601
PC2 + PC5: CCA score = 0.5051
PC2 + PC6: CCA score = 0.4826
PC2 + PC7: CCA score = 0.4879
PC2 + PC8: CCA score = 0.4843
PC2 + PC9: CCA score = 0.4630
PC2 + PC10: CCA score = 0.4782
PC3 + PC4: CCA score = 0.1317
PC3 + PC5: CCA score = 0.2467
PC3 + PC6: CCA score = 0.1965
PC3 + PC7: CCA score = 0.2093
PC3 + PC8: CCA score = 0.2006
PC3 + PC9: CCA score = 0.1417
PC3 + PC10: CCA score = 0.1855
PC4 + PC5: CCA score = 0.2086
PC4 + PC6: CCA score = 0.1459
PC4 + PC7: CCA score = 0.1627
PC4 + PC8: CCA score = 0.1513
PC4 + PC9: CCA score = 0.0523
PC4 + PC10: CCA score = 0.1307
PC5 + PC6: CCA score = 0.2545
PC5 + PC7: CCA score = 0.2645
PC5 + PC8: CCA score = 0.2576
PC5 + PC9: CCA score = 0.2150
PC5 + PC10: CCA score = 0.2461
PC6 + PC7: CCA score = 0.2184
PC6 + PC8: CCA score = 0.2101
PC6 + PC9: CCA score = 0.1549
PC6 + PC10: CCA score = 0.1958
PC7 + PC8: CCA score = 0.2221
PC7 + PC9: CCA score = 0.1708
PC7 + PC10: CCA score = 0.2086
PC8 + PC9: CCA score = 0.1600
PC8 + PC10: CCA score = 0.1999
PC9 + PC10: CCA score = 0.1407
Best combination: PC1 + PC2 with score 0.5971
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.280/cca_plot_res_0.280.png
Created CCA visualization plot using PC1 + PC2 (viz score: 0.5971)
  Null distribution (1000 sims): 0.94 seconds
Resolution 0.280: Standard p-value = 0.2200
TOTAL for resolution 0.280: 38.86 seconds


Testing resolution: 0.290

  Cell clustering: 23.97 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 9
  Pseudobulk computation: 15.83 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.290: CCA Score = 0.7897 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2240
PC1 + PC3: CCA score = 0.5214
PC1 + PC4: CCA score = 0.4187
PC1 + PC5: CCA score = 0.2951
PC1 + PC6: CCA score = 0.2327
PC1 + PC7: CCA score = 0.3717
PC1 + PC8: CCA score = 0.3249
PC1 + PC9: CCA score = 0.2200
PC1 + PC10: CCA score = 0.2655
PC2 + PC3: CCA score = 0.4771
PC2 + PC4: CCA score = 0.3620
PC2 + PC5: CCA score = 0.2071
PC2 + PC6: CCA score = 0.0998
PC2 + PC7: CCA score = 0.3066
PC2 + PC8: CCA score = 0.2477
PC2 + PC9: CCA score = 0.0649
PC2 + PC10: CCA score = 0.1622
PC3 + PC4: CCA score = 0.5939
PC3 + PC5: CCA score = 0.5143
PC3 + PC6: CCA score = 0.4813
PC3 + PC7: CCA score = 0.5618
PC3 + PC8: CCA score = 0.5320
PC3 + PC9: CCA score = 0.4753
PC3 + PC10: CCA score = 0.4980
PC4 + PC5: CCA score = 0.4098
PC4 + PC6: CCA score = 0.3675
PC4 + PC7: CCA score = 0.4681
PC4 + PC8: CCA score = 0.4318
PC4 + PC9: CCA score = 0.3596
PC4 + PC10: CCA score = 0.3891
PC5 + PC6: CCA score = 0.2165
PC5 + PC7: CCA score = 0.3618
PC5 + PC8: CCA score = 0.3134
PC5 + PC9: CCA score = 0.2027
PC5 + PC10: CCA score = 0.2514
PC6 + PC7: CCA score = 0.3130
PC6 + PC8: CCA score = 0.2556
PC6 + PC9: CCA score = 0.0905
PC6 + PC10: CCA score = 0.1741
PC7 + PC8: CCA score = 0.3865
PC7 + PC9: CCA score = 0.3037
PC7 + PC10: CCA score = 0.3381
PC8 + PC9: CCA score = 0.2441
PC8 + PC10: CCA score = 0.2858
PC9 + PC10: CCA score = 0.1567
Best combination: PC3 + PC4 with score 0.5939
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.290/cca_plot_res_0.290.png
Created CCA visualization plot using PC3 + PC4 (viz score: 0.5939)
  Null distribution (1000 sims): 0.93 seconds
Resolution 0.290: Standard p-value = 0.0330
TOTAL for resolution 0.290: 41.09 seconds


Testing resolution: 0.310

  Cell clustering: 24.62 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 9
  Pseudobulk computation: 16.42 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.310: CCA Score = 0.7166 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.4022
PC1 + PC3: CCA score = 0.3510
PC1 + PC4: CCA score = 0.2653
PC1 + PC5: CCA score = 0.2842
PC1 + PC6: CCA score = 0.2237
PC1 + PC7: CCA score = 0.2881
PC1 + PC8: CCA score = 0.2255
PC1 + PC9: CCA score = 0.3670
PC1 + PC10: CCA score = 0.3643
PC2 + PC3: CCA score = 0.4375
PC2 + PC4: CCA score = 0.3724
PC2 + PC5: CCA score = 0.3861
PC2 + PC6: CCA score = 0.3440
PC2 + PC7: CCA score = 0.3889
PC2 + PC8: CCA score = 0.3452
PC2 + PC9: CCA score = 0.4505
PC2 + PC10: CCA score = 0.4483
PC3 + PC4: CCA score = 0.3164
PC3 + PC5: CCA score = 0.3324
PC3 + PC6: CCA score = 0.2824
PC3 + PC7: CCA score = 0.3357
PC3 + PC8: CCA score = 0.2839
PC3 + PC9: CCA score = 0.4055
PC3 + PC10: CCA score = 0.4030
PC4 + PC5: CCA score = 0.2402
PC4 + PC6: CCA score = 0.1642
PC4 + PC7: CCA score = 0.2448
PC4 + PC8: CCA score = 0.1667
PC4 + PC9: CCA score = 0.3341
PC4 + PC10: CCA score = 0.3311
PC5 + PC6: CCA score = 0.1933
PC5 + PC7: CCA score = 0.2651
PC5 + PC8: CCA score = 0.1954
PC5 + PC9: CCA score = 0.3493
PC5 + PC10: CCA score = 0.3465
PC6 + PC7: CCA score = 0.1989
PC6 + PC8: CCA score = 0.0863
PC6 + PC9: CCA score = 0.3021
PC6 + PC10: CCA score = 0.2988
PC7 + PC8: CCA score = 0.2010
PC7 + PC9: CCA score = 0.3525
PC7 + PC10: CCA score = 0.3497
PC8 + PC9: CCA score = 0.3035
PC8 + PC10: CCA score = 0.3002
PC9 + PC10: CCA score = 0.4171
Best combination: PC2 + PC9 with score 0.4505
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.310/cca_plot_res_0.310.png
Created CCA visualization plot using PC2 + PC9 (viz score: 0.4505)
  Null distribution (1000 sims): 0.92 seconds
Resolution 0.310: Standard p-value = 0.1630
TOTAL for resolution 0.310: 42.36 seconds


Testing resolution: 0.320

  Cell clustering: 24.29 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 8
  Pseudobulk computation: 15.39 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.320: CCA Score = 0.7272 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.5121
PC1 + PC3: CCA score = 0.2819
PC1 + PC4: CCA score = 0.2039
PC1 + PC5: CCA score = 0.3012
PC1 + PC6: CCA score = 0.2051
PC1 + PC7: CCA score = 0.3935
PC1 + PC8: CCA score = 0.3246
PC1 + PC9: CCA score = 0.2036
PC1 + PC10: CCA score = 0.2032
PC2 + PC3: CCA score = 0.5091
PC2 + PC4: CCA score = 0.4704
PC2 + PC5: CCA score = 0.5200
PC2 + PC6: CCA score = 0.4709
PC2 + PC7: CCA score = 0.5784
PC2 + PC8: CCA score = 0.5339
PC2 + PC9: CCA score = 0.4703
PC2 + PC10: CCA score = 0.4701
PC3 + PC4: CCA score = 0.1962
PC3 + PC5: CCA score = 0.2961
PC3 + PC6: CCA score = 0.1975
PC3 + PC7: CCA score = 0.3896
PC3 + PC8: CCA score = 0.3198
PC3 + PC9: CCA score = 0.1959
PC3 + PC10: CCA score = 0.1955
PC4 + PC5: CCA score = 0.2231
PC4 + PC6: CCA score = 0.0334
PC4 + PC7: CCA score = 0.3375
PC4 + PC8: CCA score = 0.2537
PC4 + PC9: CCA score = 0.0223
PC4 + PC10: CCA score = 0.0184
PC5 + PC6: CCA score = 0.2242
PC5 + PC7: CCA score = 0.4038
PC5 + PC8: CCA score = 0.3369
PC5 + PC9: CCA score = 0.2228
PC5 + PC10: CCA score = 0.2225
PC6 + PC7: CCA score = 0.3382
PC6 + PC8: CCA score = 0.2547
PC6 + PC9: CCA score = 0.0316
PC6 + PC10: CCA score = 0.0290
PC7 + PC8: CCA score = 0.4215
PC7 + PC9: CCA score = 0.3373
PC7 + PC10: CCA score = 0.3371
PC8 + PC9: CCA score = 0.2535
PC8 + PC10: CCA score = 0.2532
PC9 + PC10: CCA score = 0.0149
Best combination: PC2 + PC7 with score 0.5784
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.320/cca_plot_res_0.320.png
Created CCA visualization plot using PC2 + PC7 (viz score: 0.5784)
  Null distribution (1000 sims): 0.94 seconds
Resolution 0.320: Standard p-value = 0.2040
TOTAL for resolution 0.320: 40.97 seconds

FINE SEARCH TOTAL: 163.29 seconds

=== GENERATING CORRECTED NULL DISTRIBUTION ===
Accounting for resolution selection bias...
  Corrected null distribution generation: 0.00 seconds
Corrected null distribution saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/corrected_null/corrected_null_distribution_expression.npy

=== COMPUTING CORRECTED P-VALUES ===
  Corrected p-values computation: 3.50 seconds
Corrected null distribution plot saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/corrected_null/corrected_null_distribution.png
CORRECTED P-VALUES TOTAL: 3.76 seconds

=== FINAL RESULTS ===
Best resolution: 0.290
Best CCA score: 0.7897
Number of clusters at best resolution: 9
Number of PCs used: 10
Best visualization used PC3 + PC4
Standard p-value: 0.0330
Corrected p-value: 0.4300
Summary plot saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/summary/resolution_optimization_summary_X_DR_expression.png
Summary report saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/summary/optimization_results_X_DR_expression.txt
Detailed results saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/summary/detailed_results_X_DR_expression.csv

All results saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/all_resolution_results_expression.csv

Final summary saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/FINAL_SUMMARY.txt

[Find Optimal Resolution RNA-seq] Total runtime: 599.88 seconds

PERFORMANCE SUMMARY:
  Setup: 0.0s
  Coarse search: 432.2s (72.0%)
  Fine search: 163.3s (27.2%)
  Corrected p-values: 3.8s (0.6%)
RNA analysis completed successfully!

✓ RNA pipeline completed successfully!

============================================================
PIPELINE EXECUTION SUMMARY
============================================================
RNA Pipeline: ⚠ PARTIAL
  - preprocessing: ✓
  - cell_type_cluster: ✓
  - dimensionality_reduction: ✓
  - sample_distance_calculation: ✗
  - trajectory_analysis: ✓
  - trajectory_dge: ✗
  - cluster_dge: ✗
  - visualization: ✗

Results saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample
Status file: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/sys_log/main_process_status.json
Execution time: 1383.7988 seconds
