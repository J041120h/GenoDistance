Linux system detected with GPU enabled.
Resuming process from previous progress:
{
    "rna": {
        "preprocessing": true,
        "cell_type_cluster": true,
        "dimensionality_reduction": true,
        "sample_distance_calculation": true,
        "trajectory_analysis": true,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "atac": {
        "preprocessing": false,
        "cell_type_cluster": false,
        "dimensionality_reduction": false,
        "sample_distance_calculation": false,
        "trajectory_analysis": false,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "multiomics": {
        "glue_integration": false,
        "glue_preprocessing": false,
        "glue_training": false,
        "glue_gene_activity": false,
        "glue_cell_types": false,
        "glue_visualization": false,
        "integration_preprocessing": false,
        "dimensionality_reduction": false,
        "embedding_visualization": false,
        "optimal_resolution": false
    },
    "system_info": {
        "platform": "Linux",
        "python_version": "3.10.18 | packaged by conda-forge | (main, Jun  4 2025, 14:45:41) [GCC 13.3.0]",
        "use_gpu": true,
        "linux_system": true
    }
}

============================================================
RUNNING RNA PIPELINE
============================================================
Starting RNA wrapper function with provided parameters...
Reading Pseudobulk from provided or default path: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/pseudobulk/pseudobulk_sample.h5ad
Using PROFILED GPU version of optimal resolution
Directory setup: 0.00 seconds
Starting RNA-seq resolution optimization for X_DR_proportion...
Using representation: X_pca with 20 components
Using 10 PCs for CCA analysis
Testing resolutions from 0.01 to 1.00...
Will compute corrected p-values with 1000 simulations per resolution

=== FIRST PASS: Coarse Search ===


Testing resolution: 0.100

  Cell clustering: 2.74 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 4
  Pseudobulk computation: 7.14 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.100: CCA Score = 0.4527 (using 4 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 4 components...
Testing 6 PC combinations...
PC1 + PC2: CCA score = 0.3260
PC1 + PC3: CCA score = 0.2738
PC1 + PC4: CCA score = 0.4006
PC2 + PC3: CCA score = 0.2109
PC2 + PC4: CCA score = 0.3605
PC3 + PC4: CCA score = 0.3141
Best combination: PC1 + PC4 with score 0.4006
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.100/cca_plot_res_0.100.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.100/cca_plot_res_0.100_contributions.png
Created CCA visualization plot using PC1 + PC4 (viz score: 0.4006)
  Null distribution (1000 sims): 1.15 seconds
Resolution 0.100: Standard p-value = 0.3010
TOTAL for resolution 0.100: 11.77 seconds


Testing resolution: 0.200

  Cell clustering: 1.92 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 5
  Pseudobulk computation: 8.54 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.200: CCA Score = 0.3938 (using 5 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3337
PC1 + PC3: CCA score = 0.2789
PC1 + PC4: CCA score = 0.2679
PC1 + PC5: CCA score = 0.3145
PC2 + PC3: CCA score = 0.2294
PC2 + PC4: CCA score = 0.2159
PC2 + PC5: CCA score = 0.2716
PC3 + PC4: CCA score = 0.1141
PC3 + PC5: CCA score = 0.2004
PC4 + PC5: CCA score = 0.1849
Best combination: PC1 + PC2 with score 0.3337
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.200/cca_plot_res_0.200.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.200/cca_plot_res_0.200_contributions.png
Created CCA visualization plot using PC1 + PC2 (viz score: 0.3337)
  Null distribution (1000 sims): 1.15 seconds
Resolution 0.200: Standard p-value = 0.6140
TOTAL for resolution 0.200: 12.34 seconds


Testing resolution: 0.300

  Cell clustering: 2.15 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 9
  Pseudobulk computation: 13.84 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.300: CCA Score = 0.4217 (using 5 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3367
PC1 + PC3: CCA score = 0.3174
PC1 + PC4: CCA score = 0.3122
PC1 + PC5: CCA score = 0.2687
PC2 + PC3: CCA score = 0.2772
PC2 + PC4: CCA score = 0.2711
PC2 + PC5: CCA score = 0.2197
PC3 + PC4: CCA score = 0.2468
PC3 + PC5: CCA score = 0.1889
PC4 + PC5: CCA score = 0.1800
Best combination: PC1 + PC2 with score 0.3367
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.300/cca_plot_res_0.300.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.300/cca_plot_res_0.300_contributions.png
Created CCA visualization plot using PC1 + PC2 (viz score: 0.3367)
  Null distribution (1000 sims): 1.15 seconds
Resolution 0.300: Standard p-value = 0.5350
TOTAL for resolution 0.300: 17.87 seconds


Testing resolution: 0.400

  Cell clustering: 2.79 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 9
  Pseudobulk computation: 14.18 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.400: CCA Score = 0.4330 (using 5 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3374
PC1 + PC3: CCA score = 0.3451
PC1 + PC4: CCA score = 0.3030
PC1 + PC5: CCA score = 0.2936
PC2 + PC3: CCA score = 0.2898
PC2 + PC4: CCA score = 0.2381
PC2 + PC5: CCA score = 0.2259
PC3 + PC4: CCA score = 0.2489
PC3 + PC5: CCA score = 0.2373
PC4 + PC5: CCA score = 0.1704
Best combination: PC1 + PC3 with score 0.3451
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.400/cca_plot_res_0.400.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.400/cca_plot_res_0.400_contributions.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3451)
  Null distribution (1000 sims): 1.15 seconds
Resolution 0.400: Standard p-value = 0.5000
TOTAL for resolution 0.400: 18.84 seconds


Testing resolution: 0.500

  Cell clustering: 2.24 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 10
  Pseudobulk computation: 14.66 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.500: CCA Score = 0.4395 (using 5 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3366
PC1 + PC3: CCA score = 0.3534
PC1 + PC4: CCA score = 0.2616
PC1 + PC5: CCA score = 0.3015
PC2 + PC3: CCA score = 0.3193
PC2 + PC4: CCA score = 0.2133
PC2 + PC5: CCA score = 0.2607
PC3 + PC4: CCA score = 0.2389
PC3 + PC5: CCA score = 0.2820
PC4 + PC5: CCA score = 0.1519
Best combination: PC1 + PC3 with score 0.3534
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.500/cca_plot_res_0.500.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.500/cca_plot_res_0.500_contributions.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3534)
  Null distribution (1000 sims): 1.15 seconds
Resolution 0.500: Standard p-value = 0.4800
TOTAL for resolution 0.500: 18.77 seconds


Testing resolution: 0.600

  Cell clustering: 2.18 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 12
  Pseudobulk computation: 17.46 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.600: CCA Score = 0.4460 (using 5 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3464
PC1 + PC3: CCA score = 0.3611
PC1 + PC4: CCA score = 0.3017
PC1 + PC5: CCA score = 0.3098
PC2 + PC3: CCA score = 0.3023
PC2 + PC4: CCA score = 0.2281
PC2 + PC5: CCA score = 0.2387
PC3 + PC4: CCA score = 0.2498
PC3 + PC5: CCA score = 0.2595
PC4 + PC5: CCA score = 0.1673
Best combination: PC1 + PC3 with score 0.3611
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.600/cca_plot_res_0.600.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.600/cca_plot_res_0.600_contributions.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3611)
  Null distribution (1000 sims): 1.16 seconds
Resolution 0.600: Standard p-value = 0.4640
TOTAL for resolution 0.600: 21.53 seconds


Testing resolution: 0.700

  Cell clustering: 2.15 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 12
  Pseudobulk computation: 17.00 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.700: CCA Score = 0.4491 (using 5 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3452
PC1 + PC3: CCA score = 0.3635
PC1 + PC4: CCA score = 0.2986
PC1 + PC5: CCA score = 0.3062
PC2 + PC3: CCA score = 0.3102
PC2 + PC4: CCA score = 0.2308
PC2 + PC5: CCA score = 0.2405
PC3 + PC4: CCA score = 0.2575
PC3 + PC5: CCA score = 0.2662
PC4 + PC5: CCA score = 0.1671
Best combination: PC1 + PC3 with score 0.3635
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.700/cca_plot_res_0.700.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.700/cca_plot_res_0.700_contributions.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3635)
  Null distribution (1000 sims): 1.15 seconds
Resolution 0.700: Standard p-value = 0.4500
TOTAL for resolution 0.700: 21.03 seconds


Testing resolution: 0.800

  Cell clustering: 2.23 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 13
  Pseudobulk computation: 18.52 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.800: CCA Score = 0.5046 (using 5 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3438
PC1 + PC3: CCA score = 0.3655
PC1 + PC4: CCA score = 0.3320
PC1 + PC5: CCA score = 0.3425
PC2 + PC3: CCA score = 0.3194
PC2 + PC4: CCA score = 0.2805
PC2 + PC5: CCA score = 0.2928
PC3 + PC4: CCA score = 0.3067
PC3 + PC5: CCA score = 0.3179
PC4 + PC5: CCA score = 0.2789
Best combination: PC1 + PC3 with score 0.3655
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.800/cca_plot_res_0.800.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.800/cca_plot_res_0.800_contributions.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3655)
  Null distribution (1000 sims): 1.15 seconds
Resolution 0.800: Standard p-value = 0.2860
TOTAL for resolution 0.800: 22.63 seconds


Testing resolution: 0.900

  Cell clustering: 2.03 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 14
  Pseudobulk computation: 20.13 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.900: CCA Score = 0.4596 (using 5 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3505
PC1 + PC3: CCA score = 0.3603
PC1 + PC4: CCA score = 0.3215
PC1 + PC5: CCA score = 0.2909
PC2 + PC3: CCA score = 0.3159
PC2 + PC4: CCA score = 0.2707
PC2 + PC5: CCA score = 0.2336
PC3 + PC4: CCA score = 0.2833
PC3 + PC5: CCA score = 0.2480
PC4 + PC5: CCA score = 0.1872
Best combination: PC1 + PC3 with score 0.3603
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.900/cca_plot_res_0.900.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.900/cca_plot_res_0.900_contributions.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3603)
  Null distribution (1000 sims): 1.16 seconds
Resolution 0.900: Standard p-value = 0.4200
TOTAL for resolution 0.900: 24.05 seconds


Testing resolution: 1.000

  Cell clustering: 2.11 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 16
  Pseudobulk computation: 23.47 seconds
  Dimension reduction: 0.01 seconds
Resolution 1.000: CCA Score = 0.4829 (using 5 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3500
PC1 + PC3: CCA score = 0.3528
PC1 + PC4: CCA score = 0.3362
PC1 + PC5: CCA score = 0.3341
PC2 + PC3: CCA score = 0.2967
PC2 + PC4: CCA score = 0.2768
PC2 + PC5: CCA score = 0.2742
PC3 + PC4: CCA score = 0.2803
PC3 + PC5: CCA score = 0.2777
PC4 + PC5: CCA score = 0.2563
Best combination: PC1 + PC3 with score 0.3528
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_1.000/cca_plot_res_1.000.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_1.000/cca_plot_res_1.000_contributions.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3528)
  Null distribution (1000 sims): 1.15 seconds
Resolution 1.000: Standard p-value = 0.3390
TOTAL for resolution 1.000: 27.46 seconds

COARSE SEARCH TOTAL: 196.31 seconds

Best resolution from first pass: 0.80
Best CCA score: 0.5046

=== SECOND PASS: Fine-tuned Search ===
Fine-tuning search from 0.78 to 0.82...


Testing resolution: 0.780

  Cell clustering: 2.08 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 11
  Pseudobulk computation: 16.39 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.780: CCA Score = 0.4307 (using 5 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3415
PC1 + PC3: CCA score = 0.3686
PC1 + PC4: CCA score = 0.2992
PC1 + PC5: CCA score = 0.3019
PC2 + PC3: CCA score = 0.2956
PC2 + PC4: CCA score = 0.2026
PC2 + PC5: CCA score = 0.2065
PC3 + PC4: CCA score = 0.2455
PC3 + PC5: CCA score = 0.2488
PC4 + PC5: CCA score = 0.1246
Best combination: PC1 + PC3 with score 0.3686
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.780/cca_plot_res_0.780.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.780/cca_plot_res_0.780_contributions.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3686)
  Null distribution (1000 sims): 1.15 seconds
Resolution 0.780: Standard p-value = 0.5050
TOTAL for resolution 0.780: 20.33 seconds


Testing resolution: 0.790

  Cell clustering: 2.20 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 12
  Pseudobulk computation: 17.28 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.790: CCA Score = 0.4341 (using 5 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3419
PC1 + PC3: CCA score = 0.3643
PC1 + PC4: CCA score = 0.2956
PC1 + PC5: CCA score = 0.3038
PC2 + PC3: CCA score = 0.2984
PC2 + PC4: CCA score = 0.2091
PC2 + PC5: CCA score = 0.2206
PC3 + PC4: CCA score = 0.2440
PC3 + PC5: CCA score = 0.2539
PC4 + PC5: CCA score = 0.1383
Best combination: PC1 + PC3 with score 0.3643
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.790/cca_plot_res_0.790.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.790/cca_plot_res_0.790_contributions.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3643)
  Null distribution (1000 sims): 1.15 seconds
Resolution 0.790: Standard p-value = 0.4930
TOTAL for resolution 0.790: 21.36 seconds


Testing resolution: 0.810

  Cell clustering: 2.16 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 11
  Pseudobulk computation: 16.40 seconds
  Dimension reduction: 0.01 seconds
Resolution 0.810: CCA Score = 0.4831 (using 5 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3478
PC1 + PC3: CCA score = 0.3765
PC1 + PC4: CCA score = 0.3315
PC1 + PC5: CCA score = 0.3417
PC2 + PC3: CCA score = 0.3035
PC2 + PC4: CCA score = 0.2453
PC2 + PC5: CCA score = 0.2589
PC3 + PC4: CCA score = 0.2846
PC3 + PC5: CCA score = 0.2964
PC4 + PC5: CCA score = 0.2365
Best combination: PC1 + PC3 with score 0.3765
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.810/cca_plot_res_0.810.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.810/cca_plot_res_0.810_contributions.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3765)
  Null distribution (1000 sims): 1.14 seconds
Resolution 0.810: Standard p-value = 0.3500
TOTAL for resolution 0.810: 20.40 seconds


Testing resolution: 0.820

  Cell clustering: 2.07 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 12
  Pseudobulk computation: 17.18 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.820: CCA Score = 0.4884 (using 5 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3456
PC1 + PC3: CCA score = 0.3696
PC1 + PC4: CCA score = 0.3201
PC1 + PC5: CCA score = 0.3316
PC2 + PC3: CCA score = 0.3205
PC2 + PC4: CCA score = 0.2619
PC2 + PC5: CCA score = 0.2758
PC3 + PC4: CCA score = 0.2929
PC3 + PC5: CCA score = 0.3054
PC4 + PC5: CCA score = 0.2431
Best combination: PC1 + PC3 with score 0.3696
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.820/cca_plot_res_0.820.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.820/cca_plot_res_0.820_contributions.png
Created CCA visualization plot using PC1 + PC3 (viz score: 0.3696)
  Null distribution (1000 sims): 1.15 seconds
Resolution 0.820: Standard p-value = 0.3390
TOTAL for resolution 0.820: 21.14 seconds

FINE SEARCH TOTAL: 83.24 seconds

=== GENERATING CORRECTED NULL DISTRIBUTION ===
Accounting for resolution selection bias...
  Corrected null distribution generation: 0.00 seconds
Corrected null distribution saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/corrected_null/corrected_null_distribution_proportion.npy

=== COMPUTING CORRECTED P-VALUES ===
  Corrected p-values computation: 4.23 seconds
Corrected null distribution plot saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/corrected_null/corrected_null_distribution.png
CORRECTED P-VALUES TOTAL: 4.52 seconds

=== FINAL RESULTS ===
Best resolution: 0.800
Best CCA score: 0.5046
Number of clusters at best resolution: 13
Number of PCs used: 5
Best visualization used PC1 + PC3
Standard p-value: 0.2860
Corrected p-value: 0.5010
Summary plot saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/summary/summary/resolution_optimization_summary_X_DR_proportion.png
Summary report saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/summary/summary/optimization_results_X_DR_proportion.txt
Detailed results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/summary/summary/detailed_results_X_DR_proportion.csv

All results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/summary/all_resolution_results_proportion.csv
Optimal resolution pseudobulk saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/summary/optimal.h5ad

Final summary saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/FINAL_SUMMARY.txt

[Find Optimal Resolution RNA-seq Linux] Total runtime: 284.79 seconds

PERFORMANCE SUMMARY:
  Setup: 0.0s
  Coarse search: 196.3s (68.9%)
  Fine search: 83.2s (29.2%)
  Corrected p-values: 4.5s (1.6%)
Using PROFILED GPU version of optimal resolution
Directory setup: 0.00 seconds
Starting RNA-seq resolution optimization for X_DR_expression...
Using representation: X_pca with 20 components
Using 10 PCs for CCA analysis
Testing resolutions from 0.01 to 1.00...
Will compute corrected p-values with 1000 simulations per resolution

=== FIRST PASS: Coarse Search ===


Testing resolution: 0.100

  Cell clustering: 1.89 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 4
  Pseudobulk computation: 7.19 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.100: CCA Score = 0.7940 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.5855
PC1 + PC3: CCA score = 0.3827
PC1 + PC4: CCA score = 0.2286
PC1 + PC5: CCA score = 0.2376
PC1 + PC6: CCA score = 0.2621
PC1 + PC7: CCA score = 0.2030
PC1 + PC8: CCA score = 0.2574
PC1 + PC9: CCA score = 0.2017
PC1 + PC10: CCA score = 0.3526
PC2 + PC3: CCA score = 0.6419
PC2 + PC4: CCA score = 0.5638
PC2 + PC5: CCA score = 0.5675
PC2 + PC6: CCA score = 0.5782
PC2 + PC7: CCA score = 0.5539
PC2 + PC8: CCA score = 0.5761
PC2 + PC9: CCA score = 0.5535
PC2 + PC10: CCA score = 0.6245
PC3 + PC4: CCA score = 0.3486
PC3 + PC5: CCA score = 0.3546
PC3 + PC6: CCA score = 0.3714
PC3 + PC7: CCA score = 0.3324
PC3 + PC8: CCA score = 0.3681
PC3 + PC9: CCA score = 0.3316
PC3 + PC10: CCA score = 0.4400
PC4 + PC5: CCA score = 0.1775
PC4 + PC6: CCA score = 0.2092
PC4 + PC7: CCA score = 0.1275
PC4 + PC8: CCA score = 0.2033
PC4 + PC9: CCA score = 0.1255
PC4 + PC10: CCA score = 0.3152
PC5 + PC6: CCA score = 0.2190
PC5 + PC7: CCA score = 0.1431
PC5 + PC8: CCA score = 0.2134
PC5 + PC9: CCA score = 0.1413
PC5 + PC10: CCA score = 0.3218
PC6 + PC7: CCA score = 0.1809
PC6 + PC8: CCA score = 0.2404
PC6 + PC9: CCA score = 0.1795
PC6 + PC10: CCA score = 0.3403
PC7 + PC8: CCA score = 0.1740
PC7 + PC9: CCA score = 0.0686
PC7 + PC10: CCA score = 0.2972
PC8 + PC9: CCA score = 0.1725
PC8 + PC10: CCA score = 0.3367
PC9 + PC10: CCA score = 0.2963
Best combination: PC2 + PC3 with score 0.6419
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.100/cca_plot_res_0.100.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.100/cca_plot_res_0.100_contributions.png
Created CCA visualization plot using PC2 + PC3 (viz score: 0.6419)
  Null distribution (1000 sims): 1.19 seconds
Resolution 0.100: Standard p-value = 0.0430
TOTAL for resolution 0.100: 10.98 seconds


Testing resolution: 0.200

  Cell clustering: 1.93 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 5
  Pseudobulk computation: 8.58 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.200: CCA Score = 0.7136 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.4831
PC1 + PC3: CCA score = 0.4924
PC1 + PC4: CCA score = 0.5533
PC1 + PC5: CCA score = 0.5419
PC1 + PC6: CCA score = 0.4818
PC1 + PC7: CCA score = 0.5678
PC1 + PC8: CCA score = 0.4999
PC1 + PC9: CCA score = 0.4891
PC1 + PC10: CCA score = 0.4871
PC2 + PC3: CCA score = 0.1183
PC2 + PC4: CCA score = 0.2787
PC2 + PC5: CCA score = 0.2554
PC2 + PC6: CCA score = 0.0610
PC2 + PC7: CCA score = 0.3065
PC2 + PC8: CCA score = 0.1466
PC2 + PC9: CCA score = 0.1040
PC2 + PC10: CCA score = 0.0942
PC3 + PC4: CCA score = 0.2945
PC3 + PC5: CCA score = 0.2725
PC3 + PC6: CCA score = 0.1129
PC3 + PC7: CCA score = 0.3209
PC3 + PC8: CCA score = 0.1747
PC3 + PC9: CCA score = 0.1409
PC3 + PC10: CCA score = 0.1338
PC4 + PC5: CCA score = 0.3714
PC4 + PC6: CCA score = 0.2765
PC4 + PC7: CCA score = 0.4083
PC4 + PC8: CCA score = 0.3069
PC4 + PC9: CCA score = 0.2891
PC4 + PC10: CCA score = 0.2857
PC5 + PC6: CCA score = 0.2529
PC5 + PC7: CCA score = 0.3927
PC5 + PC8: CCA score = 0.2859
PC5 + PC9: CCA score = 0.2666
PC5 + PC10: CCA score = 0.2629
PC6 + PC7: CCA score = 0.3045
PC6 + PC8: CCA score = 0.1423
PC6 + PC9: CCA score = 0.0979
PC6 + PC10: CCA score = 0.0873
PC7 + PC8: CCA score = 0.3323
PC7 + PC9: CCA score = 0.3159
PC7 + PC10: CCA score = 0.3128
PC8 + PC9: CCA score = 0.1653
PC8 + PC10: CCA score = 0.1593
PC9 + PC10: CCA score = 0.1213
Best combination: PC1 + PC7 with score 0.5678
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.200/cca_plot_res_0.200.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.200/cca_plot_res_0.200_contributions.png
Created CCA visualization plot using PC1 + PC7 (viz score: 0.5678)
  Null distribution (1000 sims): 1.20 seconds
Resolution 0.200: Standard p-value = 0.2170
TOTAL for resolution 0.200: 12.46 seconds


Testing resolution: 0.300

  Cell clustering: 2.13 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 8
  Pseudobulk computation: 12.29 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.300: CCA Score = 0.7465 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.4668
PC1 + PC3: CCA score = 0.4172
PC1 + PC4: CCA score = 0.5575
PC1 + PC5: CCA score = 0.4889
PC1 + PC6: CCA score = 0.4313
PC1 + PC7: CCA score = 0.4087
PC1 + PC8: CCA score = 0.4993
PC1 + PC9: CCA score = 0.4092
PC1 + PC10: CCA score = 0.4260
PC2 + PC3: CCA score = 0.2408
PC2 + PC4: CCA score = 0.4413
PC2 + PC5: CCA score = 0.3506
PC2 + PC6: CCA score = 0.2644
PC2 + PC7: CCA score = 0.2257
PC2 + PC8: CCA score = 0.3650
PC2 + PC9: CCA score = 0.2267
PC2 + PC10: CCA score = 0.2557
PC3 + PC4: CCA score = 0.3885
PC3 + PC5: CCA score = 0.2813
PC3 + PC6: CCA score = 0.1615
PC3 + PC7: CCA score = 0.0844
PC3 + PC8: CCA score = 0.2990
PC3 + PC9: CCA score = 0.0869
PC3 + PC10: CCA score = 0.1469
PC4 + PC5: CCA score = 0.4647
PC4 + PC6: CCA score = 0.4036
PC4 + PC7: CCA score = 0.3794
PC4 + PC8: CCA score = 0.4756
PC4 + PC9: CCA score = 0.3799
PC4 + PC10: CCA score = 0.3979
PC5 + PC6: CCA score = 0.3017
PC5 + PC7: CCA score = 0.2685
PC5 + PC8: CCA score = 0.3929
PC5 + PC9: CCA score = 0.2693
PC5 + PC10: CCA score = 0.2942
PC6 + PC7: CCA score = 0.1380
PC6 + PC8: CCA score = 0.3183
PC6 + PC9: CCA score = 0.1395
PC6 + PC10: CCA score = 0.1830
PC7 + PC8: CCA score = 0.2870
PC7 + PC9: CCA score = 0.0229
PC7 + PC10: CCA score = 0.1206
PC8 + PC9: CCA score = 0.2878
PC8 + PC10: CCA score = 0.3112
PC9 + PC10: CCA score = 0.1224
Best combination: PC1 + PC4 with score 0.5575
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.300/cca_plot_res_0.300.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.300/cca_plot_res_0.300_contributions.png
Created CCA visualization plot using PC1 + PC4 (viz score: 0.5575)
  Null distribution (1000 sims): 1.18 seconds
Resolution 0.300: Standard p-value = 0.0980
TOTAL for resolution 0.300: 16.32 seconds


Testing resolution: 0.400

  Cell clustering: 2.13 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 9
  Pseudobulk computation: 14.21 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.400: CCA Score = 0.7673 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3703
PC1 + PC3: CCA score = 0.5679
PC1 + PC4: CCA score = 0.3562
PC1 + PC5: CCA score = 0.3700
PC1 + PC6: CCA score = 0.3780
PC1 + PC7: CCA score = 0.4166
PC1 + PC8: CCA score = 0.4155
PC1 + PC9: CCA score = 0.5106
PC1 + PC10: CCA score = 0.3583
PC2 + PC3: CCA score = 0.4544
PC2 + PC4: CCA score = 0.1037
PC2 + PC5: CCA score = 0.1442
PC2 + PC6: CCA score = 0.1637
PC2 + PC7: CCA score = 0.2397
PC2 + PC8: CCA score = 0.2379
PC2 + PC9: CCA score = 0.3803
PC2 + PC10: CCA score = 0.1110
PC3 + PC4: CCA score = 0.4429
PC3 + PC5: CCA score = 0.4541
PC3 + PC6: CCA score = 0.4607
PC3 + PC7: CCA score = 0.4928
PC3 + PC8: CCA score = 0.4919
PC3 + PC9: CCA score = 0.5745
PC3 + PC10: CCA score = 0.4446
PC4 + PC5: CCA score = 0.1025
PC4 + PC6: CCA score = 0.1285
PC4 + PC7: CCA score = 0.2172
PC4 + PC8: CCA score = 0.2152
PC4 + PC9: CCA score = 0.3665
PC4 + PC10: CCA score = 0.0451
PC5 + PC6: CCA score = 0.1630
PC5 + PC7: CCA score = 0.2392
PC5 + PC8: CCA score = 0.2373
PC5 + PC9: CCA score = 0.3799
PC5 + PC10: CCA score = 0.1098
PC6 + PC7: CCA score = 0.2515
PC6 + PC8: CCA score = 0.2497
PC6 + PC9: CCA score = 0.3878
PC6 + PC10: CCA score = 0.1345
PC7 + PC8: CCA score = 0.3050
PC7 + PC9: CCA score = 0.4255
PC7 + PC10: CCA score = 0.2208
PC8 + PC9: CCA score = 0.4244
PC8 + PC10: CCA score = 0.2188
PC9 + PC10: CCA score = 0.3686
Best combination: PC3 + PC9 with score 0.5745
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.400/cca_plot_res_0.400.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.400/cca_plot_res_0.400_contributions.png
Created CCA visualization plot using PC3 + PC9 (viz score: 0.5745)
  Null distribution (1000 sims): 1.19 seconds
Resolution 0.400: Standard p-value = 0.0390
TOTAL for resolution 0.400: 18.26 seconds


Testing resolution: 0.500

  Cell clustering: 2.25 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 10
  Pseudobulk computation: 14.41 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.500: CCA Score = 0.7983 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2879
PC1 + PC3: CCA score = 0.5159
PC1 + PC4: CCA score = 0.3843
PC1 + PC5: CCA score = 0.2868
PC1 + PC6: CCA score = 0.2808
PC1 + PC7: CCA score = 0.4963
PC1 + PC8: CCA score = 0.2330
PC1 + PC9: CCA score = 0.2340
PC1 + PC10: CCA score = 0.2406
PC2 + PC3: CCA score = 0.4905
PC2 + PC4: CCA score = 0.3494
PC2 + PC5: CCA score = 0.2380
PC2 + PC6: CCA score = 0.2308
PC2 + PC7: CCA score = 0.4699
PC2 + PC8: CCA score = 0.1694
PC2 + PC9: CCA score = 0.1708
PC2 + PC10: CCA score = 0.1797
PC3 + PC4: CCA score = 0.5526
PC3 + PC5: CCA score = 0.4899
PC3 + PC6: CCA score = 0.4864
PC3 + PC7: CCA score = 0.6357
PC3 + PC8: CCA score = 0.4604
PC3 + PC9: CCA score = 0.4610
PC3 + PC10: CCA score = 0.4643
PC4 + PC5: CCA score = 0.3485
PC4 + PC6: CCA score = 0.3436
PC4 + PC7: CCA score = 0.5344
PC4 + PC8: CCA score = 0.3058
PC4 + PC9: CCA score = 0.3066
PC4 + PC10: CCA score = 0.3116
PC5 + PC6: CCA score = 0.2294
PC5 + PC7: CCA score = 0.4692
PC5 + PC8: CCA score = 0.1675
PC5 + PC9: CCA score = 0.1690
PC5 + PC10: CCA score = 0.1779
PC6 + PC7: CCA score = 0.4656
PC6 + PC8: CCA score = 0.1571
PC6 + PC9: CCA score = 0.1587
PC6 + PC10: CCA score = 0.1682
PC7 + PC8: CCA score = 0.4384
PC7 + PC9: CCA score = 0.4389
PC7 + PC10: CCA score = 0.4425
PC8 + PC9: CCA score = 0.0248
PC8 + PC10: CCA score = 0.0609
PC9 + PC10: CCA score = 0.0648
Best combination: PC3 + PC7 with score 0.6357
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.500/cca_plot_res_0.500.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.500/cca_plot_res_0.500_contributions.png
Created CCA visualization plot using PC3 + PC7 (viz score: 0.6357)
  Null distribution (1000 sims): 1.19 seconds
Resolution 0.500: Standard p-value = 0.0160
TOTAL for resolution 0.500: 18.63 seconds


Testing resolution: 0.600

  Cell clustering: 2.18 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 12
  Pseudobulk computation: 17.44 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.600: CCA Score = 0.7673 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.4399
PC1 + PC3: CCA score = 0.2743
PC1 + PC4: CCA score = 0.4662
PC1 + PC5: CCA score = 0.4128
PC1 + PC6: CCA score = 0.3185
PC1 + PC7: CCA score = 0.2807
PC1 + PC8: CCA score = 0.3772
PC1 + PC9: CCA score = 0.2859
PC1 + PC10: CCA score = 0.3501
PC2 + PC3: CCA score = 0.3465
PC2 + PC4: CCA score = 0.5121
PC2 + PC5: CCA score = 0.4640
PC2 + PC6: CCA score = 0.3825
PC2 + PC7: CCA score = 0.3516
PC2 + PC8: CCA score = 0.4325
PC2 + PC9: CCA score = 0.3557
PC2 + PC10: CCA score = 0.4091
PC3 + PC4: CCA score = 0.3794
PC3 + PC5: CCA score = 0.3115
PC3 + PC6: CCA score = 0.1675
PC3 + PC7: CCA score = 0.0735
PC3 + PC8: CCA score = 0.2624
PC3 + PC9: CCA score = 0.0911
PC3 + PC10: CCA score = 0.2217
PC4 + PC5: CCA score = 0.4890
PC4 + PC6: CCA score = 0.4125
PC4 + PC7: CCA score = 0.3841
PC4 + PC8: CCA score = 0.4593
PC4 + PC9: CCA score = 0.3879
PC4 + PC10: CCA score = 0.4374
PC5 + PC6: CCA score = 0.3511
PC5 + PC7: CCA score = 0.3172
PC5 + PC8: CCA score = 0.4050
PC5 + PC9: CCA score = 0.3217
PC5 + PC10: CCA score = 0.3799
PC6 + PC7: CCA score = 0.1778
PC6 + PC8: CCA score = 0.3083
PC6 + PC9: CCA score = 0.1858
PC6 + PC10: CCA score = 0.2745
PC7 + PC8: CCA score = 0.2691
PC7 + PC9: CCA score = 0.1090
PC7 + PC10: CCA score = 0.2296
PC8 + PC9: CCA score = 0.2745
PC8 + PC10: CCA score = 0.3408
PC9 + PC10: CCA score = 0.2358
Best combination: PC2 + PC4 with score 0.5121
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.600/cca_plot_res_0.600.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.600/cca_plot_res_0.600_contributions.png
Created CCA visualization plot using PC2 + PC4 (viz score: 0.5121)
  Null distribution (1000 sims): 1.19 seconds
Resolution 0.600: Standard p-value = 0.0640
TOTAL for resolution 0.600: 21.55 seconds


Testing resolution: 0.700

  Cell clustering: 2.12 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 12
  Pseudobulk computation: 17.22 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.700: CCA Score = 0.7215 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.1518
PC1 + PC3: CCA score = 0.1530
PC1 + PC4: CCA score = 0.4097
PC1 + PC5: CCA score = 0.4601
PC1 + PC6: CCA score = 0.1648
PC1 + PC7: CCA score = 0.2630
PC1 + PC8: CCA score = 0.2093
PC1 + PC9: CCA score = 0.3294
PC1 + PC10: CCA score = 0.1488
PC2 + PC3: CCA score = 0.0490
PC2 + PC4: CCA score = 0.3832
PC2 + PC5: CCA score = 0.4367
PC2 + PC6: CCA score = 0.0785
PC2 + PC7: CCA score = 0.2195
PC2 + PC8: CCA score = 0.1509
PC2 + PC9: CCA score = 0.2958
PC2 + PC10: CCA score = 0.0339
PC3 + PC4: CCA score = 0.3837
PC3 + PC5: CCA score = 0.4371
PC3 + PC6: CCA score = 0.0807
PC3 + PC7: CCA score = 0.2203
PC3 + PC8: CCA score = 0.1521
PC3 + PC9: CCA score = 0.2964
PC3 + PC10: CCA score = 0.0388
PC4 + PC5: CCA score = 0.5793
PC4 + PC6: CCA score = 0.3885
PC4 + PC7: CCA score = 0.4393
PC4 + PC8: CCA score = 0.4094
PC4 + PC9: CCA score = 0.4820
PC4 + PC10: CCA score = 0.3820
PC5 + PC6: CCA score = 0.4414
PC5 + PC7: CCA score = 0.4867
PC5 + PC8: CCA score = 0.4598
PC5 + PC9: CCA score = 0.5255
PC5 + PC10: CCA score = 0.4357
PC6 + PC7: CCA score = 0.2286
PC6 + PC8: CCA score = 0.1640
PC6 + PC9: CCA score = 0.3027
PC6 + PC10: CCA score = 0.0725
PC7 + PC8: CCA score = 0.2625
PC7 + PC9: CCA score = 0.3655
PC7 + PC10: CCA score = 0.2174
PC8 + PC9: CCA score = 0.3290
PC8 + PC10: CCA score = 0.1479
PC9 + PC10: CCA score = 0.2943
Best combination: PC4 + PC5 with score 0.5793
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.700/cca_plot_res_0.700.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.700/cca_plot_res_0.700_contributions.png
Created CCA visualization plot using PC4 + PC5 (viz score: 0.5793)
  Null distribution (1000 sims): 1.19 seconds
Resolution 0.700: Standard p-value = 0.1830
TOTAL for resolution 0.700: 21.28 seconds


Testing resolution: 0.800

  Cell clustering: 2.16 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 13
  Pseudobulk computation: 18.55 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.800: CCA Score = 0.7179 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2128
PC1 + PC3: CCA score = 0.2282
PC1 + PC4: CCA score = 0.4047
PC1 + PC5: CCA score = 0.2918
PC1 + PC6: CCA score = 0.4390
PC1 + PC7: CCA score = 0.2140
PC1 + PC8: CCA score = 0.2130
PC1 + PC9: CCA score = 0.3041
PC1 + PC10: CCA score = 0.3936
PC2 + PC3: CCA score = 0.0824
PC2 + PC4: CCA score = 0.3442
PC2 + PC5: CCA score = 0.1996
PC2 + PC6: CCA score = 0.3840
PC2 + PC7: CCA score = 0.0227
PC2 + PC8: CCA score = 0.0098
PC2 + PC9: CCA score = 0.2173
PC2 + PC10: CCA score = 0.3312
PC3 + PC4: CCA score = 0.3540
PC3 + PC5: CCA score = 0.2160
PC3 + PC6: CCA score = 0.3928
PC3 + PC7: CCA score = 0.0854
PC3 + PC8: CCA score = 0.0829
PC3 + PC9: CCA score = 0.2324
PC3 + PC10: CCA score = 0.3413
PC4 + PC5: CCA score = 0.3979
PC4 + PC6: CCA score = 0.5157
PC4 + PC7: CCA score = 0.3450
PC4 + PC8: CCA score = 0.3444
PC4 + PC9: CCA score = 0.4071
PC4 + PC10: CCA score = 0.4777
PC5 + PC6: CCA score = 0.4328
PC5 + PC7: CCA score = 0.2009
PC5 + PC8: CCA score = 0.1999
PC5 + PC9: CCA score = 0.2951
PC5 + PC10: CCA score = 0.3867
PC6 + PC7: CCA score = 0.3847
PC6 + PC8: CCA score = 0.3841
PC6 + PC9: CCA score = 0.4412
PC6 + PC10: CCA score = 0.5071
PC7 + PC8: CCA score = 0.0247
PC7 + PC9: CCA score = 0.2184
PC7 + PC10: CCA score = 0.3320
PC8 + PC9: CCA score = 0.2175
PC8 + PC10: CCA score = 0.3313
PC9 + PC10: CCA score = 0.3961
Best combination: PC4 + PC6 with score 0.5157
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.800/cca_plot_res_0.800.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.800/cca_plot_res_0.800_contributions.png
Created CCA visualization plot using PC4 + PC6 (viz score: 0.5157)
  Null distribution (1000 sims): 1.19 seconds
Resolution 0.800: Standard p-value = 0.1780
TOTAL for resolution 0.800: 22.64 seconds


Testing resolution: 0.900

  Cell clustering: 2.04 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 14
  Pseudobulk computation: 20.21 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.900: CCA Score = 0.7388 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2366
PC1 + PC3: CCA score = 0.2593
PC1 + PC4: CCA score = 0.4365
PC1 + PC5: CCA score = 0.3608
PC1 + PC6: CCA score = 0.3875
PC1 + PC7: CCA score = 0.2579
PC1 + PC8: CCA score = 0.2882
PC1 + PC9: CCA score = 0.4000
PC1 + PC10: CCA score = 0.2660
PC2 + PC3: CCA score = 0.1268
PC2 + PC4: CCA score = 0.3733
PC2 + PC5: CCA score = 0.2811
PC2 + PC6: CCA score = 0.3147
PC2 + PC7: CCA score = 0.1239
PC2 + PC8: CCA score = 0.1785
PC2 + PC9: CCA score = 0.3299
PC2 + PC10: CCA score = 0.1400
PC3 + PC4: CCA score = 0.3881
PC3 + PC5: CCA score = 0.3005
PC3 + PC6: CCA score = 0.3321
PC3 + PC7: CCA score = 0.1631
PC3 + PC8: CCA score = 0.2076
PC3 + PC9: CCA score = 0.3465
PC3 + PC10: CCA score = 0.1756
PC4 + PC5: CCA score = 0.4621
PC4 + PC6: CCA score = 0.4833
PC4 + PC7: CCA score = 0.3872
PC4 + PC8: CCA score = 0.4079
PC4 + PC9: CCA score = 0.4933
PC4 + PC10: CCA score = 0.3926
PC5 + PC6: CCA score = 0.4162
PC5 + PC7: CCA score = 0.2993
PC5 + PC8: CCA score = 0.3257
PC5 + PC9: CCA score = 0.4278
PC5 + PC10: CCA score = 0.3063
PC6 + PC7: CCA score = 0.3310
PC6 + PC8: CCA score = 0.3551
PC6 + PC9: CCA score = 0.4506
PC6 + PC10: CCA score = 0.3373
PC7 + PC8: CCA score = 0.2059
PC7 + PC9: CCA score = 0.3455
PC7 + PC10: CCA score = 0.1736
PC8 + PC9: CCA score = 0.3686
PC8 + PC10: CCA score = 0.2160
PC9 + PC10: CCA score = 0.3516
Best combination: PC4 + PC9 with score 0.4933
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.900/cca_plot_res_0.900.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.900/cca_plot_res_0.900_contributions.png
Created CCA visualization plot using PC4 + PC9 (viz score: 0.4933)
  Null distribution (1000 sims): 1.18 seconds
Resolution 0.900: Standard p-value = 0.1200
TOTAL for resolution 0.900: 24.19 seconds


Testing resolution: 1.000

  Cell clustering: 2.11 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 16
  Pseudobulk computation: 23.48 seconds
  Dimension reduction: 0.01 seconds
Resolution 1.000: CCA Score = 0.7073 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.0940
PC1 + PC3: CCA score = 0.0758
PC1 + PC4: CCA score = 0.1891
PC1 + PC5: CCA score = 0.5731
PC1 + PC6: CCA score = 0.0617
PC1 + PC7: CCA score = 0.2504
PC1 + PC8: CCA score = 0.1048
PC1 + PC9: CCA score = 0.2222
PC1 + PC10: CCA score = 0.0292
PC2 + PC3: CCA score = 0.1142
PC2 + PC4: CCA score = 0.2075
PC2 + PC5: CCA score = 0.5794
PC2 + PC6: CCA score = 0.1053
PC2 + PC7: CCA score = 0.2645
PC2 + PC8: CCA score = 0.1352
PC2 + PC9: CCA score = 0.2380
PC2 + PC10: CCA score = 0.0903
PC3 + PC4: CCA score = 0.1999
PC3 + PC5: CCA score = 0.5768
PC3 + PC6: CCA score = 0.0894
PC3 + PC7: CCA score = 0.2586
PC3 + PC8: CCA score = 0.1232
PC3 + PC9: CCA score = 0.2314
PC3 + PC10: CCA score = 0.0711
PC4 + PC5: CCA score = 0.6022
PC4 + PC6: CCA score = 0.1950
PC4 + PC7: CCA score = 0.3113
PC4 + PC8: CCA score = 0.2126
PC4 + PC9: CCA score = 0.2891
PC4 + PC10: CCA score = 0.1873
PC5 + PC6: CCA score = 0.5751
PC5 + PC7: CCA score = 0.6242
PC5 + PC8: CCA score = 0.5813
PC5 + PC9: CCA score = 0.6134
PC5 + PC10: CCA score = 0.5725
PC6 + PC7: CCA score = 0.2548
PC6 + PC8: CCA score = 0.1151
PC6 + PC9: CCA score = 0.2272
PC6 + PC10: CCA score = 0.0558
PC7 + PC8: CCA score = 0.2686
PC7 + PC9: CCA score = 0.3324
PC7 + PC10: CCA score = 0.2490
PC8 + PC9: CCA score = 0.2425
PC8 + PC10: CCA score = 0.1014
PC9 + PC10: CCA score = 0.2206
Best combination: PC5 + PC7 with score 0.6242
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_1.000/cca_plot_res_1.000.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_1.000/cca_plot_res_1.000_contributions.png
Created CCA visualization plot using PC5 + PC7 (viz score: 0.6242)
  Null distribution (1000 sims): 1.18 seconds
Resolution 1.000: Standard p-value = 0.2410
TOTAL for resolution 1.000: 27.51 seconds

COARSE SEARCH TOTAL: 193.84 seconds

Best resolution from first pass: 0.50
Best CCA score: 0.7983

=== SECOND PASS: Fine-tuned Search ===
Fine-tuning search from 0.48 to 0.52...


Testing resolution: 0.480

  Cell clustering: 1.95 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 9
  Pseudobulk computation: 12.95 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.480: CCA Score = 0.7569 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.4205
PC1 + PC3: CCA score = 0.4051
PC1 + PC4: CCA score = 0.4651
PC1 + PC5: CCA score = 0.5402
PC1 + PC6: CCA score = 0.3921
PC1 + PC7: CCA score = 0.4901
PC1 + PC8: CCA score = 0.4362
PC1 + PC9: CCA score = 0.4343
PC1 + PC10: CCA score = 0.4041
PC2 + PC3: CCA score = 0.1946
PC2 + PC4: CCA score = 0.3001
PC2 + PC5: CCA score = 0.4068
PC2 + PC6: CCA score = 0.1657
PC2 + PC7: CCA score = 0.3376
PC2 + PC8: CCA score = 0.2530
PC2 + PC9: CCA score = 0.2496
PC2 + PC10: CCA score = 0.1924
PC3 + PC4: CCA score = 0.2782
PC3 + PC5: CCA score = 0.3909
PC3 + PC6: CCA score = 0.1215
PC3 + PC7: CCA score = 0.3182
PC3 + PC8: CCA score = 0.2266
PC3 + PC9: CCA score = 0.2228
PC3 + PC10: CCA score = 0.1560
PC4 + PC5: CCA score = 0.4528
PC4 + PC6: CCA score = 0.2588
PC4 + PC7: CCA score = 0.3918
PC4 + PC8: CCA score = 0.3218
PC4 + PC9: CCA score = 0.3191
PC4 + PC10: CCA score = 0.2767
PC5 + PC6: CCA score = 0.3774
PC5 + PC7: CCA score = 0.4784
PC5 + PC8: CCA score = 0.4231
PC5 + PC9: CCA score = 0.4210
PC5 + PC10: CCA score = 0.3899
PC6 + PC7: CCA score = 0.3014
PC6 + PC8: CCA score = 0.2023
PC6 + PC9: CCA score = 0.1980
PC6 + PC10: CCA score = 0.1181
PC7 + PC8: CCA score = 0.3570
PC7 + PC9: CCA score = 0.3545
PC7 + PC10: CCA score = 0.3169
PC8 + PC9: CCA score = 0.2753
PC8 + PC10: CCA score = 0.2248
PC9 + PC10: CCA score = 0.2209
Best combination: PC1 + PC5 with score 0.5402
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.480/cca_plot_res_0.480.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.480/cca_plot_res_0.480_contributions.png
Created CCA visualization plot using PC1 + PC5 (viz score: 0.5402)
  Null distribution (1000 sims): 1.19 seconds
Resolution 0.480: Standard p-value = 0.0540
TOTAL for resolution 0.480: 16.83 seconds


Testing resolution: 0.490

  Cell clustering: 1.99 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 11
  Pseudobulk computation: 16.16 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.490: CCA Score = 0.7988 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3356
PC1 + PC3: CCA score = 0.4055
PC1 + PC4: CCA score = 0.4439
PC1 + PC5: CCA score = 0.4599
PC1 + PC6: CCA score = 0.3403
PC1 + PC7: CCA score = 0.4597
PC1 + PC8: CCA score = 0.4404
PC1 + PC9: CCA score = 0.3322
PC1 + PC10: CCA score = 0.4510
PC2 + PC3: CCA score = 0.2375
PC2 + PC4: CCA score = 0.2984
PC2 + PC5: CCA score = 0.3217
PC2 + PC6: CCA score = 0.0885
PC2 + PC7: CCA score = 0.3215
PC2 + PC8: CCA score = 0.2932
PC2 + PC9: CCA score = 0.0488
PC2 + PC10: CCA score = 0.3089
PC3 + PC4: CCA score = 0.3753
PC3 + PC5: CCA score = 0.3941
PC3 + PC6: CCA score = 0.2442
PC3 + PC7: CCA score = 0.3939
PC3 + PC8: CCA score = 0.3712
PC3 + PC9: CCA score = 0.2328
PC3 + PC10: CCA score = 0.3837
PC4 + PC5: CCA score = 0.4335
PC4 + PC6: CCA score = 0.3037
PC4 + PC7: CCA score = 0.4333
PC4 + PC8: CCA score = 0.4128
PC4 + PC9: CCA score = 0.2946
PC4 + PC10: CCA score = 0.4241
PC5 + PC6: CCA score = 0.3267
PC5 + PC7: CCA score = 0.4497
PC5 + PC8: CCA score = 0.4300
PC5 + PC9: CCA score = 0.3183
PC5 + PC10: CCA score = 0.4408
PC6 + PC7: CCA score = 0.3265
PC6 + PC8: CCA score = 0.2987
PC6 + PC9: CCA score = 0.0749
PC6 + PC10: CCA score = 0.3141
PC7 + PC8: CCA score = 0.4298
PC7 + PC9: CCA score = 0.3180
PC7 + PC10: CCA score = 0.4406
PC8 + PC9: CCA score = 0.2894
PC8 + PC10: CCA score = 0.4205
PC9 + PC10: CCA score = 0.3053
Best combination: PC1 + PC5 with score 0.4599
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.490/cca_plot_res_0.490.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.490/cca_plot_res_0.490_contributions.png
Created CCA visualization plot using PC1 + PC5 (viz score: 0.4599)
  Null distribution (1000 sims): 1.19 seconds
Resolution 0.490: Standard p-value = 0.0120
TOTAL for resolution 0.490: 20.10 seconds


Testing resolution: 0.510

  Cell clustering: 1.99 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 11
  Pseudobulk computation: 16.10 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.510: CCA Score = 0.7967 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3963
PC1 + PC3: CCA score = 0.4471
PC1 + PC4: CCA score = 0.3674
PC1 + PC5: CCA score = 0.5706
PC1 + PC6: CCA score = 0.4159
PC1 + PC7: CCA score = 0.4685
PC1 + PC8: CCA score = 0.3683
PC1 + PC9: CCA score = 0.4811
PC1 + PC10: CCA score = 0.3700
PC2 + PC3: CCA score = 0.2952
PC2 + PC4: CCA score = 0.1490
PC2 + PC5: CCA score = 0.4614
PC2 + PC6: CCA score = 0.2453
PC2 + PC7: CCA score = 0.3267
PC2 + PC8: CCA score = 0.1513
PC2 + PC9: CCA score = 0.3445
PC2 + PC10: CCA score = 0.1553
PC3 + PC4: CCA score = 0.2550
PC3 + PC5: CCA score = 0.5057
PC3 + PC6: CCA score = 0.3210
PC3 + PC7: CCA score = 0.3868
PC3 + PC8: CCA score = 0.2564
PC3 + PC9: CCA score = 0.4019
PC3 + PC10: CCA score = 0.2588
PC4 + PC5: CCA score = 0.4367
PC4 + PC6: CCA score = 0.1951
PC4 + PC7: CCA score = 0.2909
PC4 + PC8: CCA score = 0.0280
PC4 + PC9: CCA score = 0.3108
PC4 + PC10: CCA score = 0.0449
PC5 + PC6: CCA score = 0.4782
PC5 + PC7: CCA score = 0.5247
PC5 + PC8: CCA score = 0.4375
PC5 + PC9: CCA score = 0.5359
PC5 + PC10: CCA score = 0.4389
PC6 + PC7: CCA score = 0.3502
PC6 + PC8: CCA score = 0.1969
PC6 + PC9: CCA score = 0.3668
PC6 + PC10: CCA score = 0.2000
PC7 + PC8: CCA score = 0.2921
PC7 + PC9: CCA score = 0.4256
PC7 + PC10: CCA score = 0.2942
PC8 + PC9: CCA score = 0.3119
PC8 + PC10: CCA score = 0.0520
PC9 + PC10: CCA score = 0.3138
Best combination: PC1 + PC5 with score 0.5706
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.510/cca_plot_res_0.510.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.510/cca_plot_res_0.510_contributions.png
Created CCA visualization plot using PC1 + PC5 (viz score: 0.5706)
  Null distribution (1000 sims): 1.18 seconds
Resolution 0.510: Standard p-value = 0.0290
TOTAL for resolution 0.510: 19.99 seconds


Testing resolution: 0.520

  Cell clustering: 2.00 seconds
  Cell type assignment: 0.00 seconds
Number of clusters: 11
  Pseudobulk computation: 16.09 seconds
  Dimension reduction: 0.00 seconds
Resolution 0.520: CCA Score = 0.7970 (using 10 PCs)
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3926
PC1 + PC3: CCA score = 0.4385
PC1 + PC4: CCA score = 0.3682
PC1 + PC5: CCA score = 0.5674
PC1 + PC6: CCA score = 0.4130
PC1 + PC7: CCA score = 0.4706
PC1 + PC8: CCA score = 0.3674
PC1 + PC9: CCA score = 0.4787
PC1 + PC10: CCA score = 0.3701
PC2 + PC3: CCA score = 0.2845
PC2 + PC4: CCA score = 0.1556
PC2 + PC5: CCA score = 0.4589
PC2 + PC6: CCA score = 0.2433
PC2 + PC7: CCA score = 0.3318
PC2 + PC8: CCA score = 0.1538
PC2 + PC9: CCA score = 0.3432
PC2 + PC10: CCA score = 0.1601
PC3 + PC4: CCA score = 0.2498
PC3 + PC5: CCA score = 0.4988
PC3 + PC6: CCA score = 0.3120
PC3 + PC7: CCA score = 0.3851
PC3 + PC8: CCA score = 0.2486
PC3 + PC9: CCA score = 0.3949
PC3 + PC10: CCA score = 0.2526
PC4 + PC5: CCA score = 0.4383
PC4 + PC6: CCA score = 0.2016
PC4 + PC7: CCA score = 0.3026
PC4 + PC8: CCA score = 0.0714
PC4 + PC9: CCA score = 0.3150
PC4 + PC10: CCA score = 0.0842
PC5 + PC6: CCA score = 0.4765
PC5 + PC7: CCA score = 0.5272
PC5 + PC8: CCA score = 0.4376
PC5 + PC9: CCA score = 0.5345
PC5 + PC10: CCA score = 0.4399
PC6 + PC7: CCA score = 0.3557
PC6 + PC8: CCA score = 0.2002
PC6 + PC9: CCA score = 0.3664
PC6 + PC10: CCA score = 0.2051
PC7 + PC8: CCA score = 0.3016
PC7 + PC9: CCA score = 0.4303
PC7 + PC10: CCA score = 0.3049
PC8 + PC9: CCA score = 0.3141
PC8 + PC10: CCA score = 0.0807
PC9 + PC10: CCA score = 0.3173
Best combination: PC1 + PC5 with score 0.5674
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.520/cca_plot_res_0.520.png
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.520/cca_plot_res_0.520_contributions.png
Created CCA visualization plot using PC1 + PC5 (viz score: 0.5674)
  Null distribution (1000 sims): 1.19 seconds
Resolution 0.520: Standard p-value = 0.0240
TOTAL for resolution 0.520: 20.01 seconds

FINE SEARCH TOTAL: 76.93 seconds

=== GENERATING CORRECTED NULL DISTRIBUTION ===
Accounting for resolution selection bias...
  Corrected null distribution generation: 0.00 seconds
Corrected null distribution saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/corrected_null/corrected_null_distribution_expression.npy

=== COMPUTING CORRECTED P-VALUES ===
  Corrected p-values computation: 4.02 seconds
Corrected null distribution plot saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/corrected_null/corrected_null_distribution.png
CORRECTED P-VALUES TOTAL: 4.29 seconds

=== FINAL RESULTS ===
Best resolution: 0.490
Best CCA score: 0.7988
Number of clusters at best resolution: 11
Number of PCs used: 10
Best visualization used PC1 + PC5
Standard p-value: 0.0120
Corrected p-value: 0.1680
Summary plot saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/summary/summary/resolution_optimization_summary_X_DR_expression.png
Summary report saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/summary/summary/optimization_results_X_DR_expression.txt
Detailed results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/summary/summary/detailed_results_X_DR_expression.csv

All results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/summary/all_resolution_results_expression.csv
Optimal resolution pseudobulk saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/summary/optimal.h5ad

Final summary saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/FINAL_SUMMARY.txt

[Find Optimal Resolution RNA-seq Linux] Total runtime: 275.78 seconds

PERFORMANCE SUMMARY:
  Setup: 0.0s
  Coarse search: 193.8s (70.3%)
  Fine search: 76.9s (27.9%)
  Corrected p-values: 4.3s (1.6%)
[Replace DR] Starting dimension reduction replacement...
[Replace DR] File paths:
  - Optimal expression: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_expression/summary/optimal.h5ad
  - Optimal proportion: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/RNA_resolution_optimization_proportion/summary/optimal.h5ad
  - Pseudobulk sample: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/pseudobulk/pseudobulk_sample.h5ad

[Replace DR] Loading files...
   Optimal expression loaded: (25, 2000)
   Optimal proportion loaded: (25, 2000)
   Pseudobulk sample loaded: (25, 2000)

[Replace DR] Replacing expression dimension reduction results...
   Copied .uns['X_DR_expression'] (shape: (25, 10))
   Copied .uns['X_DR_expression_variance'] (shape: (10,))
   Copied .uns['X_DR_expression_variance_ratio'] (shape: (10,))
   Copied .uns['X_pca_expression_method'] (shape: (25, 10))
   Copied .obsm['X_DR_expression'] (shape: (25, 10))
   Copied .obsm['X_pca_expression_method'] (shape: (25, 10))

[Replace DR] Replacing proportion dimension reduction results...
   Copied .uns['X_DR_proportion'] (shape: (25, 5))
   Copied .uns['X_DR_proportion_variance_ratio'] (shape: (5,))
   Copied .uns['pca_proportion_variance_ratio'] (shape: (5,))
   Copied .obsm['X_DR_proportion'] (shape: (25, 5))
   Copied .obsm['X_pca_proportion'] (shape: (25, 5))

[Replace DR] Saving updated pseudobulk_sample...
  Destination: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/pseudobulk/pseudobulk_sample.h5ad
   Successfully saved (0.5 MB)

[Replace DR] === SUMMARY ===
  Expression DR keys copied: 6
  Proportion DR keys copied: 5
  File updated: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/pseudobulk/pseudobulk_sample.h5ad

Running sample distance: cosine

[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Computing cosine distance using dimension reduction results...
Data type: ATAC (affects DR method prioritization)
Available sample metadata columns: ['study', 'age', 'sex', 'severity', 'batch', 'sev.level', 'predicted_doublet']
Number of samples: 25
Computing sample distances using expression dimension reduction (X_DR_expression)...
Distance check results saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/cosine/expression_DR_distance/distance_check_results_expression_DR_cosine.txt
Score for expression_DR (cosine): 1.073974
Summary updated in /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/summary_sample.csv
Distance check completed for expression_DR: score = 1.073974
Sample distance heatmap saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/cosine/expression_DR_distance/sample_distance_expression_DR_heatmap.pdf
expression_DR-based distance matrix saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/cosine/expression_DR_distance
Computing sample distances using proportion dimension reduction (X_DR_proportion)...
Distance check results saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/cosine/proportion_DR_distance/distance_check_results_proportion_DR_cosine.txt
Score for proportion_DR (cosine): 1.067688
Summary updated in /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/summary_sample.csv
Distance check completed for proportion_DR: score = 1.067688
Sample distance heatmap saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/cosine/proportion_DR_distance/sample_distance_proportion_DR_heatmap.pdf
proportion_DR-based distance matrix saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/cosine/proportion_DR_distance
Sample distance computations completed for: expression_DR, proportion_DR
Distance statistics summary saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/cosine/distance_statistics_summary_cosine.csv

Running sample distance: correlation

[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Computing correlation distance using dimension reduction results...
Data type: ATAC (affects DR method prioritization)
Available sample metadata columns: ['study', 'age', 'sex', 'severity', 'batch', 'sev.level', 'predicted_doublet']
Number of samples: 25
Computing sample distances using expression dimension reduction (X_DR_expression)...
Distance check results saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/correlation/expression_DR_distance/distance_check_results_expression_DR_correlation.txt
Score for expression_DR (correlation): 1.048171
Summary updated in /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/summary_sample.csv
Distance check completed for expression_DR: score = 1.048171
Sample distance heatmap saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/correlation/expression_DR_distance/sample_distance_expression_DR_heatmap.pdf
expression_DR-based distance matrix saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/correlation/expression_DR_distance
Computing sample distances using proportion dimension reduction (X_DR_proportion)...
Distance check results saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/correlation/proportion_DR_distance/distance_check_results_proportion_DR_correlation.txt
Score for proportion_DR (correlation): 1.079515
Summary updated in /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/summary_sample.csv
Distance check completed for proportion_DR: score = 1.079515
Sample distance heatmap saved to /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/correlation/proportion_DR_distance/sample_distance_proportion_DR_heatmap.pdf
proportion_DR-based distance matrix saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/correlation/proportion_DR_distance
Sample distance computations completed for: expression_DR, proportion_DR
Distance statistics summary saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance/correlation/distance_statistics_summary_correlation.csv
Sample distance calculation completed. Results saved in /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/Sample_distance
Starting trajectory analysis...
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42

Processing X_DR_proportion...
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Warning: Only 5 components available, using all of them.
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3438
PC1 + PC3: CCA score = 0.3655
PC1 + PC4: CCA score = 0.3320
PC1 + PC5: CCA score = 0.3425
PC2 + PC3: CCA score = 0.3194
PC2 + PC4: CCA score = 0.2805
PC2 + PC5: CCA score = 0.2928
PC3 + PC4: CCA score = 0.3067
PC3 + PC5: CCA score = 0.3179
PC4 + PC5: CCA score = 0.2789
Best combination: PC1 + PC3 with score 0.3655
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/CCA/pca_10d_cca_proportion.pdf
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/CCA/pca_10d_cca_proportion_contributions.pdf

Processing X_DR_expression...
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3356
PC1 + PC3: CCA score = 0.4055
PC1 + PC4: CCA score = 0.4439
PC1 + PC5: CCA score = 0.4599
PC1 + PC6: CCA score = 0.3403
PC1 + PC7: CCA score = 0.4597
PC1 + PC8: CCA score = 0.4404
PC1 + PC9: CCA score = 0.3322
PC1 + PC10: CCA score = 0.4510
PC2 + PC3: CCA score = 0.2375
PC2 + PC4: CCA score = 0.2984
PC2 + PC5: CCA score = 0.3217
PC2 + PC6: CCA score = 0.0885
PC2 + PC7: CCA score = 0.3215
PC2 + PC8: CCA score = 0.2932
PC2 + PC9: CCA score = 0.0488
PC2 + PC10: CCA score = 0.3089
PC3 + PC4: CCA score = 0.3753
PC3 + PC5: CCA score = 0.3941
PC3 + PC6: CCA score = 0.2442
PC3 + PC7: CCA score = 0.3939
PC3 + PC8: CCA score = 0.3712
PC3 + PC9: CCA score = 0.2328
PC3 + PC10: CCA score = 0.3837
PC4 + PC5: CCA score = 0.4335
PC4 + PC6: CCA score = 0.3037
PC4 + PC7: CCA score = 0.4333
PC4 + PC8: CCA score = 0.4128
PC4 + PC9: CCA score = 0.2946
PC4 + PC10: CCA score = 0.4241
PC5 + PC6: CCA score = 0.3267
PC5 + PC7: CCA score = 0.4497
PC5 + PC8: CCA score = 0.4300
PC5 + PC9: CCA score = 0.3183
PC5 + PC10: CCA score = 0.4408
PC6 + PC7: CCA score = 0.3265
PC6 + PC8: CCA score = 0.2987
PC6 + PC9: CCA score = 0.0749
PC6 + PC10: CCA score = 0.3141
PC7 + PC8: CCA score = 0.4298
PC7 + PC9: CCA score = 0.3180
PC7 + PC10: CCA score = 0.4406
PC8 + PC9: CCA score = 0.2894
PC8 + PC10: CCA score = 0.4205
PC9 + PC10: CCA score = 0.3053
Best combination: PC1 + PC5 with score 0.4599
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/CCA/pca_10d_cca_expression.pdf
Saved CCA contributions plot to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/CCA/pca_10d_cca_expression_contributions.pdf
Saved proportion pseudotime data to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/CCA/pseudotime_proportion.csv
Saved expression pseudotime data to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/rna/CCA/pseudotime_expression.csv

==================================================
CCA ANALYSIS SUMMARY
==================================================
X_DR_proportion: CCA score = 0.3655 (using PC1 + PC3)
X_DR_expression: CCA score = 0.4599 (using PC1 + PC5)

Total runtime: 0.65 seconds
==================================================
P-value for observed correlation 0.3654522023377356: 0.193
[CCA p-test] Runtime: 0.85 seconds
P-value for observed correlation 0.4598956578543063: 0.073
[CCA p-test] Runtime: 0.85 seconds
RNA analysis completed successfully!

 RNA pipeline completed successfully!

============================================================
PIPELINE EXECUTION SUMMARY
============================================================
RNA Pipeline:  PARTIAL
  - preprocessing: 
  - cell_type_cluster: 
  - dimensionality_reduction: 
  - sample_distance_calculation: 
  - trajectory_analysis: 
  - trajectory_dge: 
  - cluster_dge: 
  - visualization: 

Results saved to: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample
Status file: /dcs07/hongkai/data/harry/result/Benchmark_covid/covid_25_sample/sys_log/main_process_status.json
Execution time: 574.0141 seconds
