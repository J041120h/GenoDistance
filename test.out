======================================
 Job ID:            19389581
 Job Name:          test
 Partition:         gpu
 Node List:         compute-123
 CPUs per Task:     16
 Memory Alloc:      409600
 GPU Requested:     1
 Start Time:        Tue Jul  1 02:16:45 PM EDT 2025
======================================
Checking GPU status...
Tue Jul  1 14:16:46 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 555.42.06              Driver Version: 555.42.06      CUDA Version: 12.5     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100S-PCIE-32GB          Off |   00000000:3B:00.0 Off |                    0 |
| N/A   47C    P0             41W /  250W |       1MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Starting main.py...
Start of Process

Resuming process from previous progress:
{
    "preprocessing": true,
    "cell_type_cluster": true,
    "sample_distance_calculation": true,
    "DimensionalityReduction": true,
    "trajectory_analysis": true,
    "visualize_data": true,
    "initialization": false
}
Linux system detected.


Enabling managed memory for RMM...


Processing X_DR_proportion...

The CCA score for X_DR_proportion is 0.4255

Saved CCA plot to: /dcl01/hongkai/data/data/hjiang/result/CCA/pca_2d_cca_proportion.pdf
Processing X_DR_expression...

The CCA score for X_DR_expression is 0.7044

Saved CCA plot to: /dcl01/hongkai/data/data/hjiang/result/CCA/pca_2d_cca_expression.pdf
CCA analysis completed.

[CCA] Total runtime: 0.91 seconds

🚀 Using PROFILED GPU version of optimal resolution
⏱️  Directory setup: 0.02 seconds

📊 Starting RNA-seq resolution optimization with detailed timing...
Using representation: X_pca with 20 components
Will compute corrected p-values with 1000 simulations per resolution

🔍 === FIRST PASS: Coarse Search ===

🎯 Testing resolution: 0.10
  ⏱️  Cleanup: 0.037 seconds
⏱️    🧬 Cell clustering: 35.78 seconds
⏱️    📋 Cell type assignment: 0.06 seconds
  📊 Number of clusters: 6
⏱️    🧪 Pseudobulk computation: 8106.15 seconds
⏱️    📐 Dimension reduction: 0.28 seconds

The CCA score for X_DR_proportion is 0.4365

  ⏱️  CCA analysis: 0.003 seconds
  🎯 CCA Score = 0.4365
Saved CCA plot to: /dcl01/hongkai/data/data/hjiang/result/RNA_resolution_optimization_X_DR_proportion/resolutions/resolution_0.10/cca_plot_res_0.10.png
  ⏱️  CCA plot generation: 0.588 seconds
⏱️    🎲 Null distribution (1000 sims): 2.73 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0000
  ⏱️  TOTAL for resolution 0.10: 8145.63 seconds

🎯 Testing resolution: 0.20
  ⏱️  Cleanup: 0.031 seconds
⏱️    🧬 Cell clustering: 31.55 seconds
⏱️    📋 Cell type assignment: 0.06 seconds
  📊 Number of clusters: 5
⏱️    🧪 Pseudobulk computation: 7010.36 seconds
⏱️    📐 Dimension reduction: 0.27 seconds

The CCA score for X_DR_proportion is 0.4360

  ⏱️  CCA analysis: 0.012 seconds
  🎯 CCA Score = 0.4360
Saved CCA plot to: /dcl01/hongkai/data/data/hjiang/result/RNA_resolution_optimization_X_DR_proportion/resolutions/resolution_0.20/cca_plot_res_0.20.png
  ⏱️  CCA plot generation: 0.589 seconds
⏱️    🎲 Null distribution (1000 sims): 2.69 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0000
  ⏱️  TOTAL for resolution 0.20: 7045.58 seconds

🎯 Testing resolution: 0.30
  ⏱️  Cleanup: 0.029 seconds
⏱️    🧬 Cell clustering: 31.77 seconds
⏱️    📋 Cell type assignment: 0.06 seconds
  📊 Number of clusters: 6
⏱️    🧪 Pseudobulk computation: 7946.46 seconds
⏱️    📐 Dimension reduction: 0.25 seconds

The CCA score for X_DR_proportion is 0.4365

  ⏱️  CCA analysis: 0.003 seconds
  🎯 CCA Score = 0.4365
Saved CCA plot to: /dcl01/hongkai/data/data/hjiang/result/RNA_resolution_optimization_X_DR_proportion/resolutions/resolution_0.30/cca_plot_res_0.30.png
  ⏱️  CCA plot generation: 0.575 seconds
⏱️    🎲 Null distribution (1000 sims): 2.69 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0000
  ⏱️  TOTAL for resolution 0.30: 7981.85 seconds

🎯 Testing resolution: 0.40
  ⏱️  Cleanup: 0.027 seconds
⏱️    🧬 Cell clustering: 31.66 seconds
⏱️    📋 Cell type assignment: 0.05 seconds
  📊 Number of clusters: 11
⏱️    🧪 Pseudobulk computation: 14210.94 seconds
⏱️    📐 Dimension reduction: 0.22 seconds

The CCA score for X_DR_proportion is 0.4468

  ⏱️  CCA analysis: 0.011 seconds
  🎯 CCA Score = 0.4468
Saved CCA plot to: /dcl01/hongkai/data/data/hjiang/result/RNA_resolution_optimization_X_DR_proportion/resolutions/resolution_0.40/cca_plot_res_0.40.png
  ⏱️  CCA plot generation: 0.576 seconds
⏱️    🎲 Null distribution (1000 sims): 2.77 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0000
  ⏱️  TOTAL for resolution 0.40: 14246.28 seconds

🎯 Testing resolution: 0.50
  ⏱️  Cleanup: 0.029 seconds
⏱️    🧬 Cell clustering: 31.80 seconds
⏱️    📋 Cell type assignment: 0.05 seconds
  📊 Number of clusters: 13
⏱️    🧪 Pseudobulk computation: 16320.89 seconds
⏱️    📐 Dimension reduction: 0.35 seconds

The CCA score for X_DR_proportion is 0.4466

  ⏱️  CCA analysis: 0.002 seconds
  🎯 CCA Score = 0.4466
Saved CCA plot to: /dcl01/hongkai/data/data/hjiang/result/RNA_resolution_optimization_X_DR_proportion/resolutions/resolution_0.50/cca_plot_res_0.50.png
  ⏱️  CCA plot generation: 0.526 seconds
⏱️    🎲 Null distribution (1000 sims): 2.80 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0000
  ⏱️  TOTAL for resolution 0.50: 16356.47 seconds

🎯 Testing resolution: 0.60
  ⏱️  Cleanup: 0.029 seconds
⏱️    🧬 Cell clustering: 32.03 seconds
⏱️    📋 Cell type assignment: 0.05 seconds
  📊 Number of clusters: 15
