================================================================================
DIRECT HDF5 PROCESSING (Most Robust)
================================================================================

ðŸ“‚ Processing: /dcs07/hongkai/data/harry/result/Benchmark/multiomics/preprocess/atac_rna_integrated.h5ad
   Batch size: 100
   Subsample ratio: 0.01

ðŸ“Š Loading metadata...
   HDF5 keys: ['X', 'layers', 'obs', 'obsm', 'obsp', 'uns', 'var', 'varm', 'varp']
   RNA cells: 430595
   ATAC cells: 430595

ðŸ”— Found 430177 paired cells
   Subsampled to 4301 cells

ðŸ“ˆ Processing paired cells in batches...
   Data is stored as sparse CSR matrix
   Loading full sparse matrix (this may take time)...

âœ… Processed 4301 paired cells
   Computed 4301 cell correlations

ðŸ“ˆ Computing per-gene correlations (sampling)...

ðŸŽ¨ Creating visualizations...

ðŸ’¾ Saving results...

================================================================================
SUMMARY
================================================================================
Paired cells: 4301
Processed cells: 4301
Cell correlations: 4301
Mean cell correlation: 0.6508
Mean gene correlation (sampled): 0.0680

Results saved to: /dcs07/hongkai/data/harry/result/Benchmark/pseudo_expression
