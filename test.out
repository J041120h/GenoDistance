Linux system detected with GPU enabled.
Resuming process from previous progress:
{
    "rna": {
        "preprocessing": true,
        "cell_type_cluster": true,
        "dimensionality_reduction": true,
        "sample_distance_calculation": true,
        "trajectory_analysis": true,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": true
    },
    "atac": {
        "preprocessing": false,
        "cell_type_cluster": false,
        "dimensionality_reduction": false,
        "sample_distance_calculation": false,
        "trajectory_analysis": false,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "multiomics": {
        "glue_integration": false,
        "glue_preprocessing": false,
        "glue_training": false,
        "glue_gene_activity": false,
        "glue_cell_types": false,
        "glue_visualization": false,
        "integration_preprocessing": false,
        "dimensionality_reduction": false,
        "embedding_visualization": false,
        "optimal_resolution": false
    },
    "system_info": {
        "platform": "Linux",
        "python_version": "3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]",
        "use_gpu": true,
        "linux_system": true
    }
}

============================================================
RUNNING RNA PIPELINE
============================================================
Starting RNA wrapper function with provided parameters...
Reading Pseudobulk from provided or default path: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/pseudobulk/pseudobulk_sample.h5ad
Starting trajectory analysis...

Processing X_DR_proportion...
Using default PC1 + PC2: CCA score = 0.3385
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/CCA/pca_2d_cca_proportion.pdf

Processing X_DR_expression...
Using default PC1 + PC2: CCA score = 0.2846
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/CCA/pca_2d_cca_expression.pdf

==================================================
CCA ANALYSIS SUMMARY
==================================================
X_DR_proportion: CCA score = 0.3385 (using PC1 + PC2)
X_DR_expression: CCA score = 0.2846 (using PC1 + PC2)

Total runtime: 0.50 seconds
==================================================
P-value for observed correlation 0.3385494285008946: 0.258
[CCA p-test] Runtime: 0.93 seconds
P-value for observed correlation 0.28460172986647997: 0.4
[CCA p-test] Runtime: 0.92 seconds
🚀 Using PROFILED GPU version of optimal resolution WITH TIMEOUT PROTECTION
⏰ Timeout per resolution: 3600 seconds (1.0 hours)
⏱️  Directory setup: 0.00 seconds

📊 Starting RNA-seq resolution optimization with detailed timing...
Using representation: X_pca with 20 components
Using 10 PCs for CCA analysis
Will compute corrected p-values with 1000 simulations per resolution

🔍 === FIRST PASS: Coarse Search ===

🎯 Testing resolution: 0.100
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 2.55 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 4
⏱️    🧪 Pseudobulk computation: 7.80 seconds
⏱️    📐 Dimension reduction: 0.18 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.3599 (using 4 PCs)
Auto-selecting best 2-PC combination from 4 components...
Testing 6 PC combinations...
PC1 + PC2: CCA score = 0.3146
PC1 + PC3: CCA score = 0.3405
PC1 + PC4: CCA score = 0.2795
PC2 + PC3: CCA score = 0.2338
PC2 + PC4: CCA score = 0.1553
PC3 + PC4: CCA score = 0.1998
Best combination: PC1 + PC3 with score 0.3405
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.100/cca_plot_res_0.100.png
  ⏱️  CCA plot generation: 0.386 seconds
  📊 Created CCA visualization using PC1 + PC3 (viz score: 0.3405)
⏱️    🎲 Null distribution (1000 sims): 1.35 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.5910
  ⏱️  TOTAL for resolution 0.100: 12.26 seconds

🎯 Testing resolution: 0.200
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 1.55 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 6
⏱️    🧪 Pseudobulk computation: 10.97 seconds
⏱️    📐 Dimension reduction: 0.06 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.5296 (using 6 PCs)
Auto-selecting best 2-PC combination from 6 components...
Testing 15 PC combinations...
PC1 + PC2: CCA score = 0.3060
PC1 + PC3: CCA score = 0.3085
PC1 + PC4: CCA score = 0.4206
PC1 + PC5: CCA score = 0.3614
PC1 + PC6: CCA score = 0.3149
PC2 + PC3: CCA score = 0.1419
PC2 + PC4: CCA score = 0.3068
PC2 + PC5: CCA score = 0.2563
PC2 + PC6: CCA score = 0.1104
PC3 + PC4: CCA score = 0.3169
PC3 + PC5: CCA score = 0.2623
PC3 + PC6: CCA score = 0.1046
PC4 + PC5: CCA score = 0.4308
PC4 + PC6: CCA score = 0.3114
PC5 + PC6: CCA score = 0.2595
Best combination: PC4 + PC5 with score 0.4308
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.200/cca_plot_res_0.200.png
  ⏱️  CCA plot generation: 0.409 seconds
  📊 Created CCA visualization using PC4 + PC5 (viz score: 0.4308)
⏱️    🎲 Null distribution (1000 sims): 1.36 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.3610
  ⏱️  TOTAL for resolution 0.200: 14.36 seconds

🎯 Testing resolution: 0.300
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.53 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 6
⏱️    🧪 Pseudobulk computation: 10.90 seconds
⏱️    📐 Dimension reduction: 0.05 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.5312 (using 6 PCs)
Auto-selecting best 2-PC combination from 6 components...
Testing 15 PC combinations...
PC1 + PC2: CCA score = 0.3137
PC1 + PC3: CCA score = 0.3246
PC1 + PC4: CCA score = 0.4102
PC1 + PC5: CCA score = 0.4593
PC1 + PC6: CCA score = 0.3062
PC2 + PC3: CCA score = 0.1385
PC2 + PC4: CCA score = 0.2789
PC2 + PC5: CCA score = 0.3452
PC2 + PC6: CCA score = 0.0828
PC3 + PC4: CCA score = 0.3287
PC3 + PC5: CCA score = 0.3386
PC3 + PC6: CCA score = 0.1252
PC4 + PC5: CCA score = 0.4053
PC4 + PC6: CCA score = 0.2757
PC5 + PC6: CCA score = 0.3294
Best combination: PC1 + PC5 with score 0.4593
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.300/cca_plot_res_0.300.png
  ⏱️  CCA plot generation: 0.391 seconds
  📊 Created CCA visualization using PC1 + PC5 (viz score: 0.4593)
⏱️    🎲 Null distribution (1000 sims): 1.34 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.3590
  ⏱️  TOTAL for resolution 0.300: 14.22 seconds

🎯 Testing resolution: 0.400
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.54 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 8
⏱️    🧪 Pseudobulk computation: 14.22 seconds
⏱️    📐 Dimension reduction: 0.05 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7659 (using 8 PCs)
Auto-selecting best 2-PC combination from 8 components...
Testing 28 PC combinations...
PC1 + PC2: CCA score = 0.3205
PC1 + PC3: CCA score = 0.4037
PC1 + PC4: CCA score = 0.4818
PC1 + PC5: CCA score = 0.4068
PC1 + PC6: CCA score = 0.3169
PC1 + PC7: CCA score = 0.5759
PC1 + PC8: CCA score = 0.3395
PC2 + PC3: CCA score = 0.2675
PC2 + PC4: CCA score = 0.3896
PC2 + PC5: CCA score = 0.3317
PC2 + PC6: CCA score = 0.0710
PC2 + PC7: CCA score = 0.4715
PC2 + PC8: CCA score = 0.1166
PC3 + PC4: CCA score = 0.4558
PC3 + PC5: CCA score = 0.4037
PC3 + PC6: CCA score = 0.2606
PC3 + PC7: CCA score = 0.5199
PC3 + PC8: CCA score = 0.2805
PC4 + PC5: CCA score = 0.5705
PC4 + PC6: CCA score = 0.3934
PC4 + PC7: CCA score = 0.5988
PC4 + PC8: CCA score = 0.4086
PC5 + PC6: CCA score = 0.3355
PC5 + PC7: CCA score = 0.5112
PC5 + PC8: CCA score = 0.3721
PC6 + PC7: CCA score = 0.4657
PC6 + PC8: CCA score = 0.1092
PC7 + PC8: CCA score = 0.4797
Best combination: PC4 + PC7 with score 0.5988
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.400/cca_plot_res_0.400.png
  ⏱️  CCA plot generation: 0.401 seconds
  📊 Created CCA visualization using PC4 + PC7 (viz score: 0.5988)
⏱️    🎲 Null distribution (1000 sims): 1.37 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0280
  ⏱️  TOTAL for resolution 0.400: 17.59 seconds

🎯 Testing resolution: 0.500
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.54 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 11
⏱️    🧪 Pseudobulk computation: 17.36 seconds
⏱️    📐 Dimension reduction: 0.06 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7579 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3383
PC1 + PC3: CCA score = 0.4408
PC1 + PC4: CCA score = 0.3785
PC1 + PC5: CCA score = 0.3253
PC1 + PC6: CCA score = 0.3271
PC1 + PC7: CCA score = 0.3308
PC1 + PC8: CCA score = 0.5249
PC1 + PC9: CCA score = 0.4571
PC1 + PC10: CCA score = 0.3978
PC2 + PC3: CCA score = 0.3331
PC2 + PC4: CCA score = 0.2317
PC2 + PC5: CCA score = 0.1416
PC2 + PC6: CCA score = 0.1678
PC2 + PC7: CCA score = 0.1417
PC2 + PC8: CCA score = 0.4188
PC2 + PC9: CCA score = 0.3877
PC2 + PC10: CCA score = 0.2437
PC3 + PC4: CCA score = 0.3975
PC3 + PC5: CCA score = 0.3132
PC3 + PC6: CCA score = 0.3226
PC3 + PC7: CCA score = 0.3227
PC3 + PC8: CCA score = 0.4935
PC3 + PC9: CCA score = 0.4600
PC3 + PC10: CCA score = 0.3775
PC4 + PC5: CCA score = 0.2390
PC4 + PC6: CCA score = 0.2745
PC4 + PC7: CCA score = 0.2427
PC4 + PC8: CCA score = 0.4526
PC4 + PC9: CCA score = 0.3957
PC4 + PC10: CCA score = 0.3104
PC5 + PC6: CCA score = 0.1829
PC5 + PC7: CCA score = 0.0964
PC5 + PC8: CCA score = 0.4038
PC5 + PC9: CCA score = 0.3624
PC5 + PC10: CCA score = 0.2354
PC6 + PC7: CCA score = 0.1367
PC6 + PC8: CCA score = 0.4106
PC6 + PC9: CCA score = 0.3490
PC6 + PC10: CCA score = 0.2449
PC7 + PC8: CCA score = 0.4092
PC7 + PC9: CCA score = 0.3496
PC7 + PC10: CCA score = 0.2262
PC8 + PC9: CCA score = 0.4952
PC8 + PC10: CCA score = 0.4622
PC9 + PC10: CCA score = 0.3780
Best combination: PC1 + PC8 with score 0.5249
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.500/cca_plot_res_0.500.png
  ⏱️  CCA plot generation: 0.411 seconds
  📊 Created CCA visualization using PC1 + PC8 (viz score: 0.5249)
⏱️    🎲 Null distribution (1000 sims): 1.38 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.1190
  ⏱️  TOTAL for resolution 0.500: 20.75 seconds

🎯 Testing resolution: 0.600
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.52 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 11
⏱️    🧪 Pseudobulk computation: 17.41 seconds
⏱️    📐 Dimension reduction: 0.05 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7580 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3385
PC1 + PC3: CCA score = 0.4365
PC1 + PC4: CCA score = 0.3914
PC1 + PC5: CCA score = 0.3285
PC1 + PC6: CCA score = 0.3232
PC1 + PC7: CCA score = 0.3244
PC1 + PC8: CCA score = 0.5494
PC1 + PC9: CCA score = 0.4650
PC1 + PC10: CCA score = 0.3893
PC2 + PC3: CCA score = 0.3199
PC2 + PC4: CCA score = 0.2465
PC2 + PC5: CCA score = 0.1435
PC2 + PC6: CCA score = 0.1449
PC2 + PC7: CCA score = 0.1245
PC2 + PC8: CCA score = 0.4384
PC2 + PC9: CCA score = 0.3968
PC2 + PC10: CCA score = 0.2249
PC3 + PC4: CCA score = 0.3966
PC3 + PC5: CCA score = 0.3034
PC3 + PC6: CCA score = 0.3029
PC3 + PC7: CCA score = 0.3024
PC3 + PC8: CCA score = 0.5044
PC3 + PC9: CCA score = 0.4640
PC3 + PC10: CCA score = 0.3587
PC4 + PC5: CCA score = 0.2746
PC4 + PC6: CCA score = 0.2557
PC4 + PC7: CCA score = 0.2586
PC4 + PC8: CCA score = 0.4829
PC4 + PC9: CCA score = 0.4200
PC4 + PC10: CCA score = 0.3179
PC5 + PC6: CCA score = 0.1668
PC5 + PC7: CCA score = 0.1043
PC5 + PC8: CCA score = 0.4292
PC5 + PC9: CCA score = 0.3696
PC5 + PC10: CCA score = 0.2246
PC6 + PC7: CCA score = 0.1018
PC6 + PC8: CCA score = 0.4238
PC6 + PC9: CCA score = 0.3638
PC6 + PC10: CCA score = 0.2145
PC7 + PC8: CCA score = 0.4243
PC7 + PC9: CCA score = 0.3603
PC7 + PC10: CCA score = 0.2032
PC8 + PC9: CCA score = 0.5129
PC8 + PC10: CCA score = 0.4787
PC9 + PC10: CCA score = 0.3786
Best combination: PC1 + PC8 with score 0.5494
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.600/cca_plot_res_0.600.png
  ⏱️  CCA plot generation: 0.409 seconds
  📊 Created CCA visualization using PC1 + PC8 (viz score: 0.5494)
⏱️    🎲 Null distribution (1000 sims): 1.36 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.1270
  ⏱️  TOTAL for resolution 0.600: 20.75 seconds

🎯 Testing resolution: 0.700
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.55 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 13
⏱️    🧪 Pseudobulk computation: 19.36 seconds
⏱️    📐 Dimension reduction: 0.06 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7595 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3275
PC1 + PC3: CCA score = 0.4229
PC1 + PC4: CCA score = 0.3406
PC1 + PC5: CCA score = 0.3307
PC1 + PC6: CCA score = 0.3228
PC1 + PC7: CCA score = 0.3108
PC1 + PC8: CCA score = 0.3527
PC1 + PC9: CCA score = 0.5685
PC1 + PC10: CCA score = 0.4313
PC2 + PC3: CCA score = 0.3231
PC2 + PC4: CCA score = 0.1803
PC2 + PC5: CCA score = 0.1967
PC2 + PC6: CCA score = 0.1719
PC2 + PC7: CCA score = 0.1306
PC2 + PC8: CCA score = 0.1723
PC2 + PC9: CCA score = 0.4976
PC2 + PC10: CCA score = 0.2963
PC3 + PC4: CCA score = 0.3480
PC3 + PC5: CCA score = 0.3356
PC3 + PC6: CCA score = 0.3110
PC3 + PC7: CCA score = 0.2991
PC3 + PC8: CCA score = 0.3084
PC3 + PC9: CCA score = 0.5521
PC3 + PC10: CCA score = 0.4044
PC4 + PC5: CCA score = 0.1782
PC4 + PC6: CCA score = 0.1684
PC4 + PC7: CCA score = 0.1533
PC4 + PC8: CCA score = 0.2026
PC4 + PC9: CCA score = 0.5064
PC4 + PC10: CCA score = 0.3425
PC5 + PC6: CCA score = 0.1635
PC5 + PC7: CCA score = 0.1474
PC5 + PC8: CCA score = 0.1816
PC5 + PC9: CCA score = 0.4966
PC5 + PC10: CCA score = 0.2906
PC6 + PC7: CCA score = 0.1120
PC6 + PC8: CCA score = 0.1501
PC6 + PC9: CCA score = 0.4959
PC6 + PC10: CCA score = 0.2951
PC7 + PC8: CCA score = 0.1260
PC7 + PC9: CCA score = 0.4768
PC7 + PC10: CCA score = 0.2767
PC8 + PC9: CCA score = 0.4816
PC8 + PC10: CCA score = 0.3223
PC9 + PC10: CCA score = 0.5334
Best combination: PC1 + PC9 with score 0.5685
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.700/cca_plot_res_0.700.png
  ⏱️  CCA plot generation: 0.410 seconds
  📊 Created CCA visualization using PC1 + PC9 (viz score: 0.5685)
⏱️    🎲 Null distribution (1000 sims): 1.37 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.1270
  ⏱️  TOTAL for resolution 0.700: 22.75 seconds

🎯 Testing resolution: 0.800
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.54 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 14
⏱️    🧪 Pseudobulk computation: 21.38 seconds
⏱️    📐 Dimension reduction: 0.06 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.8108 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3027
PC1 + PC3: CCA score = 0.4351
PC1 + PC4: CCA score = 0.3508
PC1 + PC5: CCA score = 0.3244
PC1 + PC6: CCA score = 0.2833
PC1 + PC7: CCA score = 0.2810
PC1 + PC8: CCA score = 0.3048
PC1 + PC9: CCA score = 0.6080
PC1 + PC10: CCA score = 0.3922
PC2 + PC3: CCA score = 0.3697
PC2 + PC4: CCA score = 0.2332
PC2 + PC5: CCA score = 0.2244
PC2 + PC6: CCA score = 0.1221
PC2 + PC7: CCA score = 0.1236
PC2 + PC8: CCA score = 0.1414
PC2 + PC9: CCA score = 0.5500
PC2 + PC10: CCA score = 0.2697
PC3 + PC4: CCA score = 0.4162
PC3 + PC5: CCA score = 0.3882
PC3 + PC6: CCA score = 0.3490
PC3 + PC7: CCA score = 0.3523
PC3 + PC8: CCA score = 0.3502
PC3 + PC9: CCA score = 0.6318
PC3 + PC10: CCA score = 0.4243
PC4 + PC5: CCA score = 0.2432
PC4 + PC6: CCA score = 0.2238
PC4 + PC7: CCA score = 0.2328
PC4 + PC8: CCA score = 0.2442
PC4 + PC9: CCA score = 0.5928
PC4 + PC10: CCA score = 0.3562
PC5 + PC6: CCA score = 0.1785
PC5 + PC7: CCA score = 0.1759
PC5 + PC8: CCA score = 0.1822
PC5 + PC9: CCA score = 0.5708
PC5 + PC10: CCA score = 0.2774
PC6 + PC7: CCA score = 0.0282
PC6 + PC8: CCA score = 0.0849
PC6 + PC9: CCA score = 0.5337
PC6 + PC10: CCA score = 0.2474
PC7 + PC8: CCA score = 0.0855
PC7 + PC9: CCA score = 0.5341
PC7 + PC10: CCA score = 0.2470
PC8 + PC9: CCA score = 0.5469
PC8 + PC10: CCA score = 0.2738
PC9 + PC10: CCA score = 0.5802
Best combination: PC3 + PC9 with score 0.6318
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.800/cca_plot_res_0.800.png
  ⏱️  CCA plot generation: 0.416 seconds
  📊 Created CCA visualization using PC3 + PC9 (viz score: 0.6318)
⏱️    🎲 Null distribution (1000 sims): 1.37 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0520
  ⏱️  TOTAL for resolution 0.800: 24.77 seconds

🎯 Testing resolution: 0.900
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.72 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 13
⏱️    🧪 Pseudobulk computation: 20.20 seconds
⏱️    📐 Dimension reduction: 0.07 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7691 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3087
PC1 + PC3: CCA score = 0.3836
PC1 + PC4: CCA score = 0.3755
PC1 + PC5: CCA score = 0.3106
PC1 + PC6: CCA score = 0.2971
PC1 + PC7: CCA score = 0.3056
PC1 + PC8: CCA score = 0.3091
PC1 + PC9: CCA score = 0.5454
PC1 + PC10: CCA score = 0.4540
PC2 + PC3: CCA score = 0.2647
PC2 + PC4: CCA score = 0.2425
PC2 + PC5: CCA score = 0.1792
PC2 + PC6: CCA score = 0.1415
PC2 + PC7: CCA score = 0.1493
PC2 + PC8: CCA score = 0.1354
PC2 + PC9: CCA score = 0.4604
PC2 + PC10: CCA score = 0.3326
PC3 + PC4: CCA score = 0.3139
PC3 + PC5: CCA score = 0.2868
PC3 + PC6: CCA score = 0.2361
PC3 + PC7: CCA score = 0.2547
PC3 + PC8: CCA score = 0.2457
PC3 + PC9: CCA score = 0.4872
PC3 + PC10: CCA score = 0.3915
PC4 + PC5: CCA score = 0.2443
PC4 + PC6: CCA score = 0.2651
PC4 + PC7: CCA score = 0.2422
PC4 + PC8: CCA score = 0.2525
PC4 + PC9: CCA score = 0.5267
PC4 + PC10: CCA score = 0.4259
PC5 + PC6: CCA score = 0.1375
PC5 + PC7: CCA score = 0.1570
PC5 + PC8: CCA score = 0.1433
PC5 + PC9: CCA score = 0.4785
PC5 + PC10: CCA score = 0.3305
PC6 + PC7: CCA score = 0.1329
PC6 + PC8: CCA score = 0.1107
PC6 + PC9: CCA score = 0.4557
PC6 + PC10: CCA score = 0.3217
PC7 + PC8: CCA score = 0.1210
PC7 + PC9: CCA score = 0.4426
PC7 + PC10: CCA score = 0.3293
PC8 + PC9: CCA score = 0.4420
PC8 + PC10: CCA score = 0.3761
PC9 + PC10: CCA score = 0.5219
Best combination: PC1 + PC9 with score 0.5454
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.900/cca_plot_res_0.900.png
  ⏱️  CCA plot generation: 0.409 seconds
  📊 Created CCA visualization using PC1 + PC9 (viz score: 0.5454)
⏱️    🎲 Null distribution (1000 sims): 1.38 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.1170
  ⏱️  TOTAL for resolution 0.900: 23.78 seconds

🎯 Testing resolution: 1.000
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 1.57 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 15
⏱️    🧪 Pseudobulk computation: 24.03 seconds
⏱️    📐 Dimension reduction: 0.06 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7758 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3055
PC1 + PC3: CCA score = 0.4273
PC1 + PC4: CCA score = 0.4006
PC1 + PC5: CCA score = 0.3188
PC1 + PC6: CCA score = 0.3061
PC1 + PC7: CCA score = 0.3197
PC1 + PC8: CCA score = 0.4821
PC1 + PC9: CCA score = 0.5018
PC1 + PC10: CCA score = 0.4188
PC2 + PC3: CCA score = 0.3389
PC2 + PC4: CCA score = 0.2852
PC2 + PC5: CCA score = 0.1743
PC2 + PC6: CCA score = 0.1210
PC2 + PC7: CCA score = 0.1916
PC2 + PC8: CCA score = 0.3550
PC2 + PC9: CCA score = 0.4390
PC2 + PC10: CCA score = 0.2957
PC3 + PC4: CCA score = 0.4182
PC3 + PC5: CCA score = 0.3613
PC3 + PC6: CCA score = 0.3329
PC3 + PC7: CCA score = 0.3610
PC3 + PC8: CCA score = 0.4520
PC3 + PC9: CCA score = 0.5613
PC3 + PC10: CCA score = 0.4232
PC4 + PC5: CCA score = 0.2880
PC4 + PC6: CCA score = 0.2847
PC4 + PC7: CCA score = 0.3444
PC4 + PC8: CCA score = 0.4310
PC4 + PC9: CCA score = 0.4939
PC4 + PC10: CCA score = 0.4329
PC5 + PC6: CCA score = 0.1570
PC5 + PC7: CCA score = 0.1945
PC5 + PC8: CCA score = 0.3613
PC5 + PC9: CCA score = 0.4452
PC5 + PC10: CCA score = 0.3259
PC6 + PC7: CCA score = 0.1801
PC6 + PC8: CCA score = 0.3539
PC6 + PC9: CCA score = 0.4333
PC6 + PC10: CCA score = 0.2876
PC7 + PC8: CCA score = 0.3732
PC7 + PC9: CCA score = 0.4697
PC7 + PC10: CCA score = 0.3150
PC8 + PC9: CCA score = 0.5036
PC8 + PC10: CCA score = 0.4704
PC9 + PC10: CCA score = 0.4947
Best combination: PC3 + PC9 with score 0.5613
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_1.000/cca_plot_res_1.000.png
  ⏱️  CCA plot generation: 0.416 seconds
  📊 Created CCA visualization using PC3 + PC9 (viz score: 0.5613)
⏱️    🎲 Null distribution (1000 sims): 1.37 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0960
  ⏱️  TOTAL for resolution 1.000: 27.45 seconds

⏱️  COARSE SEARCH TOTAL: 198.69 seconds

🏆 Best resolution from first pass: 0.80
🎯 Best CCA score: 0.8108

🔬 === SECOND PASS: Fine-tuned Search ===
Fine-tuning search from 0.78 to 0.82...

🎯 Testing resolution: 0.780
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.56 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 14
⏱️    🧪 Pseudobulk computation: 21.22 seconds
⏱️    📐 Dimension reduction: 0.06 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7508 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3054
PC1 + PC3: CCA score = 0.3821
PC1 + PC4: CCA score = 0.3714
PC1 + PC5: CCA score = 0.3407
PC1 + PC6: CCA score = 0.2983
PC1 + PC7: CCA score = 0.3424
PC1 + PC8: CCA score = 0.2951
PC1 + PC9: CCA score = 0.5277
PC1 + PC10: CCA score = 0.3919
PC2 + PC3: CCA score = 0.2643
PC2 + PC4: CCA score = 0.2389
PC2 + PC5: CCA score = 0.2436
PC2 + PC6: CCA score = 0.1532
PC2 + PC7: CCA score = 0.2067
PC2 + PC8: CCA score = 0.1157
PC2 + PC9: CCA score = 0.4467
PC2 + PC10: CCA score = 0.2533
PC3 + PC4: CCA score = 0.3170
PC3 + PC5: CCA score = 0.3289
PC3 + PC6: CCA score = 0.2427
PC3 + PC7: CCA score = 0.2895
PC3 + PC8: CCA score = 0.2363
PC3 + PC9: CCA score = 0.4840
PC3 + PC10: CCA score = 0.3289
PC4 + PC5: CCA score = 0.2689
PC4 + PC6: CCA score = 0.2710
PC4 + PC7: CCA score = 0.2728
PC4 + PC8: CCA score = 0.2402
PC4 + PC9: CCA score = 0.5128
PC4 + PC10: CCA score = 0.3512
PC5 + PC6: CCA score = 0.2029
PC5 + PC7: CCA score = 0.2513
PC5 + PC8: CCA score = 0.1994
PC5 + PC9: CCA score = 0.4816
PC5 + PC10: CCA score = 0.2844
PC6 + PC7: CCA score = 0.2090
PC6 + PC8: CCA score = 0.1108
PC6 + PC9: CCA score = 0.4450
PC6 + PC10: CCA score = 0.2491
PC7 + PC8: CCA score = 0.1778
PC7 + PC9: CCA score = 0.4611
PC7 + PC10: CCA score = 0.2950
PC8 + PC9: CCA score = 0.4410
PC8 + PC10: CCA score = 0.2553
PC9 + PC10: CCA score = 0.4907
Best combination: PC1 + PC9 with score 0.5277
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.780/cca_plot_res_0.780.png
  ⏱️  CCA plot generation: 0.408 seconds
  📊 Created CCA visualization using PC1 + PC9 (viz score: 0.5277)
⏱️    🎲 Null distribution (1000 sims): 1.37 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.1400
  ⏱️  TOTAL for resolution 0.780: 24.63 seconds

🎯 Testing resolution: 0.790
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.53 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 14
⏱️    🧪 Pseudobulk computation: 21.31 seconds
⏱️    📐 Dimension reduction: 0.06 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7966 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3029
PC1 + PC3: CCA score = 0.4329
PC1 + PC4: CCA score = 0.3627
PC1 + PC5: CCA score = 0.3364
PC1 + PC6: CCA score = 0.2834
PC1 + PC7: CCA score = 0.2816
PC1 + PC8: CCA score = 0.3118
PC1 + PC9: CCA score = 0.5635
PC1 + PC10: CCA score = 0.4201
PC2 + PC3: CCA score = 0.3677
PC2 + PC4: CCA score = 0.2499
PC2 + PC5: CCA score = 0.2435
PC2 + PC6: CCA score = 0.1224
PC2 + PC7: CCA score = 0.1222
PC2 + PC8: CCA score = 0.1544
PC2 + PC9: CCA score = 0.5054
PC2 + PC10: CCA score = 0.3032
PC3 + PC4: CCA score = 0.4190
PC3 + PC5: CCA score = 0.3992
PC3 + PC6: CCA score = 0.3460
PC3 + PC7: CCA score = 0.3474
PC3 + PC8: CCA score = 0.3492
PC3 + PC9: CCA score = 0.5917
PC3 + PC10: CCA score = 0.4420
PC4 + PC5: CCA score = 0.2682
PC4 + PC6: CCA score = 0.2437
PC4 + PC7: CCA score = 0.2471
PC4 + PC8: CCA score = 0.2736
PC4 + PC9: CCA score = 0.5607
PC4 + PC10: CCA score = 0.3990
PC5 + PC6: CCA score = 0.2010
PC5 + PC7: CCA score = 0.1974
PC5 + PC8: CCA score = 0.2108
PC5 + PC9: CCA score = 0.5392
PC5 + PC10: CCA score = 0.3168
PC6 + PC7: CCA score = 0.0200
PC6 + PC8: CCA score = 0.1076
PC6 + PC9: CCA score = 0.4867
PC6 + PC10: CCA score = 0.2847
PC7 + PC8: CCA score = 0.1062
PC7 + PC9: CCA score = 0.4872
PC7 + PC10: CCA score = 0.2848
PC8 + PC9: CCA score = 0.5050
PC8 + PC10: CCA score = 0.3190
PC9 + PC10: CCA score = 0.5523
Best combination: PC3 + PC9 with score 0.5917
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.790/cca_plot_res_0.790.png
  ⏱️  CCA plot generation: 0.423 seconds
  📊 Created CCA visualization using PC3 + PC9 (viz score: 0.5917)
⏱️    🎲 Null distribution (1000 sims): 1.37 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0660
  ⏱️  TOTAL for resolution 0.790: 24.70 seconds

🎯 Testing resolution: 0.810
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.57 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 13
⏱️    🧪 Pseudobulk computation: 20.49 seconds
⏱️    📐 Dimension reduction: 0.07 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7904 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3056
PC1 + PC3: CCA score = 0.4309
PC1 + PC4: CCA score = 0.3586
PC1 + PC5: CCA score = 0.3411
PC1 + PC6: CCA score = 0.2848
PC1 + PC7: CCA score = 0.3170
PC1 + PC8: CCA score = 0.3051
PC1 + PC9: CCA score = 0.5490
PC1 + PC10: CCA score = 0.4108
PC2 + PC3: CCA score = 0.3630
PC2 + PC4: CCA score = 0.2384
PC2 + PC5: CCA score = 0.2497
PC2 + PC6: CCA score = 0.1246
PC2 + PC7: CCA score = 0.1738
PC2 + PC8: CCA score = 0.1380
PC2 + PC9: CCA score = 0.4853
PC2 + PC10: CCA score = 0.2945
PC3 + PC4: CCA score = 0.4116
PC3 + PC5: CCA score = 0.3987
PC3 + PC6: CCA score = 0.3414
PC3 + PC7: CCA score = 0.3543
PC3 + PC8: CCA score = 0.3416
PC3 + PC9: CCA score = 0.5778
PC3 + PC10: CCA score = 0.4323
PC4 + PC5: CCA score = 0.2640
PC4 + PC6: CCA score = 0.2325
PC4 + PC7: CCA score = 0.2377
PC4 + PC8: CCA score = 0.2500
PC4 + PC9: CCA score = 0.5424
PC4 + PC10: CCA score = 0.3853
PC5 + PC6: CCA score = 0.2055
PC5 + PC7: CCA score = 0.2298
PC5 + PC8: CCA score = 0.2073
PC5 + PC9: CCA score = 0.5248
PC5 + PC10: CCA score = 0.3123
PC6 + PC7: CCA score = 0.1178
PC6 + PC8: CCA score = 0.0797
PC6 + PC9: CCA score = 0.4655
PC6 + PC10: CCA score = 0.2763
PC7 + PC8: CCA score = 0.1439
PC7 + PC9: CCA score = 0.4723
PC7 + PC10: CCA score = 0.3013
PC8 + PC9: CCA score = 0.4765
PC8 + PC10: CCA score = 0.2999
PC9 + PC10: CCA score = 0.5336
Best combination: PC3 + PC9 with score 0.5778
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.810/cca_plot_res_0.810.png
  ⏱️  CCA plot generation: 0.419 seconds
  📊 Created CCA visualization using PC3 + PC9 (viz score: 0.5778)
⏱️    🎲 Null distribution (1000 sims): 1.37 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0750
  ⏱️  TOTAL for resolution 0.810: 23.94 seconds

🎯 Testing resolution: 0.820
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.52 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 12
⏱️    🧪 Pseudobulk computation: 19.74 seconds
⏱️    📐 Dimension reduction: 0.07 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7826 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3067
PC1 + PC3: CCA score = 0.4309
PC1 + PC4: CCA score = 0.3611
PC1 + PC5: CCA score = 0.3445
PC1 + PC6: CCA score = 0.2881
PC1 + PC7: CCA score = 0.3205
PC1 + PC8: CCA score = 0.2980
PC1 + PC9: CCA score = 0.5373
PC1 + PC10: CCA score = 0.4250
PC2 + PC3: CCA score = 0.3550
PC2 + PC4: CCA score = 0.2386
PC2 + PC5: CCA score = 0.2360
PC2 + PC6: CCA score = 0.1260
PC2 + PC7: CCA score = 0.1715
PC2 + PC8: CCA score = 0.1163
PC2 + PC9: CCA score = 0.4710
PC2 + PC10: CCA score = 0.3013
PC3 + PC4: CCA score = 0.4139
PC3 + PC5: CCA score = 0.3795
PC3 + PC6: CCA score = 0.3401
PC3 + PC7: CCA score = 0.3500
PC3 + PC8: CCA score = 0.3373
PC3 + PC9: CCA score = 0.5646
PC3 + PC10: CCA score = 0.4383
PC4 + PC5: CCA score = 0.2625
PC4 + PC6: CCA score = 0.2390
PC4 + PC7: CCA score = 0.2380
PC4 + PC8: CCA score = 0.2413
PC4 + PC9: CCA score = 0.5314
PC4 + PC10: CCA score = 0.3880
PC5 + PC6: CCA score = 0.1888
PC5 + PC7: CCA score = 0.2280
PC5 + PC8: CCA score = 0.1884
PC5 + PC9: CCA score = 0.5205
PC5 + PC10: CCA score = 0.3128
PC6 + PC7: CCA score = 0.1265
PC6 + PC8: CCA score = 0.0638
PC6 + PC9: CCA score = 0.4548
PC6 + PC10: CCA score = 0.2908
PC7 + PC8: CCA score = 0.1277
PC7 + PC9: CCA score = 0.4603
PC7 + PC10: CCA score = 0.3141
PC8 + PC9: CCA score = 0.4565
PC8 + PC10: CCA score = 0.2997
PC9 + PC10: CCA score = 0.5255
Best combination: PC3 + PC9 with score 0.5646
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.820/cca_plot_res_0.820.png
  ⏱️  CCA plot generation: 0.416 seconds
  📊 Created CCA visualization using PC3 + PC9 (viz score: 0.5646)
⏱️    🎲 Null distribution (1000 sims): 1.38 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0920
  ⏱️  TOTAL for resolution 0.820: 23.13 seconds

⏱️  FINE SEARCH TOTAL: 96.39 seconds

🔧 === GENERATING CORRECTED NULL DISTRIBUTION ===
⏱️  📊 Corrected null distribution generation: 0.00 seconds
⏱️  Saving corrected null: 0.001 seconds

📊 === COMPUTING CORRECTED P-VALUES ===
⏱️  📈 Corrected p-values computation: 3.87 seconds
⏱️  Corrected null visualization: 0.266 seconds
⏱️  CORRECTED P-VALUES TOTAL: 4.14 seconds

🏆 === FINAL RESULTS ===
🎯 Best resolution: 0.800
📊 Best CCA score: 0.8108
🧬 Number of clusters: 14
📐 Number of PCs used: 10
📊 Best visualization used PC3 + PC9
📈 Standard p-value: 0.0520
📊 Corrected p-value: 0.3610
⏱️  Final processing: 0.017 seconds

🚀 [PROFILED Find Optimal Resolution RNA-seq] TOTAL RUNTIME: 299.23 seconds

📊 PERFORMANCE SUMMARY:
  🔧 Setup: 0.0s
  🔍 Coarse search: 198.7s (66.4%)
  🔬 Fine search: 96.4s (32.2%)
  📊 Corrected p-values: 4.1s (1.4%)
  📝 Final processing: 0.0s
🚀 Using PROFILED GPU version of optimal resolution WITH TIMEOUT PROTECTION
⏰ Timeout per resolution: 3600 seconds (1.0 hours)
⏱️  Directory setup: 0.00 seconds

📊 Starting RNA-seq resolution optimization with detailed timing...
Using representation: X_pca with 20 components
Using 10 PCs for CCA analysis
Will compute corrected p-values with 1000 simulations per resolution

🔍 === FIRST PASS: Coarse Search ===

🎯 Testing resolution: 0.100
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.57 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 4
⏱️    🧪 Pseudobulk computation: 7.93 seconds
⏱️    📐 Dimension reduction: 0.12 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7519 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.6502
PC1 + PC3: CCA score = 0.2890
PC1 + PC4: CCA score = 0.1937
PC1 + PC5: CCA score = 0.2997
PC1 + PC6: CCA score = 0.1950
PC1 + PC7: CCA score = 0.2050
PC1 + PC8: CCA score = 0.1923
PC1 + PC9: CCA score = 0.2555
PC1 + PC10: CCA score = 0.1892
PC2 + PC3: CCA score = 0.6593
PC2 + PC4: CCA score = 0.6234
PC2 + PC5: CCA score = 0.6641
PC2 + PC6: CCA score = 0.6238
PC2 + PC7: CCA score = 0.6270
PC2 + PC8: CCA score = 0.6230
PC2 + PC9: CCA score = 0.6453
PC2 + PC10: CCA score = 0.6221
PC3 + PC4: CCA score = 0.2224
PC3 + PC5: CCA score = 0.3190
PC3 + PC6: CCA score = 0.2235
PC3 + PC7: CCA score = 0.2323
PC3 + PC8: CCA score = 0.2212
PC3 + PC9: CCA score = 0.2779
PC3 + PC10: CCA score = 0.2185
PC4 + PC5: CCA score = 0.2361
PC4 + PC6: CCA score = 0.0627
PC4 + PC7: CCA score = 0.0891
PC4 + PC8: CCA score = 0.0540
PC4 + PC9: CCA score = 0.1766
PC4 + PC10: CCA score = 0.0416
PC5 + PC6: CCA score = 0.2372
PC5 + PC7: CCA score = 0.2455
PC5 + PC8: CCA score = 0.2350
PC5 + PC9: CCA score = 0.2890
PC5 + PC10: CCA score = 0.2325
PC6 + PC7: CCA score = 0.0919
PC6 + PC8: CCA score = 0.0584
PC6 + PC9: CCA score = 0.1780
PC6 + PC10: CCA score = 0.0472
PC7 + PC8: CCA score = 0.0862
PC7 + PC9: CCA score = 0.1889
PC7 + PC10: CCA score = 0.0790
PC8 + PC9: CCA score = 0.1751
PC8 + PC10: CCA score = 0.0348
PC9 + PC10: CCA score = 0.1717
Best combination: PC2 + PC5 with score 0.6641
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.100/cca_plot_res_0.100.png
  ⏱️  CCA plot generation: 0.381 seconds
  📊 Created CCA visualization using PC2 + PC5 (viz score: 0.6641)
⏱️    🎲 Null distribution (1000 sims): 1.39 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.1160
  ⏱️  TOTAL for resolution 0.100: 11.40 seconds

🎯 Testing resolution: 0.200
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.55 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 6
⏱️    🧪 Pseudobulk computation: 11.32 seconds
⏱️    📐 Dimension reduction: 0.06 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7534 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.4781
PC1 + PC3: CCA score = 0.4063
PC1 + PC4: CCA score = 0.4934
PC1 + PC5: CCA score = 0.4289
PC1 + PC6: CCA score = 0.4694
PC1 + PC7: CCA score = 0.3935
PC1 + PC8: CCA score = 0.3969
PC1 + PC9: CCA score = 0.4509
PC1 + PC10: CCA score = 0.3762
PC2 + PC3: CCA score = 0.3330
PC2 + PC4: CCA score = 0.4352
PC2 + PC5: CCA score = 0.3603
PC2 + PC6: CCA score = 0.4077
PC2 + PC7: CCA score = 0.3173
PC2 + PC8: CCA score = 0.3215
PC2 + PC9: CCA score = 0.3862
PC2 + PC10: CCA score = 0.2956
PC3 + PC4: CCA score = 0.3547
PC3 + PC5: CCA score = 0.2574
PC3 + PC6: CCA score = 0.3204
PC3 + PC7: CCA score = 0.1927
PC3 + PC8: CCA score = 0.1995
PC3 + PC9: CCA score = 0.2926
PC3 + PC10: CCA score = 0.1543
PC4 + PC5: CCA score = 0.3804
PC4 + PC6: CCA score = 0.4256
PC4 + PC7: CCA score = 0.3400
PC4 + PC8: CCA score = 0.3439
PC4 + PC9: CCA score = 0.4050
PC4 + PC10: CCA score = 0.3198
PC5 + PC6: CCA score = 0.3486
PC5 + PC7: CCA score = 0.2367
PC5 + PC8: CCA score = 0.2423
PC5 + PC9: CCA score = 0.3233
PC5 + PC10: CCA score = 0.2066
PC6 + PC7: CCA score = 0.3041
PC6 + PC8: CCA score = 0.3084
PC6 + PC9: CCA score = 0.3754
PC6 + PC10: CCA score = 0.2813
PC7 + PC8: CCA score = 0.1721
PC7 + PC9: CCA score = 0.2746
PC7 + PC10: CCA score = 0.1166
PC8 + PC9: CCA score = 0.2794
PC8 + PC10: CCA score = 0.1276
PC9 + PC10: CCA score = 0.2492
Best combination: PC1 + PC4 with score 0.4934
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.200/cca_plot_res_0.200.png
  ⏱️  CCA plot generation: 0.413 seconds
  📊 Created CCA visualization using PC1 + PC4 (viz score: 0.4934)
⏱️    🎲 Null distribution (1000 sims): 1.39 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.1030
  ⏱️  TOTAL for resolution 0.200: 14.73 seconds

🎯 Testing resolution: 0.300
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.53 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 6
⏱️    🧪 Pseudobulk computation: 11.23 seconds
⏱️    📐 Dimension reduction: 0.05 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7932 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.4263
PC1 + PC3: CCA score = 0.3805
PC1 + PC4: CCA score = 0.4410
PC1 + PC5: CCA score = 0.2983
PC1 + PC6: CCA score = 0.1775
PC1 + PC7: CCA score = 0.1770
PC1 + PC8: CCA score = 0.2566
PC1 + PC9: CCA score = 0.1669
PC1 + PC10: CCA score = 0.2888
PC2 + PC3: CCA score = 0.5209
PC2 + PC4: CCA score = 0.5666
PC2 + PC5: CCA score = 0.4643
PC2 + PC6: CCA score = 0.3975
PC2 + PC7: CCA score = 0.3973
PC2 + PC8: CCA score = 0.4386
PC2 + PC9: CCA score = 0.3929
PC2 + PC10: CCA score = 0.4582
PC3 + PC4: CCA score = 0.5330
PC3 + PC5: CCA score = 0.4226
PC3 + PC6: CCA score = 0.3480
PC3 + PC7: CCA score = 0.3477
PC3 + PC8: CCA score = 0.3943
PC3 + PC9: CCA score = 0.3427
PC3 + PC10: CCA score = 0.4160
PC4 + PC5: CCA score = 0.4778
PC4 + PC6: CCA score = 0.4133
PC4 + PC7: CCA score = 0.4130
PC4 + PC8: CCA score = 0.4529
PC4 + PC9: CCA score = 0.4088
PC4 + PC10: CCA score = 0.4719
PC5 + PC6: CCA score = 0.2555
PC5 + PC7: CCA score = 0.2551
PC5 + PC8: CCA score = 0.3156
PC5 + PC9: CCA score = 0.2483
PC5 + PC10: CCA score = 0.3423
PC6 + PC7: CCA score = 0.0872
PC6 + PC8: CCA score = 0.2053
PC6 + PC9: CCA score = 0.0644
PC6 + PC10: CCA score = 0.2443
PC7 + PC8: CCA score = 0.2048
PC7 + PC9: CCA score = 0.0629
PC7 + PC10: CCA score = 0.2440
PC8 + PC9: CCA score = 0.1962
PC8 + PC10: CCA score = 0.3067
PC9 + PC10: CCA score = 0.2368
Best combination: PC2 + PC4 with score 0.5666
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.300/cca_plot_res_0.300.png
  ⏱️  CCA plot generation: 0.412 seconds
  📊 Created CCA visualization using PC2 + PC4 (viz score: 0.5666)
⏱️    🎲 Null distribution (1000 sims): 1.38 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0450
  ⏱️  TOTAL for resolution 0.300: 14.60 seconds

🎯 Testing resolution: 0.400
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.52 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 9
⏱️    🧪 Pseudobulk computation: 15.26 seconds
⏱️    📐 Dimension reduction: 0.08 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7905 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2189
PC1 + PC3: CCA score = 0.5322
PC1 + PC4: CCA score = 0.4008
PC1 + PC5: CCA score = 0.3080
PC1 + PC6: CCA score = 0.3564
PC1 + PC7: CCA score = 0.3328
PC1 + PC8: CCA score = 0.2629
PC1 + PC9: CCA score = 0.2318
PC1 + PC10: CCA score = 0.2311
PC2 + PC3: CCA score = 0.4870
PC2 + PC4: CCA score = 0.3385
PC2 + PC5: CCA score = 0.2210
PC2 + PC6: CCA score = 0.2846
PC2 + PC7: CCA score = 0.2544
PC2 + PC8: CCA score = 0.1519
PC2 + PC9: CCA score = 0.0877
PC2 + PC10: CCA score = 0.0860
PC3 + PC4: CCA score = 0.5915
PC3 + PC5: CCA score = 0.5330
PC3 + PC6: CCA score = 0.5624
PC3 + PC7: CCA score = 0.5477
PC3 + PC8: CCA score = 0.5083
PC3 + PC9: CCA score = 0.4929
PC3 + PC10: CCA score = 0.4926
PC4 + PC5: CCA score = 0.4019
PC4 + PC6: CCA score = 0.4401
PC4 + PC7: CCA score = 0.4212
PC4 + PC8: CCA score = 0.3685
PC4 + PC9: CCA score = 0.3470
PC4 + PC10: CCA score = 0.3466
PC5 + PC6: CCA score = 0.3577
PC5 + PC7: CCA score = 0.3342
PC5 + PC8: CCA score = 0.2646
PC5 + PC9: CCA score = 0.2337
PC5 + PC10: CCA score = 0.2331
PC6 + PC7: CCA score = 0.3793
PC6 + PC8: CCA score = 0.3197
PC6 + PC9: CCA score = 0.2946
PC6 + PC10: CCA score = 0.2941
PC7 + PC8: CCA score = 0.2931
PC7 + PC9: CCA score = 0.2656
PC7 + PC10: CCA score = 0.2650
PC8 + PC9: CCA score = 0.1699
PC8 + PC10: CCA score = 0.1691
PC9 + PC10: CCA score = 0.1149
Best combination: PC3 + PC4 with score 0.5915
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.400/cca_plot_res_0.400.png
  ⏱️  CCA plot generation: 0.408 seconds
  📊 Created CCA visualization using PC3 + PC4 (viz score: 0.5915)
⏱️    🎲 Null distribution (1000 sims): 1.38 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0340
  ⏱️  TOTAL for resolution 0.400: 18.66 seconds

🎯 Testing resolution: 0.500
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.54 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 11
⏱️    🧪 Pseudobulk computation: 17.86 seconds
⏱️    📐 Dimension reduction: 0.06 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7659 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2851
PC1 + PC3: CCA score = 0.3521
PC1 + PC4: CCA score = 0.3720
PC1 + PC5: CCA score = 0.3037
PC1 + PC6: CCA score = 0.3445
PC1 + PC7: CCA score = 0.5435
PC1 + PC8: CCA score = 0.4326
PC1 + PC9: CCA score = 0.3108
PC1 + PC10: CCA score = 0.2890
PC2 + PC3: CCA score = 0.2183
PC2 + PC4: CCA score = 0.2491
PC2 + PC5: CCA score = 0.1261
PC2 + PC6: CCA score = 0.2058
PC2 + PC7: CCA score = 0.4680
PC2 + PC8: CCA score = 0.3329
PC2 + PC9: CCA score = 0.1423
PC2 + PC10: CCA score = 0.0849
PC3 + PC4: CCA score = 0.3236
PC3 + PC5: CCA score = 0.2420
PC3 + PC6: CCA score = 0.2915
PC3 + PC7: CCA score = 0.5116
PC3 + PC8: CCA score = 0.3917
PC3 + PC9: CCA score = 0.2508
PC3 + PC10: CCA score = 0.2233
PC4 + PC5: CCA score = 0.2701
PC4 + PC6: CCA score = 0.3153
PC4 + PC7: CCA score = 0.5255
PC4 + PC8: CCA score = 0.4097
PC4 + PC9: CCA score = 0.2781
PC4 + PC10: CCA score = 0.2536
PC5 + PC6: CCA score = 0.2308
PC5 + PC7: CCA score = 0.4795
PC5 + PC8: CCA score = 0.3489
PC5 + PC9: CCA score = 0.1765
PC5 + PC10: CCA score = 0.1346
PC6 + PC7: CCA score = 0.5064
PC6 + PC8: CCA score = 0.3849
PC6 + PC9: CCA score = 0.2400
PC6 + PC10: CCA score = 0.2111
PC7 + PC8: CCA score = 0.5699
PC7 + PC9: CCA score = 0.4840
PC7 + PC10: CCA score = 0.4704
PC8 + PC9: CCA score = 0.3551
PC8 + PC10: CCA score = 0.3362
PC9 + PC10: CCA score = 0.1499
Best combination: PC7 + PC8 with score 0.5699
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.500/cca_plot_res_0.500.png
  ⏱️  CCA plot generation: 0.390 seconds
  📊 Created CCA visualization using PC7 + PC8 (viz score: 0.5699)
⏱️    🎲 Null distribution (1000 sims): 1.38 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0650
  ⏱️  TOTAL for resolution 0.500: 21.23 seconds

🎯 Testing resolution: 0.600
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.52 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 11
⏱️    🧪 Pseudobulk computation: 17.92 seconds
⏱️    📐 Dimension reduction: 0.05 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7616 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2846
PC1 + PC3: CCA score = 0.3778
PC1 + PC4: CCA score = 0.3616
PC1 + PC5: CCA score = 0.3313
PC1 + PC6: CCA score = 0.3673
PC1 + PC7: CCA score = 0.5073
PC1 + PC8: CCA score = 0.4436
PC1 + PC9: CCA score = 0.2968
PC1 + PC10: CCA score = 0.2854
PC2 + PC3: CCA score = 0.2510
PC2 + PC4: CCA score = 0.2260
PC2 + PC5: CCA score = 0.1733
PC2 + PC6: CCA score = 0.2349
PC2 + PC7: CCA score = 0.4215
PC2 + PC8: CCA score = 0.3422
PC2 + PC9: CCA score = 0.0916
PC2 + PC10: CCA score = 0.0415
PC3 + PC4: CCA score = 0.3358
PC3 + PC5: CCA score = 0.3029
PC3 + PC6: CCA score = 0.3419
PC3 + PC7: CCA score = 0.4893
PC3 + PC8: CCA score = 0.4229
PC3 + PC9: CCA score = 0.2648
PC3 + PC10: CCA score = 0.2519
PC4 + PC5: CCA score = 0.2825
PC4 + PC6: CCA score = 0.3240
PC4 + PC7: CCA score = 0.4769
PC4 + PC8: CCA score = 0.4085
PC4 + PC9: CCA score = 0.2411
PC4 + PC10: CCA score = 0.2269
PC5 + PC6: CCA score = 0.2897
PC5 + PC7: CCA score = 0.4543
PC5 + PC8: CCA score = 0.3819
PC5 + PC9: CCA score = 0.1927
PC5 + PC10: CCA score = 0.1745
PC6 + PC7: CCA score = 0.4812
PC6 + PC8: CCA score = 0.4135
PC6 + PC9: CCA score = 0.2496
PC6 + PC10: CCA score = 0.2358
PC7 + PC8: CCA score = 0.5418
PC7 + PC9: CCA score = 0.4299
PC7 + PC10: CCA score = 0.4220
PC8 + PC9: CCA score = 0.3524
PC8 + PC10: CCA score = 0.3428
PC9 + PC10: CCA score = 0.0939
Best combination: PC7 + PC8 with score 0.5418
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.600/cca_plot_res_0.600.png
  ⏱️  CCA plot generation: 0.390 seconds
  📊 Created CCA visualization using PC7 + PC8 (viz score: 0.5418)
⏱️    🎲 Null distribution (1000 sims): 1.37 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0830
  ⏱️  TOTAL for resolution 0.600: 21.26 seconds

🎯 Testing resolution: 0.700
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.56 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 13
⏱️    🧪 Pseudobulk computation: 19.96 seconds
⏱️    📐 Dimension reduction: 0.06 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7727 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3087
PC1 + PC3: CCA score = 0.2582
PC1 + PC4: CCA score = 0.4171
PC1 + PC5: CCA score = 0.3983
PC1 + PC6: CCA score = 0.2419
PC1 + PC7: CCA score = 0.4678
PC1 + PC8: CCA score = 0.2258
PC1 + PC9: CCA score = 0.2143
PC1 + PC10: CCA score = 0.3088
PC2 + PC3: CCA score = 0.2649
PC2 + PC4: CCA score = 0.4213
PC2 + PC5: CCA score = 0.4027
PC2 + PC6: CCA score = 0.2491
PC2 + PC7: CCA score = 0.4716
PC2 + PC8: CCA score = 0.2334
PC2 + PC9: CCA score = 0.2224
PC2 + PC10: CCA score = 0.3144
PC3 + PC4: CCA score = 0.3858
PC3 + PC5: CCA score = 0.3654
PC3 + PC6: CCA score = 0.1827
PC3 + PC7: CCA score = 0.4402
PC3 + PC8: CCA score = 0.1607
PC3 + PC9: CCA score = 0.1442
PC3 + PC10: CCA score = 0.2650
PC4 + PC5: CCA score = 0.4908
PC4 + PC6: CCA score = 0.3751
PC4 + PC7: CCA score = 0.5487
PC4 + PC8: CCA score = 0.3649
PC4 + PC9: CCA score = 0.3579
PC4 + PC10: CCA score = 0.4214
PC5 + PC6: CCA score = 0.3541
PC5 + PC7: CCA score = 0.5345
PC5 + PC8: CCA score = 0.3432
PC5 + PC9: CCA score = 0.3358
PC5 + PC10: CCA score = 0.4027
PC6 + PC7: CCA score = 0.4308
PC6 + PC8: CCA score = 0.1330
PC6 + PC9: CCA score = 0.1125
PC6 + PC10: CCA score = 0.2491
PC7 + PC8: CCA score = 0.4219
PC7 + PC9: CCA score = 0.4159
PC7 + PC10: CCA score = 0.4716
PC8 + PC9: CCA score = 0.0714
PC8 + PC10: CCA score = 0.2335
PC9 + PC10: CCA score = 0.2224
Best combination: PC4 + PC7 with score 0.5487
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.700/cca_plot_res_0.700.png
  ⏱️  CCA plot generation: 0.410 seconds
  📊 Created CCA visualization using PC4 + PC7 (viz score: 0.5487)
⏱️    🎲 Null distribution (1000 sims): 1.39 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0520
  ⏱️  TOTAL for resolution 0.700: 23.37 seconds

🎯 Testing resolution: 0.800
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.54 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 14
⏱️    🧪 Pseudobulk computation: 21.77 seconds
⏱️    📐 Dimension reduction: 0.06 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7763 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3403
PC1 + PC3: CCA score = 0.3892
PC1 + PC4: CCA score = 0.3769
PC1 + PC5: CCA score = 0.4483
PC1 + PC6: CCA score = 0.4794
PC1 + PC7: CCA score = 0.5016
PC1 + PC8: CCA score = 0.3175
PC1 + PC9: CCA score = 0.3301
PC1 + PC10: CCA score = 0.3178
PC2 + PC3: CCA score = 0.2595
PC2 + PC4: CCA score = 0.2406
PC2 + PC5: CCA score = 0.3418
PC2 + PC6: CCA score = 0.3817
PC2 + PC7: CCA score = 0.4093
PC2 + PC8: CCA score = 0.1292
PC2 + PC9: CCA score = 0.1576
PC2 + PC10: CCA score = 0.1299
PC3 + PC4: CCA score = 0.3058
PC3 + PC5: CCA score = 0.3905
PC3 + PC6: CCA score = 0.4258
PC3 + PC7: CCA score = 0.4507
PC3 + PC8: CCA score = 0.2287
PC3 + PC9: CCA score = 0.2458
PC3 + PC10: CCA score = 0.2291
PC4 + PC5: CCA score = 0.3782
PC4 + PC6: CCA score = 0.4146
PC4 + PC7: CCA score = 0.4401
PC4 + PC8: CCA score = 0.2071
PC4 + PC9: CCA score = 0.2259
PC4 + PC10: CCA score = 0.2075
PC5 + PC6: CCA score = 0.4804
PC5 + PC7: CCA score = 0.5027
PC5 + PC8: CCA score = 0.3191
PC5 + PC9: CCA score = 0.3316
PC5 + PC10: CCA score = 0.3194
PC6 + PC7: CCA score = 0.5306
PC6 + PC8: CCA score = 0.3615
PC6 + PC9: CCA score = 0.3725
PC6 + PC10: CCA score = 0.3617
PC7 + PC8: CCA score = 0.3905
PC7 + PC9: CCA score = 0.4008
PC7 + PC10: CCA score = 0.3907
PC8 + PC9: CCA score = 0.0991
PC8 + PC10: CCA score = 0.0430
PC9 + PC10: CCA score = 0.0999
Best combination: PC6 + PC7 with score 0.5306
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.800/cca_plot_res_0.800.png
  ⏱️  CCA plot generation: 0.412 seconds
  📊 Created CCA visualization using PC6 + PC7 (viz score: 0.5306)
⏱️    🎲 Null distribution (1000 sims): 1.38 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0490
  ⏱️  TOTAL for resolution 0.800: 25.17 seconds

🎯 Testing resolution: 0.900
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.73 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 13
⏱️    🧪 Pseudobulk computation: 20.85 seconds
⏱️    📐 Dimension reduction: 0.07 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7714 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3839
PC1 + PC3: CCA score = 0.2599
PC1 + PC4: CCA score = 0.4987
PC1 + PC5: CCA score = 0.2581
PC1 + PC6: CCA score = 0.4243
PC1 + PC7: CCA score = 0.2764
PC1 + PC8: CCA score = 0.2358
PC1 + PC9: CCA score = 0.2928
PC1 + PC10: CCA score = 0.2288
PC2 + PC3: CCA score = 0.3444
PC2 + PC4: CCA score = 0.5475
PC2 + PC5: CCA score = 0.3431
PC2 + PC6: CCA score = 0.4808
PC2 + PC7: CCA score = 0.3571
PC2 + PC8: CCA score = 0.3266
PC2 + PC9: CCA score = 0.3699
PC2 + PC10: CCA score = 0.3216
PC3 + PC4: CCA score = 0.4689
PC3 + PC5: CCA score = 0.1945
PC3 + PC6: CCA score = 0.3889
PC3 + PC7: CCA score = 0.2183
PC3 + PC8: CCA score = 0.1638
PC3 + PC9: CCA score = 0.2387
PC3 + PC10: CCA score = 0.1536
PC4 + PC5: CCA score = 0.4679
PC4 + PC6: CCA score = 0.5765
PC4 + PC7: CCA score = 0.4783
PC4 + PC8: CCA score = 0.4560
PC4 + PC9: CCA score = 0.4879
PC4 + PC10: CCA score = 0.4525
PC5 + PC6: CCA score = 0.3877
PC5 + PC7: CCA score = 0.2161
PC5 + PC8: CCA score = 0.1609
PC5 + PC9: CCA score = 0.2367
PC5 + PC10: CCA score = 0.1505
PC6 + PC7: CCA score = 0.4002
PC6 + PC8: CCA score = 0.3733
PC6 + PC9: CCA score = 0.4117
PC6 + PC10: CCA score = 0.3689
PC7 + PC8: CCA score = 0.1889
PC7 + PC9: CCA score = 0.2565
PC7 + PC10: CCA score = 0.1801
PC8 + PC9: CCA score = 0.2122
PC8 + PC10: CCA score = 0.1079
PC9 + PC10: CCA score = 0.2044
Best combination: PC4 + PC6 with score 0.5765
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.900/cca_plot_res_0.900.png
  ⏱️  CCA plot generation: 0.410 seconds
  📊 Created CCA visualization using PC4 + PC6 (viz score: 0.5765)
⏱️    🎲 Null distribution (1000 sims): 1.37 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0470
  ⏱️  TOTAL for resolution 0.900: 24.44 seconds

🎯 Testing resolution: 1.000
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.56 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 15
⏱️    🧪 Pseudobulk computation: 24.69 seconds
⏱️    📐 Dimension reduction: 0.06 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7649 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.5892
PC1 + PC3: CCA score = 0.0517
PC1 + PC4: CCA score = 0.0662
PC1 + PC5: CCA score = 0.0695
PC1 + PC6: CCA score = 0.3623
PC1 + PC7: CCA score = 0.1945
PC1 + PC8: CCA score = 0.1957
PC1 + PC9: CCA score = 0.0200
PC1 + PC10: CCA score = 0.1359
PC2 + PC3: CCA score = 0.5914
PC2 + PC4: CCA score = 0.5929
PC2 + PC5: CCA score = 0.5933
PC2 + PC6: CCA score = 0.6917
PC2 + PC7: CCA score = 0.6204
PC2 + PC8: CCA score = 0.6208
PC2 + PC9: CCA score = 0.5895
PC2 + PC10: CCA score = 0.6046
PC3 + PC4: CCA score = 0.0834
PC3 + PC5: CCA score = 0.0861
PC3 + PC6: CCA score = 0.3659
PC3 + PC7: CCA score = 0.2010
PC3 + PC8: CCA score = 0.2022
PC3 + PC9: CCA score = 0.0546
PC3 + PC10: CCA score = 0.1451
PC4 + PC5: CCA score = 0.0955
PC4 + PC6: CCA score = 0.3682
PC4 + PC7: CCA score = 0.2052
PC4 + PC8: CCA score = 0.2064
PC4 + PC9: CCA score = 0.0684
PC4 + PC10: CCA score = 0.1509
PC5 + PC6: CCA score = 0.3688
PC5 + PC7: CCA score = 0.2063
PC5 + PC8: CCA score = 0.2075
PC5 + PC9: CCA score = 0.0717
PC5 + PC10: CCA score = 0.1524
PC6 + PC7: CCA score = 0.4111
PC6 + PC8: CCA score = 0.4117
PC6 + PC9: CCA score = 0.3628
PC6 + PC10: CCA score = 0.3869
PC7 + PC8: CCA score = 0.2757
PC7 + PC9: CCA score = 0.1952
PC7 + PC10: CCA score = 0.2371
PC8 + PC9: CCA score = 0.1965
PC8 + PC10: CCA score = 0.2381
PC9 + PC10: CCA score = 0.1371
Best combination: PC2 + PC6 with score 0.6917
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_1.000/cca_plot_res_1.000.png
  ⏱️  CCA plot generation: 0.397 seconds
  📊 Created CCA visualization using PC2 + PC6 (viz score: 0.6917)
⏱️    🎲 Null distribution (1000 sims): 1.37 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0630
  ⏱️  TOTAL for resolution 1.000: 28.08 seconds

⏱️  COARSE SEARCH TOTAL: 202.94 seconds

🏆 Best resolution from first pass: 0.30
🎯 Best CCA score: 0.7932

🔬 === SECOND PASS: Fine-tuned Search ===
Fine-tuning search from 0.28 to 0.32...

🎯 Testing resolution: 0.280
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.66 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 6
⏱️    🧪 Pseudobulk computation: 11.44 seconds
⏱️    📐 Dimension reduction: 0.06 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7555 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.4784
PC1 + PC3: CCA score = 0.4109
PC1 + PC4: CCA score = 0.5028
PC1 + PC5: CCA score = 0.4293
PC1 + PC6: CCA score = 0.4758
PC1 + PC7: CCA score = 0.3956
PC1 + PC8: CCA score = 0.4052
PC1 + PC9: CCA score = 0.4583
PC1 + PC10: CCA score = 0.3829
PC2 + PC3: CCA score = 0.3252
PC2 + PC4: CCA score = 0.4355
PC2 + PC5: CCA score = 0.3481
PC2 + PC6: CCA score = 0.4041
PC2 + PC7: CCA score = 0.3056
PC2 + PC8: CCA score = 0.3180
PC2 + PC9: CCA score = 0.3834
PC2 + PC10: CCA score = 0.2890
PC3 + PC4: CCA score = 0.3601
PC3 + PC5: CCA score = 0.2474
PC3 + PC6: CCA score = 0.3215
PC3 + PC7: CCA score = 0.1829
PC3 + PC8: CCA score = 0.2028
PC3 + PC9: CCA score = 0.2950
PC3 + PC10: CCA score = 0.1535
PC4 + PC5: CCA score = 0.3809
PC4 + PC6: CCA score = 0.4327
PC4 + PC7: CCA score = 0.3425
PC4 + PC8: CCA score = 0.3536
PC4 + PC9: CCA score = 0.4134
PC4 + PC10: CCA score = 0.3278
PC5 + PC6: CCA score = 0.3446
PC5 + PC7: CCA score = 0.2210
PC5 + PC8: CCA score = 0.2377
PC5 + PC9: CCA score = 0.3200
PC5 + PC10: CCA score = 0.1974
PC6 + PC7: CCA score = 0.3016
PC6 + PC8: CCA score = 0.3141
PC6 + PC9: CCA score = 0.3802
PC6 + PC10: CCA score = 0.2848
PC7 + PC8: CCA score = 0.1696
PC7 + PC9: CCA score = 0.2732
PC7 + PC10: CCA score = 0.1058
PC8 + PC9: CCA score = 0.2869
PC8 + PC10: CCA score = 0.1374
PC9 + PC10: CCA score = 0.2545
Best combination: PC1 + PC4 with score 0.5028
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.280/cca_plot_res_0.280.png
  ⏱️  CCA plot generation: 0.415 seconds
  📊 Created CCA visualization using PC1 + PC4 (viz score: 0.5028)
⏱️    🎲 Null distribution (1000 sims): 1.38 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.1010
  ⏱️  TOTAL for resolution 0.280: 14.97 seconds

🎯 Testing resolution: 0.290
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.51 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 7
⏱️    🧪 Pseudobulk computation: 12.12 seconds
⏱️    📐 Dimension reduction: 0.05 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7800 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2102
PC1 + PC3: CCA score = 0.4796
PC1 + PC4: CCA score = 0.4647
PC1 + PC5: CCA score = 0.2383
PC1 + PC6: CCA score = 0.3705
PC1 + PC7: CCA score = 0.2669
PC1 + PC8: CCA score = 0.2727
PC1 + PC9: CCA score = 0.2238
PC1 + PC10: CCA score = 0.2300
PC2 + PC3: CCA score = 0.4395
PC2 + PC4: CCA score = 0.4232
PC2 + PC5: CCA score = 0.1410
PC2 + PC6: CCA score = 0.3168
PC2 + PC7: CCA score = 0.1854
PC2 + PC8: CCA score = 0.1936
PC2 + PC9: CCA score = 0.1148
PC2 + PC10: CCA score = 0.1265
PC3 + PC4: CCA score = 0.6041
PC3 + PC5: CCA score = 0.4536
PC3 + PC6: CCA score = 0.5350
PC3 + PC7: CCA score = 0.4693
PC3 + PC8: CCA score = 0.4726
PC3 + PC9: CCA score = 0.4461
PC3 + PC10: CCA score = 0.4493
PC4 + PC5: CCA score = 0.4378
PC4 + PC6: CCA score = 0.5217
PC4 + PC7: CCA score = 0.4540
PC4 + PC8: CCA score = 0.4574
PC4 + PC9: CCA score = 0.4301
PC4 + PC10: CCA score = 0.4333
PC5 + PC6: CCA score = 0.3361
PC5 + PC7: CCA score = 0.2167
PC5 + PC8: CCA score = 0.2237
PC5 + PC9: CCA score = 0.1605
PC5 + PC10: CCA score = 0.1690
PC6 + PC7: CCA score = 0.3570
PC6 + PC8: CCA score = 0.3613
PC6 + PC9: CCA score = 0.3259
PC6 + PC10: CCA score = 0.3302
PC7 + PC8: CCA score = 0.2540
PC7 + PC9: CCA score = 0.2006
PC7 + PC10: CCA score = 0.2075
PC8 + PC9: CCA score = 0.2082
PC8 + PC10: CCA score = 0.2148
PC9 + PC10: CCA score = 0.1478
Best combination: PC3 + PC4 with score 0.6041
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.290/cca_plot_res_0.290.png
  ⏱️  CCA plot generation: 0.413 seconds
  📊 Created CCA visualization using PC3 + PC4 (viz score: 0.6041)
⏱️    🎲 Null distribution (1000 sims): 1.38 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0470
  ⏱️  TOTAL for resolution 0.290: 15.48 seconds

🎯 Testing resolution: 0.310
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.53 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 7
⏱️    🧪 Pseudobulk computation: 13.12 seconds
⏱️    📐 Dimension reduction: 0.05 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7910 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.4693
PC1 + PC3: CCA score = 0.5145
PC1 + PC4: CCA score = 0.5555
PC1 + PC5: CCA score = 0.5860
PC1 + PC6: CCA score = 0.4603
PC1 + PC7: CCA score = 0.4573
PC1 + PC8: CCA score = 0.4569
PC1 + PC9: CCA score = 0.5487
PC1 + PC10: CCA score = 0.4702
PC2 + PC3: CCA score = 0.2629
PC2 + PC4: CCA score = 0.3362
PC2 + PC5: CCA score = 0.3844
PC2 + PC6: CCA score = 0.1277
PC2 + PC7: CCA score = 0.1161
PC2 + PC8: CCA score = 0.1147
PC2 + PC9: CCA score = 0.3248
PC2 + PC10: CCA score = 0.1597
PC3 + PC4: CCA score = 0.3969
PC3 + PC5: CCA score = 0.4385
PC3 + PC6: CCA score = 0.2466
PC3 + PC7: CCA score = 0.2408
PC3 + PC8: CCA score = 0.2401
PC3 + PC9: CCA score = 0.3873
PC3 + PC10: CCA score = 0.2646
PC4 + PC5: CCA score = 0.4860
PC4 + PC6: CCA score = 0.3236
PC4 + PC7: CCA score = 0.3192
PC4 + PC8: CCA score = 0.3187
PC4 + PC9: CCA score = 0.4403
PC4 + PC10: CCA score = 0.3375
PC5 + PC6: CCA score = 0.3735
PC5 + PC7: CCA score = 0.3697
PC5 + PC8: CCA score = 0.3692
PC5 + PC9: CCA score = 0.4782
PC5 + PC10: CCA score = 0.3856
PC6 + PC7: CCA score = 0.0719
PC6 + PC8: CCA score = 0.0696
PC6 + PC9: CCA score = 0.3117
PC6 + PC10: CCA score = 0.1311
PC7 + PC8: CCA score = 0.0449
PC7 + PC9: CCA score = 0.3072
PC7 + PC10: CCA score = 0.1198
PC8 + PC9: CCA score = 0.3066
PC8 + PC10: CCA score = 0.1185
PC9 + PC10: CCA score = 0.3261
Best combination: PC1 + PC5 with score 0.5860
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.310/cca_plot_res_0.310.png
  ⏱️  CCA plot generation: 0.415 seconds
  📊 Created CCA visualization using PC1 + PC5 (viz score: 0.5860)
⏱️    🎲 Null distribution (1000 sims): 1.38 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0420
  ⏱️  TOTAL for resolution 0.310: 16.51 seconds

🎯 Testing resolution: 0.320
  ⏱️  Cleanup: 0.001 seconds
⏱️    🧬 Cell clustering: 1.68 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 8
⏱️    🧪 Pseudobulk computation: 13.79 seconds
⏱️    📐 Dimension reduction: 0.06 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7862 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2132
PC1 + PC3: CCA score = 0.5251
PC1 + PC4: CCA score = 0.4004
PC1 + PC5: CCA score = 0.2768
PC1 + PC6: CCA score = 0.3408
PC1 + PC7: CCA score = 0.3476
PC1 + PC8: CCA score = 0.2594
PC1 + PC9: CCA score = 0.2179
PC1 + PC10: CCA score = 0.2383
PC2 + PC3: CCA score = 0.4838
PC2 + PC4: CCA score = 0.3444
PC2 + PC5: CCA score = 0.1869
PC2 + PC6: CCA score = 0.2729
PC2 + PC7: CCA score = 0.2813
PC2 + PC8: CCA score = 0.1600
PC2 + PC9: CCA score = 0.0761
PC2 + PC10: CCA score = 0.1229
PC3 + PC4: CCA score = 0.5907
PC3 + PC5: CCA score = 0.5150
PC3 + PC6: CCA score = 0.5520
PC3 + PC7: CCA score = 0.5562
PC3 + PC8: CCA score = 0.5058
PC3 + PC9: CCA score = 0.4859
PC3 + PC10: CCA score = 0.4953
PC4 + PC5: CCA score = 0.3870
PC4 + PC6: CCA score = 0.4351
PC4 + PC7: CCA score = 0.4405
PC4 + PC8: CCA score = 0.3748
PC4 + PC9: CCA score = 0.3474
PC4 + PC10: CCA score = 0.3605
PC5 + PC6: CCA score = 0.3250
PC5 + PC7: CCA score = 0.3321
PC5 + PC8: CCA score = 0.2383
PC5 + PC9: CCA score = 0.1922
PC5 + PC10: CCA score = 0.2151
PC6 + PC7: CCA score = 0.3871
PC6 + PC8: CCA score = 0.3103
PC6 + PC9: CCA score = 0.2766
PC6 + PC10: CCA score = 0.2929
PC7 + PC8: CCA score = 0.3178
PC7 + PC9: CCA score = 0.2849
PC7 + PC10: CCA score = 0.3008
PC8 + PC9: CCA score = 0.1663
PC8 + PC10: CCA score = 0.1922
PC9 + PC10: CCA score = 0.1309
Best combination: PC3 + PC4 with score 0.5907
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.320/cca_plot_res_0.320.png
  ⏱️  CCA plot generation: 0.409 seconds
  📊 Created CCA visualization using PC3 + PC4 (viz score: 0.5907)
⏱️    🎲 Null distribution (1000 sims): 1.38 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0490
  ⏱️  TOTAL for resolution 0.320: 17.33 seconds

⏱️  FINE SEARCH TOTAL: 64.28 seconds

🔧 === GENERATING CORRECTED NULL DISTRIBUTION ===
⏱️  📊 Corrected null distribution generation: 0.00 seconds
⏱️  Saving corrected null: 0.001 seconds

📊 === COMPUTING CORRECTED P-VALUES ===
⏱️  📈 Corrected p-values computation: 3.70 seconds
⏱️  Corrected null visualization: 0.255 seconds
⏱️  CORRECTED P-VALUES TOTAL: 3.96 seconds

🏆 === FINAL RESULTS ===
🎯 Best resolution: 0.300
📊 Best CCA score: 0.7932
🧬 Number of clusters: 6
📐 Number of PCs used: 10
📊 Best visualization used PC2 + PC4
📈 Standard p-value: 0.0450
📊 Corrected p-value: 0.3780
⏱️  Final processing: 0.016 seconds

🚀 [PROFILED Find Optimal Resolution RNA-seq] TOTAL RUNTIME: 271.20 seconds

📊 PERFORMANCE SUMMARY:
  🔧 Setup: 0.0s
  🔍 Coarse search: 202.9s (74.8%)
  🔬 Fine search: 64.3s (23.7%)
  📊 Corrected p-values: 4.0s (1.5%)
  📝 Final processing: 0.0s
Starting visualization...
[_preprocessing] Verified required columns in pseudobulk AnnData: ['sev.level']
Found 8 unique cell types.
Dendrogram saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/visualization/cell_type_dendrogram.png
[visualization] All requested visualizations saved.
RNA analysis completed successfully!

✓ RNA pipeline completed successfully!

============================================================
PIPELINE EXECUTION SUMMARY
============================================================
RNA Pipeline: ⚠ PARTIAL
  - preprocessing: ✓
  - cell_type_cluster: ✓
  - dimensionality_reduction: ✓
  - sample_distance_calculation: ✓
  - trajectory_analysis: ✓
  - trajectory_dge: ✗
  - cluster_dge: ✗
  - visualization: ✓

Results saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample
Status file: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/sys_log/main_process_status.json
