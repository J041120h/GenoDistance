Linux system detected with GPU enabled.
Resuming process from previous progress:
{
    "rna": {
        "preprocessing": false,
        "cell_type_cluster": false,
        "dimensionality_reduction": false,
        "sample_distance_calculation": false,
        "trajectory_analysis": false,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "atac": {
        "preprocessing": false,
        "cell_type_cluster": false,
        "dimensionality_reduction": false,
        "sample_distance_calculation": false,
        "trajectory_analysis": false,
        "trajectory_dge": false,
        "cluster_dge": false,
        "visualization": false
    },
    "multiomics": {
        "glue_integration": false,
        "glue_preprocessing": false,
        "glue_training": false,
        "glue_gene_activity": false,
        "glue_cell_types": false,
        "glue_visualization": false,
        "integration_preprocessing": true,
        "dimensionality_reduction": true,
        "embedding_visualization": true,
        "optimal_resolution": false
    },
    "system_info": {
        "platform": "Linux",
        "python_version": "3.10.18 | packaged by conda-forge | (main, Jun  4 2025, 14:45:41) [GCC 13.3.0]",
        "use_gpu": true,
        "linux_system": true
    }
}

============================================================
RUNNING RNA PIPELINE
============================================================
Starting RNA wrapper function with provided parameters...
Reading Pseudobulk from provided or default path: /dcs07/hongkai/data/harry/result/multi_omics_SD/multiomics/pseudobulk/pseudobulk_sample.h5ad

Running sample distance: cosine

[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Computing cosine distance using dimension reduction results...
Data type: ATAC (affects DR method prioritization)
Available sample metadata columns: ['modality']
Number of samples: 88
Warning: Grouping columns not found in adata.obs: ['tissue']
Using available grouping columns: []
Computing sample distances using expression dimension reduction (X_DR_expression)...
Warning: None of the grouping columns [] found in adata.obs
Using fallback grouping by sample prefix
Distance check results saved to /dcs07/hongkai/data/harry/result/multi_omics_SD/rna/Sample_distance/cosine/expression_DR_distance/distance_check_results_expression_DR_cosine.txt
Score for expression_DR (cosine): nan
Summary updated in /dcs07/hongkai/data/harry/result/multi_omics_SD/rna/summary_sample.csv
Distance check completed for expression_DR: score = nan
Sample distance heatmap saved to /dcs07/hongkai/data/harry/result/multi_omics_SD/rna/Sample_distance/cosine/expression_DR_distance/sample_distance_expression_DR_heatmap.pdf
expression_DR-based distance matrix saved to: /dcs07/hongkai/data/harry/result/multi_omics_SD/rna/Sample_distance/cosine/expression_DR_distance
Computing sample distances using proportion dimension reduction (X_DR_proportion)...
Warning: None of the grouping columns [] found in adata.obs
Using fallback grouping by sample prefix
Distance check results saved to /dcs07/hongkai/data/harry/result/multi_omics_SD/rna/Sample_distance/cosine/proportion_DR_distance/distance_check_results_proportion_DR_cosine.txt
Score for proportion_DR (cosine): nan
Summary updated in /dcs07/hongkai/data/harry/result/multi_omics_SD/rna/summary_sample.csv
Distance check completed for proportion_DR: score = nan
Sample distance heatmap saved to /dcs07/hongkai/data/harry/result/multi_omics_SD/rna/Sample_distance/cosine/proportion_DR_distance/sample_distance_proportion_DR_heatmap.pdf
proportion_DR-based distance matrix saved to: /dcs07/hongkai/data/harry/result/multi_omics_SD/rna/Sample_distance/cosine/proportion_DR_distance
Sample distance computations completed for: expression_DR, proportion_DR
Distance statistics summary saved to: /dcs07/hongkai/data/harry/result/multi_omics_SD/rna/Sample_distance/cosine/distance_statistics_summary_cosine.csv

Running sample distance: correlation

[Seed Control] PyTorch GPU deterministic mode enabled with seed=42
[Seed Control] CuPy seed set to 42
[Seed Control] Scanpy seed set to 42
Computing correlation distance using dimension reduction results...
Data type: ATAC (affects DR method prioritization)
Available sample metadata columns: ['modality']
Number of samples: 88
Warning: Grouping columns not found in adata.obs: ['tissue']
Using available grouping columns: []
Computing sample distances using expression dimension reduction (X_DR_expression)...
Warning: None of the grouping columns [] found in adata.obs
Using fallback grouping by sample prefix
Distance check results saved to /dcs07/hongkai/data/harry/result/multi_omics_SD/rna/Sample_distance/correlation/expression_DR_distance/distance_check_results_expression_DR_correlation.txt
Score for expression_DR (correlation): nan
Summary updated in /dcs07/hongkai/data/harry/result/multi_omics_SD/rna/summary_sample.csv
Distance check completed for expression_DR: score = nan
Sample distance heatmap saved to /dcs07/hongkai/data/harry/result/multi_omics_SD/rna/Sample_distance/correlation/expression_DR_distance/sample_distance_expression_DR_heatmap.pdf
expression_DR-based distance matrix saved to: /dcs07/hongkai/data/harry/result/multi_omics_SD/rna/Sample_distance/correlation/expression_DR_distance
Computing sample distances using proportion dimension reduction (X_DR_proportion)...
Warning: None of the grouping columns [] found in adata.obs
Using fallback grouping by sample prefix
Distance check results saved to /dcs07/hongkai/data/harry/result/multi_omics_SD/rna/Sample_distance/correlation/proportion_DR_distance/distance_check_results_proportion_DR_correlation.txt
Score for proportion_DR (correlation): nan
Summary updated in /dcs07/hongkai/data/harry/result/multi_omics_SD/rna/summary_sample.csv
Distance check completed for proportion_DR: score = nan
Sample distance heatmap saved to /dcs07/hongkai/data/harry/result/multi_omics_SD/rna/Sample_distance/correlation/proportion_DR_distance/sample_distance_proportion_DR_heatmap.pdf
proportion_DR-based distance matrix saved to: /dcs07/hongkai/data/harry/result/multi_omics_SD/rna/Sample_distance/correlation/proportion_DR_distance
Sample distance computations completed for: expression_DR, proportion_DR
Distance statistics summary saved to: /dcs07/hongkai/data/harry/result/multi_omics_SD/rna/Sample_distance/correlation/distance_statistics_summary_correlation.csv
Sample distance calculation completed. Results saved in /dcs07/hongkai/data/harry/result/multi_omics_SD/rna/Sample_distance
RNA analysis completed successfully!

✓ RNA pipeline completed successfully!

============================================================
PIPELINE EXECUTION SUMMARY
============================================================
RNA Pipeline: ⚠ PARTIAL
  - preprocessing: ✓
  - cell_type_cluster: ✓
  - dimensionality_reduction: ✓
  - sample_distance_calculation: ✓
  - trajectory_analysis: ✗
  - trajectory_dge: ✗
  - cluster_dge: ✗
  - visualization: ✗

Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_SD
Status file: /dcs07/hongkai/data/harry/result/multi_omics_SD/sys_log/main_process_status.json
Execution time: 61.1372 seconds
