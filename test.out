2025-11-30 16:52:55,648 - INFO - Initialized BenchmarkWrapper (explicit paths) with:
2025-11-30 16:52:55,648 - INFO -   Meta CSV:          /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 16:52:55,648 - INFO -   Pseudotime CSV:    /dcs07/hongkai/data/harry/result/GEDI/25_sample/trajectory/pseudotime_results.csv
2025-11-30 16:52:55,648 - INFO -   Embedding CSV:     /dcs07/hongkai/data/harry/result/GEDI/25_sample/gedi_sample_embedding.csv
2025-11-30 16:52:55,648 - INFO -   Method name:       GEDI
2025-11-30 16:52:55,648 - INFO -   Output base dir:   /dcs07/hongkai/data/harry/result/GEDI/25_sample
2025-11-30 16:52:55,648 - INFO -   Run output dir:    /dcs07/hongkai/data/harry/result/GEDI/25_sample/benchmark_results_GEDI
2025-11-30 16:52:55,648 - INFO -   Summary CSV:       /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv
2025-11-30 16:52:55,648 - INFO - 
==================================================
2025-11-30 16:52:55,648 - INFO - Running embedding_visualization...
2025-11-30 16:52:55,648 - INFO - ==================================================
2025-11-30 16:52:55,648 - INFO - Running Embedding Visualization...
2025-11-30 16:52:55,648 - INFO - Loading metadata from: /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 16:52:55,652 - INFO - Loading embeddings from: /dcs07/hongkai/data/harry/result/GEDI/25_sample/gedi_sample_embedding.csv
2025-11-30 16:52:55,654 - INFO - Performing PCA to 2 components...
2025-11-30 16:52:55,655 - INFO - Variance explained by PC1: 54.96%
2025-11-30 16:52:55,656 - INFO - Variance explained by PC2: 31.94%
2025-11-30 16:52:56,115 - INFO - Embedding visualization completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/25_sample/benchmark_results_GEDI/embedding_visualization
2025-11-30 16:52:56,115 - INFO - 
==================================================
2025-11-30 16:52:56,115 - INFO - Running trajectory_anova...
2025-11-30 16:52:56,115 - INFO - ==================================================
2025-11-30 16:52:56,115 - INFO - Running Trajectory ANOVA Analysis...
2025-11-30 16:52:56,205 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 16:52:56,207 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 16:52:56,208 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 16:52:57,624 - INFO - Trajectory ANOVA completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/25_sample/benchmark_results_GEDI/trajectory_anova
2025-11-30 16:52:57,624 - INFO - 
==================================================
2025-11-30 16:52:57,624 - INFO - Running batch_removal...
2025-11-30 16:52:57,624 - INFO - ==================================================
2025-11-30 16:52:57,624 - INFO - Running Batch Removal Evaluation...
Note: dropping 516 metadata rows without data match.
2025-11-30 16:52:57,648 - INFO - Batch removal evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/25_sample/benchmark_results_GEDI/batch_removal
2025-11-30 16:52:57,648 - INFO - 
==================================================
2025-11-30 16:52:57,648 - INFO - Running ari_clustering...
2025-11-30 16:52:57,648 - INFO - ==================================================
2025-11-30 16:52:57,648 - INFO - Running ARI Clustering Evaluation...
Reading metadata and data files...
Found severity levels: [np.int64(1), np.int64(2), np.int64(3), np.int64(4)]
Loaded embedding with shape (25, 10) (samples × dimensions)
Note: dropping 516 metadata rows without data match.
Found 4 unique severity levels: [1 2 3 4]
Using 4 clusters for KNN clustering
Performing KNN clustering with k=20...
Computing ARI and other metrics...
Generating visualizations...
2025-11-30 16:52:58,373 - INFO - ARI clustering evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/25_sample/benchmark_results_GEDI/ari_clustering
2025-11-30 16:52:58,373 - INFO - 
==================================================
2025-11-30 16:52:58,373 - INFO - Running trajectory_analysis...
2025-11-30 16:52:58,373 - INFO - ==================================================
2025-11-30 16:52:58,373 - INFO - Running Trajectory Analysis...
2025-11-30 16:52:59,168 - INFO - Trajectory analysis completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/25_sample/benchmark_results_GEDI/trajectory_analysis
2025-11-30 16:52:59,168 - INFO - 
==================================================
2025-11-30 16:52:59,168 - INFO - Running pseudotime_embeddings_custom...
2025-11-30 16:52:59,168 - INFO - ==================================================
2025-11-30 16:52:59,168 - INFO - Running Custom Pseudotime Embeddings Benchmark (simple schema)...
2025-11-30 16:52:59,448 - INFO - [DEBUG] embedding_visualization result keys: ['variance_explained', 'n_samples', 'n_features', 'sev_level_range', 'unique_batches', 'batch_labels', 'output_plot', 'output_pca']
2025-11-30 16:52:59,448 - INFO - [DEBUG] trajectory_anova result keys: ['anova_table', 'model', 'desc_stats', 'posthoc', 'data', 'pseudotime_col', 'n_samples', 'n_batches', 'n_severity_levels', 'model_type']
2025-11-30 16:52:59,448 - INFO - [DEBUG] batch_removal result keys: ['n_samples', 'batches', 'iLISI_mean', 'iLISI_std', 'iLISI_norm_mean', 'ASW_batch_overall', 'per_sample_path', 'summary_path']
2025-11-30 16:52:59,448 - INFO - [DEBUG] ari_clustering result keys: ['metrics', 'interpretation', 'n_samples', 'severity_levels', 'per_sample_path', 'summary_path', 'metrics_json_path']
2025-11-30 16:52:59,448 - INFO - [DEBUG] trajectory_analysis result keys: ['spearman_corr', 'spearman_p', 'n_samples', 'data', 'pseudotime_col']
2025-11-30 16:52:59,448 - INFO - [DEBUG] pseudotime_embeddings_custom result keys: ['paths', 'anova_anchor', 'anova_anchor_scipy', 'nn_gap_summary', 'nn_gap_per_sample']
2025-11-30 16:52:59,448 - INFO - [DEBUG] Collected metrics: {'n_samples': 25, 'batch_partial_eta_sq': 0.1560770371073954, 'severity_partial_eta_sq': 0.32081685826586864, 'interaction_partial_eta_sq': 0.5925906368788226, 'iLISI_norm': 0.3012698226397708, 'ASW_batch': 0.539278325835864, 'ARI': 0.02573070197351986, 'NMI': 0.19503127038448154, 'Avg_Purity': np.float64(0.6488095238095237), 'Spearman_Correlation': np.float64(-0.5132412939709821), 'Spearman_pval': np.float64(0.00869429353820755), 'Mean_NN_Severity_Gap': 1.4375, 'Custom_ANOVA_pval': np.float64(0.2245944592083373)}
2025-11-30 16:52:59,456 - INFO - Updated summary CSV at: /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv with column 'GEDI-25'
2025-11-30 16:52:59,457 - INFO - Initialized BenchmarkWrapper (explicit paths) with:
2025-11-30 16:52:59,457 - INFO -   Meta CSV:          /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 16:52:59,457 - INFO -   Pseudotime CSV:    /dcs07/hongkai/data/harry/result/GEDI/50_sample/trajectory/pseudotime_results.csv
2025-11-30 16:52:59,457 - INFO -   Embedding CSV:     /dcs07/hongkai/data/harry/result/GEDI/50_sample/gedi_sample_embedding.csv
2025-11-30 16:52:59,457 - INFO -   Method name:       GEDI
2025-11-30 16:52:59,457 - INFO -   Output base dir:   /dcs07/hongkai/data/harry/result/GEDI/50_sample
2025-11-30 16:52:59,457 - INFO -   Run output dir:    /dcs07/hongkai/data/harry/result/GEDI/50_sample/benchmark_results_GEDI
2025-11-30 16:52:59,457 - INFO -   Summary CSV:       /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv
2025-11-30 16:52:59,458 - INFO - 
==================================================
2025-11-30 16:52:59,458 - INFO - Running embedding_visualization...
2025-11-30 16:52:59,458 - INFO - ==================================================
2025-11-30 16:52:59,458 - INFO - Running Embedding Visualization...
2025-11-30 16:52:59,458 - INFO - Loading metadata from: /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 16:52:59,459 - INFO - Loading embeddings from: /dcs07/hongkai/data/harry/result/GEDI/50_sample/gedi_sample_embedding.csv
2025-11-30 16:52:59,461 - INFO - Performing PCA to 2 components...
2025-11-30 16:52:59,462 - INFO - Variance explained by PC1: 52.34%
2025-11-30 16:52:59,462 - INFO - Variance explained by PC2: 24.04%
2025-11-30 16:53:00,011 - INFO - Embedding visualization completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/50_sample/benchmark_results_GEDI/embedding_visualization
2025-11-30 16:53:00,011 - INFO - 
==================================================
2025-11-30 16:53:00,011 - INFO - Running trajectory_anova...
2025-11-30 16:53:00,011 - INFO - ==================================================
2025-11-30 16:53:00,011 - INFO - Running Trajectory ANOVA Analysis...
2025-11-30 16:53:00,366 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 16:53:00,368 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 16:53:00,369 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 16:53:01,868 - INFO - Trajectory ANOVA completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/50_sample/benchmark_results_GEDI/trajectory_anova
2025-11-30 16:53:01,868 - INFO - 
==================================================
2025-11-30 16:53:01,868 - INFO - Running batch_removal...
2025-11-30 16:53:01,868 - INFO - ==================================================
2025-11-30 16:53:01,868 - INFO - Running Batch Removal Evaluation...
Note: dropping 491 metadata rows without data match.
2025-11-30 16:53:01,892 - INFO - Batch removal evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/50_sample/benchmark_results_GEDI/batch_removal
2025-11-30 16:53:01,892 - INFO - 
==================================================
2025-11-30 16:53:01,892 - INFO - Running ari_clustering...
2025-11-30 16:53:01,892 - INFO - ==================================================
2025-11-30 16:53:01,892 - INFO - Running ARI Clustering Evaluation...
Reading metadata and data files...
Found severity levels: [np.int64(1), np.int64(2), np.int64(3), np.int64(4)]
Loaded embedding with shape (50, 10) (samples × dimensions)
Note: dropping 491 metadata rows without data match.
Found 4 unique severity levels: [1 2 3 4]
Using 4 clusters for KNN clustering
Performing KNN clustering with k=20...
Computing ARI and other metrics...
Generating visualizations...
2025-11-30 16:53:02,602 - INFO - ARI clustering evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/50_sample/benchmark_results_GEDI/ari_clustering
2025-11-30 16:53:02,602 - INFO - 
==================================================
2025-11-30 16:53:02,602 - INFO - Running trajectory_analysis...
2025-11-30 16:53:02,602 - INFO - ==================================================
2025-11-30 16:53:02,602 - INFO - Running Trajectory Analysis...
2025-11-30 16:53:03,455 - INFO - Trajectory analysis completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/50_sample/benchmark_results_GEDI/trajectory_analysis
2025-11-30 16:53:03,455 - INFO - 
==================================================
2025-11-30 16:53:03,456 - INFO - Running pseudotime_embeddings_custom...
2025-11-30 16:53:03,456 - INFO - ==================================================
2025-11-30 16:53:03,456 - INFO - Running Custom Pseudotime Embeddings Benchmark (simple schema)...
2025-11-30 16:53:03,733 - INFO - [DEBUG] embedding_visualization result keys: ['variance_explained', 'n_samples', 'n_features', 'sev_level_range', 'unique_batches', 'batch_labels', 'output_plot', 'output_pca']
2025-11-30 16:53:03,733 - INFO - [DEBUG] trajectory_anova result keys: ['anova_table', 'model', 'desc_stats', 'posthoc', 'data', 'pseudotime_col', 'n_samples', 'n_batches', 'n_severity_levels', 'model_type']
2025-11-30 16:53:03,733 - INFO - [DEBUG] batch_removal result keys: ['n_samples', 'batches', 'iLISI_mean', 'iLISI_std', 'iLISI_norm_mean', 'ASW_batch_overall', 'per_sample_path', 'summary_path']
2025-11-30 16:53:03,733 - INFO - [DEBUG] ari_clustering result keys: ['metrics', 'interpretation', 'n_samples', 'severity_levels', 'per_sample_path', 'summary_path', 'metrics_json_path']
2025-11-30 16:53:03,733 - INFO - [DEBUG] trajectory_analysis result keys: ['spearman_corr', 'spearman_p', 'n_samples', 'data', 'pseudotime_col']
2025-11-30 16:53:03,733 - INFO - [DEBUG] pseudotime_embeddings_custom result keys: ['paths', 'anova_anchor', 'anova_anchor_scipy', 'nn_gap_summary', 'nn_gap_per_sample']
2025-11-30 16:53:03,733 - INFO - [DEBUG] Collected metrics: {'n_samples': 50, 'batch_partial_eta_sq': 0.5483090260862893, 'severity_partial_eta_sq': 1.619491911777853e-15, 'interaction_partial_eta_sq': 0.6369646317316978, 'iLISI_norm': 0.20706170866057133, 'ASW_batch': 0.602122710661287, 'ARI': -0.027646781616494486, 'NMI': 0.09448101921577254, 'Avg_Purity': np.float64(0.7559523809523809), 'Spearman_Correlation': np.float64(-0.5339577765138923), 'Spearman_pval': np.float64(6.511021680481414e-05), 'Mean_NN_Severity_Gap': 1.3448275862068966, 'Custom_ANOVA_pval': np.float64(0.012854908039547811)}
2025-11-30 16:53:03,737 - INFO - Updated summary CSV at: /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv with column 'GEDI-50'
2025-11-30 16:53:03,738 - INFO - Initialized BenchmarkWrapper (explicit paths) with:
2025-11-30 16:53:03,738 - INFO -   Meta CSV:          /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 16:53:03,738 - INFO -   Pseudotime CSV:    /dcs07/hongkai/data/harry/result/GEDI/100_sample/trajectory/pseudotime_results.csv
2025-11-30 16:53:03,738 - INFO -   Embedding CSV:     /dcs07/hongkai/data/harry/result/GEDI/100_sample/gedi_sample_embedding.csv
2025-11-30 16:53:03,738 - INFO -   Method name:       GEDI
2025-11-30 16:53:03,738 - INFO -   Output base dir:   /dcs07/hongkai/data/harry/result/GEDI/100_sample
2025-11-30 16:53:03,738 - INFO -   Run output dir:    /dcs07/hongkai/data/harry/result/GEDI/100_sample/benchmark_results_GEDI
2025-11-30 16:53:03,738 - INFO -   Summary CSV:       /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv
2025-11-30 16:53:03,738 - INFO - 
==================================================
2025-11-30 16:53:03,738 - INFO - Running embedding_visualization...
2025-11-30 16:53:03,738 - INFO - ==================================================
2025-11-30 16:53:03,738 - INFO - Running Embedding Visualization...
2025-11-30 16:53:03,739 - INFO - Loading metadata from: /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 16:53:03,740 - INFO - Loading embeddings from: /dcs07/hongkai/data/harry/result/GEDI/100_sample/gedi_sample_embedding.csv
2025-11-30 16:53:03,742 - INFO - Performing PCA to 2 components...
2025-11-30 16:53:03,743 - INFO - Variance explained by PC1: 46.31%
2025-11-30 16:53:03,743 - INFO - Variance explained by PC2: 23.86%
2025-11-30 16:53:04,225 - INFO - Embedding visualization completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/100_sample/benchmark_results_GEDI/embedding_visualization
2025-11-30 16:53:04,226 - INFO - 
==================================================
2025-11-30 16:53:04,226 - INFO - Running trajectory_anova...
2025-11-30 16:53:04,226 - INFO - ==================================================
2025-11-30 16:53:04,226 - INFO - Running Trajectory ANOVA Analysis...
2025-11-30 16:53:04,656 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 16:53:04,659 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 16:53:04,660 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 16:53:06,288 - INFO - Trajectory ANOVA completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/100_sample/benchmark_results_GEDI/trajectory_anova
2025-11-30 16:53:06,288 - INFO - 
==================================================
2025-11-30 16:53:06,288 - INFO - Running batch_removal...
2025-11-30 16:53:06,288 - INFO - ==================================================
2025-11-30 16:53:06,288 - INFO - Running Batch Removal Evaluation...
Note: dropping 441 metadata rows without data match.
2025-11-30 16:53:06,311 - INFO - Batch removal evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/100_sample/benchmark_results_GEDI/batch_removal
2025-11-30 16:53:06,311 - INFO - 
==================================================
2025-11-30 16:53:06,311 - INFO - Running ari_clustering...
2025-11-30 16:53:06,311 - INFO - ==================================================
2025-11-30 16:53:06,311 - INFO - Running ARI Clustering Evaluation...
Reading metadata and data files...
Found severity levels: [np.int64(1), np.int64(2), np.int64(3), np.int64(4)]
Loaded embedding with shape (100, 10) (samples × dimensions)
Note: dropping 441 metadata rows without data match.
Found 4 unique severity levels: [1 2 3 4]
Using 4 clusters for KNN clustering
Performing KNN clustering with k=20...
Computing ARI and other metrics...
Generating visualizations...
2025-11-30 16:53:07,031 - INFO - ARI clustering evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/100_sample/benchmark_results_GEDI/ari_clustering
2025-11-30 16:53:07,031 - INFO - 
==================================================
2025-11-30 16:53:07,031 - INFO - Running trajectory_analysis...
2025-11-30 16:53:07,031 - INFO - ==================================================
2025-11-30 16:53:07,031 - INFO - Running Trajectory Analysis...
2025-11-30 16:53:07,845 - INFO - Trajectory analysis completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/100_sample/benchmark_results_GEDI/trajectory_analysis
2025-11-30 16:53:07,845 - INFO - 
==================================================
2025-11-30 16:53:07,845 - INFO - Running pseudotime_embeddings_custom...
2025-11-30 16:53:07,845 - INFO - ==================================================
2025-11-30 16:53:07,845 - INFO - Running Custom Pseudotime Embeddings Benchmark (simple schema)...
2025-11-30 16:53:08,128 - INFO - [DEBUG] embedding_visualization result keys: ['variance_explained', 'n_samples', 'n_features', 'sev_level_range', 'unique_batches', 'batch_labels', 'output_plot', 'output_pca']
2025-11-30 16:53:08,128 - INFO - [DEBUG] trajectory_anova result keys: ['anova_table', 'model', 'desc_stats', 'posthoc', 'data', 'pseudotime_col', 'n_samples', 'n_batches', 'n_severity_levels', 'model_type']
2025-11-30 16:53:08,129 - INFO - [DEBUG] batch_removal result keys: ['n_samples', 'batches', 'iLISI_mean', 'iLISI_std', 'iLISI_norm_mean', 'ASW_batch_overall', 'per_sample_path', 'summary_path']
2025-11-30 16:53:08,129 - INFO - [DEBUG] ari_clustering result keys: ['metrics', 'interpretation', 'n_samples', 'severity_levels', 'per_sample_path', 'summary_path', 'metrics_json_path']
2025-11-30 16:53:08,129 - INFO - [DEBUG] trajectory_analysis result keys: ['spearman_corr', 'spearman_p', 'n_samples', 'data', 'pseudotime_col']
2025-11-30 16:53:08,129 - INFO - [DEBUG] pseudotime_embeddings_custom result keys: ['paths', 'anova_anchor', 'anova_anchor_scipy', 'nn_gap_summary', 'nn_gap_per_sample']
2025-11-30 16:53:08,129 - INFO - [DEBUG] Collected metrics: {'n_samples': 100, 'batch_partial_eta_sq': 0.4398232181432662, 'severity_partial_eta_sq': -0.06235726131421048, 'interaction_partial_eta_sq': 0.38697119446074624, 'iLISI_norm': 0.14369032035665416, 'ASW_batch': 0.5501629535127585, 'ARI': 0.017781996449366885, 'NMI': 0.09375770507873857, 'Avg_Purity': np.float64(0.8021505376344087), 'Spearman_Correlation': np.float64(-0.5571427711056645), 'Spearman_pval': np.float64(1.7421927633425523e-09), 'Mean_NN_Severity_Gap': 1.5161290322580645, 'Custom_ANOVA_pval': np.float64(2.1098125058530375e-05)}
2025-11-30 16:53:08,133 - INFO - Updated summary CSV at: /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv with column 'GEDI-100'
2025-11-30 16:53:08,133 - INFO - Initialized BenchmarkWrapper (explicit paths) with:
2025-11-30 16:53:08,133 - INFO -   Meta CSV:          /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 16:53:08,134 - INFO -   Pseudotime CSV:    /dcs07/hongkai/data/harry/result/GEDI/200_sample/trajectory/pseudotime_results.csv
2025-11-30 16:53:08,134 - INFO -   Embedding CSV:     /dcs07/hongkai/data/harry/result/GEDI/200_sample/gedi_sample_embedding.csv
2025-11-30 16:53:08,134 - INFO -   Method name:       GEDI
2025-11-30 16:53:08,134 - INFO -   Output base dir:   /dcs07/hongkai/data/harry/result/GEDI/200_sample
2025-11-30 16:53:08,134 - INFO -   Run output dir:    /dcs07/hongkai/data/harry/result/GEDI/200_sample/benchmark_results_GEDI
2025-11-30 16:53:08,134 - INFO -   Summary CSV:       /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv
2025-11-30 16:53:08,134 - INFO - 
==================================================
2025-11-30 16:53:08,134 - INFO - Running embedding_visualization...
2025-11-30 16:53:08,134 - INFO - ==================================================
2025-11-30 16:53:08,134 - INFO - Running Embedding Visualization...
2025-11-30 16:53:08,134 - INFO - Loading metadata from: /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 16:53:08,135 - INFO - Loading embeddings from: /dcs07/hongkai/data/harry/result/GEDI/200_sample/gedi_sample_embedding.csv
2025-11-30 16:53:08,137 - INFO - Performing PCA to 2 components...
2025-11-30 16:53:08,138 - INFO - Variance explained by PC1: 46.17%
2025-11-30 16:53:08,138 - INFO - Variance explained by PC2: 22.07%
2025-11-30 16:53:08,637 - INFO - Embedding visualization completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/200_sample/benchmark_results_GEDI/embedding_visualization
2025-11-30 16:53:08,637 - INFO - 
==================================================
2025-11-30 16:53:08,637 - INFO - Running trajectory_anova...
2025-11-30 16:53:08,637 - INFO - ==================================================
2025-11-30 16:53:08,637 - INFO - Running Trajectory ANOVA Analysis...
2025-11-30 16:53:09,212 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 16:53:09,215 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 16:53:09,215 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 16:53:10,836 - INFO - Trajectory ANOVA completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/200_sample/benchmark_results_GEDI/trajectory_anova
2025-11-30 16:53:10,836 - INFO - 
==================================================
2025-11-30 16:53:10,836 - INFO - Running batch_removal...
2025-11-30 16:53:10,836 - INFO - ==================================================
2025-11-30 16:53:10,836 - INFO - Running Batch Removal Evaluation...
Note: dropping 341 metadata rows without data match.
2025-11-30 16:53:10,861 - INFO - Batch removal evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/200_sample/benchmark_results_GEDI/batch_removal
2025-11-30 16:53:10,861 - INFO - 
==================================================
2025-11-30 16:53:10,861 - INFO - Running ari_clustering...
2025-11-30 16:53:10,861 - INFO - ==================================================
2025-11-30 16:53:10,861 - INFO - Running ARI Clustering Evaluation...
Reading metadata and data files...
Found severity levels: [np.int64(1), np.int64(2), np.int64(3), np.int64(4)]
Loaded embedding with shape (200, 10) (samples × dimensions)
Note: dropping 341 metadata rows without data match.
Found 4 unique severity levels: [1 2 3 4]
Using 4 clusters for KNN clustering
Performing KNN clustering with k=20...
Computing ARI and other metrics...
Generating visualizations...
2025-11-30 16:53:11,597 - INFO - ARI clustering evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/200_sample/benchmark_results_GEDI/ari_clustering
2025-11-30 16:53:11,597 - INFO - 
==================================================
2025-11-30 16:53:11,597 - INFO - Running trajectory_analysis...
2025-11-30 16:53:11,597 - INFO - ==================================================
2025-11-30 16:53:11,597 - INFO - Running Trajectory Analysis...
2025-11-30 16:53:12,481 - INFO - Trajectory analysis completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/200_sample/benchmark_results_GEDI/trajectory_analysis
2025-11-30 16:53:12,481 - INFO - 
==================================================
2025-11-30 16:53:12,481 - INFO - Running pseudotime_embeddings_custom...
2025-11-30 16:53:12,481 - INFO - ==================================================
2025-11-30 16:53:12,481 - INFO - Running Custom Pseudotime Embeddings Benchmark (simple schema)...
2025-11-30 16:53:12,760 - INFO - [DEBUG] embedding_visualization result keys: ['variance_explained', 'n_samples', 'n_features', 'sev_level_range', 'unique_batches', 'batch_labels', 'output_plot', 'output_pca']
2025-11-30 16:53:12,760 - INFO - [DEBUG] trajectory_anova result keys: ['anova_table', 'model', 'desc_stats', 'posthoc', 'data', 'pseudotime_col', 'n_samples', 'n_batches', 'n_severity_levels', 'model_type']
2025-11-30 16:53:12,760 - INFO - [DEBUG] batch_removal result keys: ['n_samples', 'batches', 'iLISI_mean', 'iLISI_std', 'iLISI_norm_mean', 'ASW_batch_overall', 'per_sample_path', 'summary_path']
2025-11-30 16:53:12,760 - INFO - [DEBUG] ari_clustering result keys: ['metrics', 'interpretation', 'n_samples', 'severity_levels', 'per_sample_path', 'summary_path', 'metrics_json_path']
2025-11-30 16:53:12,760 - INFO - [DEBUG] trajectory_analysis result keys: ['spearman_corr', 'spearman_p', 'n_samples', 'data', 'pseudotime_col']
2025-11-30 16:53:12,760 - INFO - [DEBUG] pseudotime_embeddings_custom result keys: ['paths', 'anova_anchor', 'anova_anchor_scipy', 'nn_gap_summary', 'nn_gap_per_sample']
2025-11-30 16:53:12,760 - INFO - [DEBUG] Collected metrics: {'n_samples': 200, 'batch_partial_eta_sq': 0.18305140277656873, 'severity_partial_eta_sq': 0.004644252512134033, 'interaction_partial_eta_sq': 0.6038373493746805, 'iLISI_norm': 0.14074969571739926, 'ASW_batch': 0.5804240355479667, 'ARI': -3.346980007323281e-05, 'NMI': 0.07298656698820317, 'Avg_Purity': np.float64(0.8481675392670157), 'Spearman_Correlation': np.float64(-0.604234230819044), 'Spearman_pval': np.float64(2.729293541195124e-21), 'Mean_NN_Severity_Gap': 1.2713178294573644, 'Custom_ANOVA_pval': np.float64(8.21836572210096e-16)}
2025-11-30 16:53:12,764 - INFO - Updated summary CSV at: /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv with column 'GEDI-200'
2025-11-30 16:53:12,765 - INFO - Initialized BenchmarkWrapper (explicit paths) with:
2025-11-30 16:53:12,765 - INFO -   Meta CSV:          /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 16:53:12,765 - INFO -   Pseudotime CSV:    /dcs07/hongkai/data/harry/result/GEDI/279_sample/trajectory/pseudotime_results.csv
2025-11-30 16:53:12,765 - INFO -   Embedding CSV:     /dcs07/hongkai/data/harry/result/GEDI/279_sample/gedi_sample_embedding.csv
2025-11-30 16:53:12,765 - INFO -   Method name:       GEDI
2025-11-30 16:53:12,765 - INFO -   Output base dir:   /dcs07/hongkai/data/harry/result/GEDI/279_sample
2025-11-30 16:53:12,765 - INFO -   Run output dir:    /dcs07/hongkai/data/harry/result/GEDI/279_sample/benchmark_results_GEDI
2025-11-30 16:53:12,765 - INFO -   Summary CSV:       /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv
2025-11-30 16:53:12,765 - INFO - 
==================================================
2025-11-30 16:53:12,765 - INFO - Running embedding_visualization...
2025-11-30 16:53:12,765 - INFO - ==================================================
2025-11-30 16:53:12,765 - INFO - Running Embedding Visualization...
2025-11-30 16:53:12,766 - INFO - Loading metadata from: /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 16:53:12,767 - INFO - Loading embeddings from: /dcs07/hongkai/data/harry/result/GEDI/279_sample/gedi_sample_embedding.csv
2025-11-30 16:53:12,769 - INFO - Performing PCA to 2 components...
2025-11-30 16:53:12,770 - INFO - Variance explained by PC1: 76.52%
2025-11-30 16:53:12,770 - INFO - Variance explained by PC2: 14.57%
2025-11-30 16:53:13,261 - INFO - Embedding visualization completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/279_sample/benchmark_results_GEDI/embedding_visualization
2025-11-30 16:53:13,261 - INFO - 
==================================================
2025-11-30 16:53:13,261 - INFO - Running trajectory_anova...
2025-11-30 16:53:13,261 - INFO - ==================================================
2025-11-30 16:53:13,261 - INFO - Running Trajectory ANOVA Analysis...
2025-11-30 16:53:13,488 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 16:53:13,490 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 16:53:13,491 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 16:53:14,677 - INFO - Trajectory ANOVA completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/279_sample/benchmark_results_GEDI/trajectory_anova
2025-11-30 16:53:14,677 - INFO - 
==================================================
2025-11-30 16:53:14,677 - INFO - Running batch_removal...
2025-11-30 16:53:14,677 - INFO - ==================================================
2025-11-30 16:53:14,677 - INFO - Running Batch Removal Evaluation...
Note: dropping 292 metadata rows without data match.
2025-11-30 16:53:14,699 - ERROR - Error in batch removal evaluation: Number of labels is 1. Valid values are 2 to n_samples - 1 (inclusive)
2025-11-30 16:53:14,699 - INFO - 
==================================================
2025-11-30 16:53:14,699 - INFO - Running ari_clustering...
2025-11-30 16:53:14,699 - INFO - ==================================================
2025-11-30 16:53:14,699 - INFO - Running ARI Clustering Evaluation...
Reading metadata and data files...
Found severity levels: [np.int64(1), np.int64(2), np.int64(3), np.int64(4)]
Loaded embedding with shape (249, 10) (samples × dimensions)
Note: dropping 292 metadata rows without data match.
Found 4 unique severity levels: [1 2 3 4]
Using 4 clusters for KNN clustering
Performing KNN clustering with k=20...
Computing ARI and other metrics...
Generating visualizations...
2025-11-30 16:53:15,447 - INFO - ARI clustering evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/279_sample/benchmark_results_GEDI/ari_clustering
2025-11-30 16:53:15,447 - INFO - 
==================================================
2025-11-30 16:53:15,447 - INFO - Running trajectory_analysis...
2025-11-30 16:53:15,447 - INFO - ==================================================
2025-11-30 16:53:15,448 - INFO - Running Trajectory Analysis...
2025-11-30 16:53:16,356 - INFO - Trajectory analysis completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/279_sample/benchmark_results_GEDI/trajectory_analysis
2025-11-30 16:53:16,356 - INFO - 
==================================================
2025-11-30 16:53:16,356 - INFO - Running pseudotime_embeddings_custom...
2025-11-30 16:53:16,356 - INFO - ==================================================
2025-11-30 16:53:16,356 - INFO - Running Custom Pseudotime Embeddings Benchmark (simple schema)...
2025-11-30 16:53:16,503 - INFO - [DEBUG] embedding_visualization result keys: ['variance_explained', 'n_samples', 'n_features', 'sev_level_range', 'unique_batches', 'batch_labels', 'output_plot', 'output_pca']
2025-11-30 16:53:16,503 - INFO - [DEBUG] trajectory_anova result keys: ['anova_table', 'model', 'desc_stats', 'posthoc', 'data', 'pseudotime_col', 'n_samples', 'n_batches', 'n_severity_levels', 'model_type']
2025-11-30 16:53:16,503 - WARNING - Skipping batch_removal in summary - status was not 'success'
2025-11-30 16:53:16,503 - INFO - [DEBUG] ari_clustering result keys: ['metrics', 'interpretation', 'n_samples', 'severity_levels', 'per_sample_path', 'summary_path', 'metrics_json_path']
2025-11-30 16:53:16,503 - INFO - [DEBUG] trajectory_analysis result keys: ['spearman_corr', 'spearman_p', 'n_samples', 'data', 'pseudotime_col']
2025-11-30 16:53:16,503 - INFO - [DEBUG] pseudotime_embeddings_custom result keys: ['paths', 'anova_anchor', 'anova_anchor_scipy', 'nn_gap_summary', 'nn_gap_per_sample']
2025-11-30 16:53:16,503 - INFO - [DEBUG] Collected metrics: {'n_samples': 249, 'severity_partial_eta_sq': 0.2972095619740956, 'ARI': 0.016779374409442112, 'NMI': 0.06189501100367326, 'Avg_Purity': np.float64(0.73109243697479), 'Spearman_Correlation': np.float64(-0.5461591385244751), 'Spearman_pval': np.float64(9.211031863724506e-21), 'Custom_ANOVA_pval': np.float64(1.1875341021027436e-18)}
2025-11-30 16:53:16,507 - INFO - Updated summary CSV at: /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv with column 'GEDI-249'
2025-11-30 16:53:16,508 - INFO - Initialized BenchmarkWrapper (explicit paths) with:
2025-11-30 16:53:16,508 - INFO -   Meta CSV:          /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 16:53:16,508 - INFO -   Pseudotime CSV:    /dcs07/hongkai/data/harry/result/GEDI/400_sample/trajectory/pseudotime_results.csv
2025-11-30 16:53:16,508 - INFO -   Embedding CSV:     /dcs07/hongkai/data/harry/result/GEDI/400_sample/gedi_sample_embedding.csv
2025-11-30 16:53:16,508 - INFO -   Method name:       GEDI
2025-11-30 16:53:16,508 - INFO -   Output base dir:   /dcs07/hongkai/data/harry/result/GEDI/400_sample
2025-11-30 16:53:16,508 - INFO -   Run output dir:    /dcs07/hongkai/data/harry/result/GEDI/400_sample/benchmark_results_GEDI
2025-11-30 16:53:16,508 - INFO -   Summary CSV:       /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv
2025-11-30 16:53:16,508 - INFO - 
==================================================
2025-11-30 16:53:16,508 - INFO - Running embedding_visualization...
2025-11-30 16:53:16,508 - INFO - ==================================================
2025-11-30 16:53:16,508 - INFO - Running Embedding Visualization...
2025-11-30 16:53:16,508 - INFO - Loading metadata from: /dcl01/hongkai/data/data/hjiang/Data/covid_data/sample_data.csv
2025-11-30 16:53:16,509 - INFO - Loading embeddings from: /dcs07/hongkai/data/harry/result/GEDI/400_sample/gedi_sample_embedding.csv
2025-11-30 16:53:16,512 - INFO - Performing PCA to 2 components...
2025-11-30 16:53:16,513 - INFO - Variance explained by PC1: 57.86%
2025-11-30 16:53:16,513 - INFO - Variance explained by PC2: 19.71%
2025-11-30 16:53:17,082 - INFO - Embedding visualization completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/400_sample/benchmark_results_GEDI/embedding_visualization
2025-11-30 16:53:17,083 - INFO - 
==================================================
2025-11-30 16:53:17,083 - INFO - Running trajectory_anova...
2025-11-30 16:53:17,083 - INFO - ==================================================
2025-11-30 16:53:17,083 - INFO - Running Trajectory ANOVA Analysis...
2025-11-30 16:53:17,175 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 16:53:17,178 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 16:53:17,179 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-11-30 16:53:18,920 - INFO - Trajectory ANOVA completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/400_sample/benchmark_results_GEDI/trajectory_anova
2025-11-30 16:53:18,920 - INFO - 
==================================================
2025-11-30 16:53:18,920 - INFO - Running batch_removal...
2025-11-30 16:53:18,920 - INFO - ==================================================
2025-11-30 16:53:18,920 - INFO - Running Batch Removal Evaluation...
Note: dropping 136 metadata rows without data match.
2025-11-30 16:53:18,951 - INFO - Batch removal evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/400_sample/benchmark_results_GEDI/batch_removal
2025-11-30 16:53:18,951 - INFO - 
==================================================
2025-11-30 16:53:18,951 - INFO - Running ari_clustering...
2025-11-30 16:53:18,951 - INFO - ==================================================
2025-11-30 16:53:18,951 - INFO - Running ARI Clustering Evaluation...
Reading metadata and data files...
Found severity levels: [np.int64(1), np.int64(2), np.int64(3), np.int64(4)]
Loaded embedding with shape (405, 10) (samples × dimensions)
Note: dropping 136 metadata rows without data match.
Found 4 unique severity levels: [1 2 3 4]
Using 4 clusters for KNN clustering
Performing KNN clustering with k=20...
Computing ARI and other metrics...
Generating visualizations...
2025-11-30 16:53:19,758 - INFO - ARI clustering evaluation completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/400_sample/benchmark_results_GEDI/ari_clustering
2025-11-30 16:53:19,758 - INFO - 
==================================================
2025-11-30 16:53:19,758 - INFO - Running trajectory_analysis...
2025-11-30 16:53:19,758 - INFO - ==================================================
2025-11-30 16:53:19,758 - INFO - Running Trajectory Analysis...
2025-11-30 16:53:20,588 - INFO - Trajectory analysis completed. Results saved to: /dcs07/hongkai/data/harry/result/GEDI/400_sample/benchmark_results_GEDI/trajectory_analysis
2025-11-30 16:53:20,588 - INFO - 
==================================================
2025-11-30 16:53:20,588 - INFO - Running pseudotime_embeddings_custom...
2025-11-30 16:53:20,588 - INFO - ==================================================
2025-11-30 16:53:20,588 - INFO - Running Custom Pseudotime Embeddings Benchmark (simple schema)...
2025-11-30 16:53:20,870 - INFO - [DEBUG] embedding_visualization result keys: ['variance_explained', 'n_samples', 'n_features', 'sev_level_range', 'unique_batches', 'batch_labels', 'output_plot', 'output_pca']
2025-11-30 16:53:20,870 - INFO - [DEBUG] trajectory_anova result keys: ['anova_table', 'model', 'desc_stats', 'posthoc', 'data', 'pseudotime_col', 'n_samples', 'n_batches', 'n_severity_levels', 'model_type']
2025-11-30 16:53:20,871 - INFO - [DEBUG] batch_removal result keys: ['n_samples', 'batches', 'iLISI_mean', 'iLISI_std', 'iLISI_norm_mean', 'ASW_batch_overall', 'per_sample_path', 'summary_path']
2025-11-30 16:53:20,871 - INFO - [DEBUG] ari_clustering result keys: ['metrics', 'interpretation', 'n_samples', 'severity_levels', 'per_sample_path', 'summary_path', 'metrics_json_path']
2025-11-30 16:53:20,871 - INFO - [DEBUG] trajectory_analysis result keys: ['spearman_corr', 'spearman_p', 'n_samples', 'data', 'pseudotime_col']
2025-11-30 16:53:20,871 - INFO - [DEBUG] pseudotime_embeddings_custom result keys: ['paths', 'anova_anchor', 'anova_anchor_scipy', 'nn_gap_summary', 'nn_gap_per_sample']
2025-11-30 16:53:20,871 - INFO - [DEBUG] Collected metrics: {'n_samples': 405, 'batch_partial_eta_sq': 0.053723489537904186, 'severity_partial_eta_sq': 0.009600020184108904, 'interaction_partial_eta_sq': 0.23303875027391174, 'iLISI_norm': 0.13862647575608028, 'ASW_batch': 0.5743028849402362, 'ARI': -0.0008797968900620319, 'NMI': 0.03665924860613901, 'Avg_Purity': np.float64(0.805414551607445), 'Spearman_Correlation': np.float64(-0.48276552549174), 'Spearman_pval': np.float64(4.908518015128545e-25), 'Mean_NN_Severity_Gap': 1.0883534136546185, 'Custom_ANOVA_pval': np.float64(3.4279469337673773e-18)}
2025-11-30 16:53:20,875 - INFO - Updated summary CSV at: /dcs07/hongkai/data/harry/result/benchmark_summary_all_methods.csv with column 'GEDI-405'
