
============================================================
Evaluating method: SD_expression
============================================================
Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/lutea/embeddings/sample_expression_embedding.csv

============================================================
DEBUG: align_data() function
============================================================

1. Input sizes:
   - Metadata: 48 samples
   - Embedding: 24 samples

2. Sample name examples (first 5):
   - Metadata index: ['10w_FR_RNA', '10w_FR_ATAC', '10w_NR_RNA', '10w_NR_ATAC', '11w2d_FR_RNA']
   - Embedding index: ['10w_FR_ATAC', '10w_FR_RNA', '11w2d_FR_ATAC', '11w2d_FR_RNA', '12w3d_FR_ATAC']

3. Alignment results:
   - Common samples: 24
   - Dropping 24 metadata rows without embedding

4. Aligned datasets:
   - Total aligned samples: 24
   - First 5 aligned sample names: ['10w_FR_ATAC', '10w_FR_RNA', '11w2d_FR_ATAC', '11w2d_FR_RNA', '12w3d_FR_ATAC']
============================================================

Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  CCA score (PC1 & PC2): 0.9442
  Pseudotime-age correlation: 0.9442

4. Running permutation tests...
   - Paired distance permutation test...
   - Modality mixing permutation test...
   - Trajectory CCA permutation test...

5. Creating visualizations...
   - Modality plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/SD_expression/visualizations/SD_expression_by_modality.png
   - Paired connections plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/SD_expression/visualizations/SD_expression_paired_connections.png
   - Trajectory embedding plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/SD_expression/visualizations/SD_expression_trajectory_embedding.png
   - Trajectory scatter plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/SD_expression/visualizations/SD_expression_trajectory_scatter.png

============================================================
Multimodal Integration Evaluation: SD_expression
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10
Permutations: 1000

--- KEY METRICS ---

1. Mean Paired Distance (lower = better)
   Value: 12.8480
   P-value: 0.00e+00

2. ASW Modality (higher = better)
   Value: 0.5025
   P-value: 5.23e-01

3. Trajectory CCA Score (higher = better)
   Value: 0.9442
   P-value: 0.00e+00

--- ADDITIONAL DETAILS ---

Paired Sample Distance:
  Number of pairs: 12
  Std paired distance: 8.8650
  Median paired distance: 9.7791

Modality Mixing:
  Modalities: ['ATAC', 'RNA']
  iLISI mean: 1.3333
  iLISI normalized: 0.6667
  iLISI P-value: 9.42e-01

Trajectory Analysis:
  Age column: age
  Age range: 70.0 - 165.0
  CCA score: 0.9442
  Pseudotime-age correlation: 0.9442

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/SD_expression
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/summary.csv with column 'SD_expression'

============================================================
Evaluating method: SD_proportion
============================================================
Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/lutea/embeddings/sample_proportion_embedding.csv

============================================================
DEBUG: align_data() function
============================================================

1. Input sizes:
   - Metadata: 48 samples
   - Embedding: 24 samples

2. Sample name examples (first 5):
   - Metadata index: ['10w_FR_RNA', '10w_FR_ATAC', '10w_NR_RNA', '10w_NR_ATAC', '11w2d_FR_RNA']
   - Embedding index: ['10w_fr_atac', '10w_fr_rna', '11w2d_fr_atac', '11w2d_fr_rna', '12w3d_fr_atac']

3. Alignment results:
   - Common samples: 24
   - Dropping 24 metadata rows without embedding

4. Aligned datasets:
   - Total aligned samples: 24
   - First 5 aligned sample names: ['10w_fr_atac', '10w_fr_rna', '11w2d_fr_atac', '11w2d_fr_rna', '12w3d_fr_atac']
============================================================

Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  CCA score (PC1 & PC2): 0.9775
  Pseudotime-age correlation: -0.9764

4. Running permutation tests...
   - Paired distance permutation test...
   - Modality mixing permutation test...
   - Trajectory CCA permutation test...

5. Creating visualizations...
   - Modality plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/SD_proportion/visualizations/SD_proportion_by_modality.png
   - Paired connections plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/SD_proportion/visualizations/SD_proportion_paired_connections.png
   - Trajectory embedding plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/SD_proportion/visualizations/SD_proportion_trajectory_embedding.png
   - Trajectory scatter plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/SD_proportion/visualizations/SD_proportion_trajectory_scatter.png

============================================================
Multimodal Integration Evaluation: SD_proportion
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10
Permutations: 1000

--- KEY METRICS ---

1. Mean Paired Distance (lower = better)
   Value: 0.0759
   P-value: 0.00e+00

2. ASW Modality (higher = better)
   Value: 0.5319
   P-value: 5.00e-03

3. Trajectory CCA Score (higher = better)
   Value: 0.9775
   P-value: 0.00e+00

--- ADDITIONAL DETAILS ---

Paired Sample Distance:
  Number of pairs: 12
  Std paired distance: 0.0476
  Median paired distance: 0.0603

Modality Mixing:
  Modalities: ['ATAC', 'RNA']
  iLISI mean: 1.6250
  iLISI normalized: 0.8125
  iLISI P-value: 2.44e-01

Trajectory Analysis:
  Age column: age
  Age range: 70.0 - 165.0
  CCA score: 0.9775
  Pseudotime-age correlation: -0.9764

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/SD_proportion
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/summary.csv with column 'SD_proportion'

============================================================
Evaluating method: pilot
============================================================
Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/pilot/wasserstein_distance_mds_10d.csv

============================================================
DEBUG: align_data() function
============================================================

1. Input sizes:
   - Metadata: 48 samples
   - Embedding: 24 samples

2. Sample name examples (first 5):
   - Metadata index: ['10w_FR_RNA', '10w_FR_ATAC', '10w_NR_RNA', '10w_NR_ATAC', '11w2d_FR_RNA']
   - Embedding index: ['13W_FR_RNA', '10w_FR_RNA', '20w1d_FR_RNA', '23w1d_FR_RNA', '16w4d_FR_RNA']

3. Alignment results:
   - Common samples: 24
   - Dropping 24 metadata rows without embedding

4. Aligned datasets:
   - Total aligned samples: 24
   - First 5 aligned sample names: ['10w_FR_ATAC', '10w_FR_RNA', '11w2d_FR_ATAC', '11w2d_FR_RNA', '12w3d_FR_ATAC']
============================================================

Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  CCA score (PC1 & PC2): 0.8717
  Pseudotime-age correlation: -0.8574

4. Running permutation tests...
   - Paired distance permutation test...
   - Modality mixing permutation test...
   - Trajectory CCA permutation test...

5. Creating visualizations...
   - Modality plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/pilot/visualizations/pilot_by_modality.png
   - Paired connections plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/pilot/visualizations/pilot_paired_connections.png
   - Trajectory embedding plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/pilot/visualizations/pilot_trajectory_embedding.png
   - Trajectory scatter plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/pilot/visualizations/pilot_trajectory_scatter.png

============================================================
Multimodal Integration Evaluation: pilot
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10
Permutations: 1000

--- KEY METRICS ---

1. Mean Paired Distance (lower = better)
   Value: 0.5890
   P-value: 9.99e-01

2. ASW Modality (higher = better)
   Value: 0.1211
   P-value: 1.00e+00

3. Trajectory CCA Score (higher = better)
   Value: 0.8717
   P-value: 0.00e+00

--- ADDITIONAL DETAILS ---

Paired Sample Distance:
  Number of pairs: 12
  Std paired distance: 0.0676
  Median paired distance: 0.5793

Modality Mixing:
  Modalities: ['ATAC', 'RNA']
  iLISI mean: 1.0000
  iLISI normalized: 0.5000
  iLISI P-value: 1.00e+00

Trajectory Analysis:
  Age column: age
  Age range: 70.0 - 165.0
  CCA score: 0.8717
  Pseudotime-age correlation: -0.8574

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/pilot
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/summary.csv with column 'pilot'

============================================================
Evaluating method: pseudobulk
============================================================
Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/pseudobulk/pseudobulk/pca_embeddings.csv

============================================================
DEBUG: align_data() function
============================================================

1. Input sizes:
   - Metadata: 48 samples
   - Embedding: 24 samples

2. Sample name examples (first 5):
   - Metadata index: ['10w_FR_RNA', '10w_FR_ATAC', '10w_NR_RNA', '10w_NR_ATAC', '11w2d_FR_RNA']
   - Embedding index: ['10w_FR_ATAC', '10w_FR_RNA', '11w2d_FR_ATAC', '11w2d_FR_RNA', '12w3d_FR_ATAC']

3. Alignment results:
   - Common samples: 24
   - Dropping 24 metadata rows without embedding

4. Aligned datasets:
   - Total aligned samples: 24
   - First 5 aligned sample names: ['10w_FR_ATAC', '10w_FR_RNA', '11w2d_FR_ATAC', '11w2d_FR_RNA', '12w3d_FR_ATAC']
============================================================

Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  CCA score (PC1 & PC2): 0.8349
  Pseudotime-age correlation: 0.8334

4. Running permutation tests...
   - Paired distance permutation test...
   - Modality mixing permutation test...
   - Trajectory CCA permutation test...

5. Creating visualizations...
   - Modality plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/pseudobulk/visualizations/pseudobulk_by_modality.png
   - Paired connections plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/pseudobulk/visualizations/pseudobulk_paired_connections.png
   - Trajectory embedding plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/pseudobulk/visualizations/pseudobulk_trajectory_embedding.png
   - Trajectory scatter plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/pseudobulk/visualizations/pseudobulk_trajectory_scatter.png

============================================================
Multimodal Integration Evaluation: pseudobulk
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10
Permutations: 1000

--- KEY METRICS ---

1. Mean Paired Distance (lower = better)
   Value: 33.0818
   P-value: 9.99e-01

2. ASW Modality (higher = better)
   Value: 0.1583
   P-value: 1.00e+00

3. Trajectory CCA Score (higher = better)
   Value: 0.8349
   P-value: 0.00e+00

--- ADDITIONAL DETAILS ---

Paired Sample Distance:
  Number of pairs: 12
  Std paired distance: 3.2426
  Median paired distance: 32.5832

Modality Mixing:
  Modalities: ['ATAC', 'RNA']
  iLISI mean: 1.0000
  iLISI normalized: 0.5000
  iLISI P-value: 1.00e+00

Trajectory Analysis:
  Age column: age
  Age range: 70.0 - 165.0
  CCA score: 0.8349
  Pseudotime-age correlation: 0.8334

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/pseudobulk
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/summary.csv with column 'pseudobulk'

============================================================
Evaluating method: QOT
============================================================
Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/QOT/24_qot_distance_matrix_mds_10d.csv

============================================================
DEBUG: align_data() function
============================================================

1. Input sizes:
   - Metadata: 48 samples
   - Embedding: 24 samples

2. Sample name examples (first 5):
   - Metadata index: ['10w_FR_RNA', '10w_FR_ATAC', '10w_NR_RNA', '10w_NR_ATAC', '11w2d_FR_RNA']
   - Embedding index: ['10w_FR_ATAC', '10w_FR_RNA', '11w2d_FR_ATAC', '11w2d_FR_RNA', '12w3d_FR_ATAC']

3. Alignment results:
   - Common samples: 24
   - Dropping 24 metadata rows without embedding

4. Aligned datasets:
   - Total aligned samples: 24
   - First 5 aligned sample names: ['10w_FR_ATAC', '10w_FR_RNA', '11w2d_FR_ATAC', '11w2d_FR_RNA', '12w3d_FR_ATAC']
============================================================

Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  CCA score (PC1 & PC2): 0.9006
  Pseudotime-age correlation: -0.8872

4. Running permutation tests...
   - Paired distance permutation test...
   - Modality mixing permutation test...
   - Trajectory CCA permutation test...

5. Creating visualizations...
   - Modality plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/QOT/visualizations/QOT_by_modality.png
   - Paired connections plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/QOT/visualizations/QOT_paired_connections.png
   - Trajectory embedding plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/QOT/visualizations/QOT_trajectory_embedding.png
   - Trajectory scatter plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/QOT/visualizations/QOT_trajectory_scatter.png

============================================================
Multimodal Integration Evaluation: QOT
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10
Permutations: 1000

--- KEY METRICS ---

1. Mean Paired Distance (lower = better)
   Value: 0.2583
   P-value: 0.00e+00

2. ASW Modality (higher = better)
   Value: 0.5280
   P-value: 1.07e-01

3. Trajectory CCA Score (higher = better)
   Value: 0.9006
   P-value: 0.00e+00

--- ADDITIONAL DETAILS ---

Paired Sample Distance:
  Number of pairs: 12
  Std paired distance: 0.1150
  Median paired distance: 0.2408

Modality Mixing:
  Modalities: ['ATAC', 'RNA']
  iLISI mean: 1.6250
  iLISI normalized: 0.8125
  iLISI P-value: 2.84e-01

Trajectory Analysis:
  Age column: age
  Age range: 70.0 - 165.0
  CCA score: 0.9006
  Pseudotime-age correlation: -0.8872

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/QOT
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/summary.csv with column 'QOT'

============================================================
Evaluating method: GEDI
============================================================
Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/GEDI/gedi_sample_embedding.csv

============================================================
DEBUG: align_data() function
============================================================

1. Input sizes:
   - Metadata: 48 samples
   - Embedding: 24 samples

2. Sample name examples (first 5):
   - Metadata index: ['10w_FR_RNA', '10w_FR_ATAC', '10w_NR_RNA', '10w_NR_ATAC', '11w2d_FR_RNA']
   - Embedding index: ['10w_FR_ATAC', '10w_FR_RNA', '11w2d_FR_ATAC', '11w2d_FR_RNA', '12w3d_FR_ATAC']

3. Alignment results:
   - Common samples: 24
   - Dropping 24 metadata rows without embedding

4. Aligned datasets:
   - Total aligned samples: 24
   - First 5 aligned sample names: ['10w_FR_ATAC', '10w_FR_RNA', '11w2d_FR_ATAC', '11w2d_FR_RNA', '12w3d_FR_ATAC']
============================================================

Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  CCA score (PC1 & PC2): 0.3925
  Pseudotime-age correlation: 0.3698

4. Running permutation tests...
   - Paired distance permutation test...
   - Modality mixing permutation test...
   - Trajectory CCA permutation test...

5. Creating visualizations...
   - Modality plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/GEDI/visualizations/GEDI_by_modality.png
   - Paired connections plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/GEDI/visualizations/GEDI_paired_connections.png
   - Trajectory embedding plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/GEDI/visualizations/GEDI_trajectory_embedding.png
   - Trajectory scatter plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/GEDI/visualizations/GEDI_trajectory_scatter.png

============================================================
Multimodal Integration Evaluation: GEDI
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10
Permutations: 1000

--- KEY METRICS ---

1. Mean Paired Distance (lower = better)
   Value: 3.2161
   P-value: 9.99e-01

2. ASW Modality (higher = better)
   Value: 0.1972
   P-value: 1.00e+00

3. Trajectory CCA Score (higher = better)
   Value: 0.3925
   P-value: 1.64e-01

--- ADDITIONAL DETAILS ---

Paired Sample Distance:
  Number of pairs: 12
  Std paired distance: 0.5459
  Median paired distance: 3.1526

Modality Mixing:
  Modalities: ['ATAC', 'RNA']
  iLISI mean: 1.0000
  iLISI normalized: 0.5000
  iLISI P-value: 1.00e+00

Trajectory Analysis:
  Age column: age
  Age range: 70.0 - 165.0
  CCA score: 0.3925
  Pseudotime-age correlation: 0.3698

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/GEDI
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/summary.csv with column 'GEDI'

============================================================
Evaluating method: Gloscope
============================================================
Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Gloscope/knn_divergence_mds_10d.csv

============================================================
DEBUG: align_data() function
============================================================

1. Input sizes:
   - Metadata: 48 samples
   - Embedding: 24 samples

2. Sample name examples (first 5):
   - Metadata index: ['10w_FR_RNA', '10w_FR_ATAC', '10w_NR_RNA', '10w_NR_ATAC', '11w2d_FR_RNA']
   - Embedding index: ['13W_FR_RNA', '10w_FR_RNA', '20w1d_FR_RNA', '23w1d_FR_RNA', '16w4d_FR_RNA']

3. Alignment results:
   - Common samples: 24
   - Dropping 24 metadata rows without embedding

4. Aligned datasets:
   - Total aligned samples: 24
   - First 5 aligned sample names: ['10w_FR_ATAC', '10w_FR_RNA', '11w2d_FR_ATAC', '11w2d_FR_RNA', '12w3d_FR_ATAC']
============================================================

Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  CCA score (PC1 & PC2): 0.7513
  Pseudotime-age correlation: -0.7513

4. Running permutation tests...
   - Paired distance permutation test...
   - Modality mixing permutation test...
   - Trajectory CCA permutation test...

5. Creating visualizations...
   - Modality plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/Gloscope/visualizations/Gloscope_by_modality.png
   - Paired connections plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/Gloscope/visualizations/Gloscope_paired_connections.png
   - Trajectory embedding plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/Gloscope/visualizations/Gloscope_trajectory_embedding.png
   - Trajectory scatter plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/Gloscope/visualizations/Gloscope_trajectory_scatter.png

============================================================
Multimodal Integration Evaluation: Gloscope
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10
Permutations: 1000

--- KEY METRICS ---

1. Mean Paired Distance (lower = better)
   Value: 57.7641
   P-value: 9.99e-01

2. ASW Modality (higher = better)
   Value: 0.1387
   P-value: 1.00e+00

3. Trajectory CCA Score (higher = better)
   Value: 0.7513
   P-value: 0.00e+00

--- ADDITIONAL DETAILS ---

Paired Sample Distance:
  Number of pairs: 12
  Std paired distance: 5.3848
  Median paired distance: 56.7271

Modality Mixing:
  Modalities: ['ATAC', 'RNA']
  iLISI mean: 1.0000
  iLISI normalized: 0.5000
  iLISI P-value: 1.00e+00

Trajectory Analysis:
  Age column: age
  Age range: 70.0 - 165.0
  CCA score: 0.7513
  Pseudotime-age correlation: -0.7513

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/Gloscope
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/summary.csv with column 'Gloscope'

============================================================
Evaluating method: MFA
============================================================
Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/MFA/sample_embeddings.csv

============================================================
DEBUG: align_data() function
============================================================

1. Input sizes:
   - Metadata: 48 samples
   - Embedding: 24 samples

2. Sample name examples (first 5):
   - Metadata index: ['10w_FR_RNA', '10w_FR_ATAC', '10w_NR_RNA', '10w_NR_ATAC', '11w2d_FR_RNA']
   - Embedding index: ['13W_FR_RNA', '16w4d_FR_RNA', '12w3d_FR_RNA', '11w2d_FR_RNA', '14w2d_FR_RNA']

3. Alignment results:
   - Common samples: 24
   - Dropping 24 metadata rows without embedding

4. Aligned datasets:
   - Total aligned samples: 24
   - First 5 aligned sample names: ['10w_FR_ATAC', '10w_FR_RNA', '11w2d_FR_ATAC', '11w2d_FR_RNA', '12w3d_FR_ATAC']
============================================================

Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  CCA score (PC1 & PC2): 0.6937
  Pseudotime-age correlation: 0.6908

4. Running permutation tests...
   - Paired distance permutation test...
   - Modality mixing permutation test...
   - Trajectory CCA permutation test...

5. Creating visualizations...
   - Modality plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/MFA/visualizations/MFA_by_modality.png
   - Paired connections plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/MFA/visualizations/MFA_paired_connections.png
   - Trajectory embedding plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/MFA/visualizations/MFA_trajectory_embedding.png
   - Trajectory scatter plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/MFA/visualizations/MFA_trajectory_scatter.png

============================================================
Multimodal Integration Evaluation: MFA
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10
Permutations: 1000

--- KEY METRICS ---

1. Mean Paired Distance (lower = better)
   Value: 3.7068
   P-value: 9.99e-01

2. ASW Modality (higher = better)
   Value: 0.1112
   P-value: 1.00e+00

3. Trajectory CCA Score (higher = better)
   Value: 0.6937
   P-value: 1.00e-03

--- ADDITIONAL DETAILS ---

Paired Sample Distance:
  Number of pairs: 12
  Std paired distance: 0.1288
  Median paired distance: 3.6851

Modality Mixing:
  Modalities: ['ATAC', 'RNA']
  iLISI mean: 1.0000
  iLISI normalized: 0.5000
  iLISI P-value: 1.00e+00

Trajectory Analysis:
  Age column: age
  Age range: 70.0 - 165.0
  CCA score: 0.6937
  Pseudotime-age correlation: 0.6908

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/MFA
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/summary.csv with column 'MFA'

============================================================
Evaluating method: mustard
============================================================
Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/mustard/sample_embedding.csv

============================================================
DEBUG: align_data() function
============================================================

1. Input sizes:
   - Metadata: 48 samples
   - Embedding: 24 samples

2. Sample name examples (first 5):
   - Metadata index: ['10w_FR_RNA', '10w_FR_ATAC', '10w_NR_RNA', '10w_NR_ATAC', '11w2d_FR_RNA']
   - Embedding index: ['13W_FR_RNA', '10w_FR_RNA', '20w1d_FR_RNA', '16w4d_FR_RNA', '11w2d_FR_RNA']

3. Alignment results:
   - Common samples: 24
   - Dropping 24 metadata rows without embedding

4. Aligned datasets:
   - Total aligned samples: 24
   - First 5 aligned sample names: ['10w_FR_ATAC', '10w_FR_RNA', '11w2d_FR_ATAC', '11w2d_FR_RNA', '12w3d_FR_ATAC']
============================================================

Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  CCA score (PC1 & PC2): 0.7629
  Pseudotime-age correlation: 0.7375

4. Running permutation tests...
   - Paired distance permutation test...
   - Modality mixing permutation test...
   - Trajectory CCA permutation test...

5. Creating visualizations...
   - Modality plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/mustard/visualizations/mustard_by_modality.png
   - Paired connections plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/mustard/visualizations/mustard_paired_connections.png
   - Trajectory embedding plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/mustard/visualizations/mustard_trajectory_embedding.png
   - Trajectory scatter plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/mustard/visualizations/mustard_trajectory_scatter.png

============================================================
Multimodal Integration Evaluation: mustard
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10
Permutations: 1000

--- KEY METRICS ---

1. Mean Paired Distance (lower = better)
   Value: 0.7775
   P-value: 1.00e+00

2. ASW Modality (higher = better)
   Value: 0.1503
   P-value: 1.00e+00

3. Trajectory CCA Score (higher = better)
   Value: 0.7629
   P-value: 0.00e+00

--- ADDITIONAL DETAILS ---

Paired Sample Distance:
  Number of pairs: 12
  Std paired distance: 0.1219
  Median paired distance: 0.7155

Modality Mixing:
  Modalities: ['ATAC', 'RNA']
  iLISI mean: 1.0000
  iLISI normalized: 0.5000
  iLISI P-value: 1.00e+00

Trajectory Analysis:
  Age column: age
  Age range: 70.0 - 165.0
  CCA score: 0.7629
  Pseudotime-age correlation: 0.7375

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/mustard
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/summary.csv with column 'mustard'

============================================================
Evaluating method: scPoli
============================================================
Loading metadata from: /dcs07/hongkai/data/harry/result/multi_omics_eye/data/scMultiomics_database.csv
Expanded metadata from 24 samples to 48 samples (2 modalities)
Loading embedding from: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/scPoli/sample_embeddings_full.csv

============================================================
DEBUG: align_data() function
============================================================

1. Input sizes:
   - Metadata: 48 samples
   - Embedding: 24 samples

2. Sample name examples (first 5):
   - Metadata index: ['10w_FR_RNA', '10w_FR_ATAC', '10w_NR_RNA', '10w_NR_ATAC', '11w2d_FR_RNA']
   - Embedding index: ['13W_FR_RNA', '10w_FR_RNA', '20w1d_FR_RNA', '23w1d_FR_RNA', '16w4d_FR_RNA']

3. Alignment results:
   - Common samples: 24
   - Dropping 24 metadata rows without embedding

4. Aligned datasets:
   - Total aligned samples: 24
   - First 5 aligned sample names: ['10w_FR_ATAC', '10w_FR_RNA', '11w2d_FR_ATAC', '11w2d_FR_RNA', '12w3d_FR_ATAC']
============================================================

Aligned data: 24 samples, 10 dimensions
Detected modalities: ['ATAC', 'RNA']
Number of unique biological samples: 12
Age range: 70.0 - 165.0

1. Computing paired sample distances...

2. Computing modality mixing (iLISI, ASW)...

3. Computing trajectory analysis (age) using PC1 & PC2...
  CCA score (PC1 & PC2): 0.3005
  Pseudotime-age correlation: 0.2965

4. Running permutation tests...
   - Paired distance permutation test...
   - Modality mixing permutation test...
   - Trajectory CCA permutation test...

5. Creating visualizations...
   - Modality plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/scPoli/visualizations/scPoli_by_modality.png
   - Paired connections plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/scPoli/visualizations/scPoli_paired_connections.png
   - Trajectory embedding plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/scPoli/visualizations/scPoli_trajectory_embedding.png
   - Trajectory scatter plot: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/scPoli/visualizations/scPoli_trajectory_scatter.png

============================================================
Multimodal Integration Evaluation: scPoli
============================================================

Total samples: 24
Unique biological samples: 12
Modalities: ['ATAC', 'RNA']
Embedding dimensions: 10
Permutations: 1000

--- KEY METRICS ---

1. Mean Paired Distance (lower = better)
   Value: 1.3166
   P-value: 9.75e-01

2. ASW Modality (higher = better)
   Value: 0.3327
   P-value: 1.00e+00

3. Trajectory CCA Score (higher = better)
   Value: 0.3005
   P-value: 3.84e-01

--- ADDITIONAL DETAILS ---

Paired Sample Distance:
  Number of pairs: 12
  Std paired distance: 0.0876
  Median paired distance: 1.3223

Modality Mixing:
  Modalities: ['ATAC', 'RNA']
  iLISI mean: 1.0000
  iLISI normalized: 0.5000
  iLISI P-value: 1.00e+00

Trajectory Analysis:
  Age column: age
  Age range: 70.0 - 165.0
  CCA score: 0.3005
  Pseudotime-age correlation: 0.2965

============================================================
Results saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/scPoli
============================================================

Updated summary CSV: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/summary.csv with column 'scPoli'

============================================================
Benchmark suite completed!
Summary saved to: /dcs07/hongkai/data/harry/result/multi_omics_eye/benchmark_lutea/Benchmark_result/summary.csv
============================================================
