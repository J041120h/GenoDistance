Linux system detected with GPU enabled.
Error reading status file: Expecting value: line 1 column 1 (char 0)
Reinitializing status from scratch.

============================================================
RUNNING RNA PIPELINE
============================================================
Starting RNA wrapper function with provided parameters...
Starting cell type clustering...
[cell_types] No cell type annotation found. Performing clustering.
[cell_types] Building neighborhood graph...
[cell_types] No target clusters specified. Using standard Leiden clustering (resolution=0.6)...
[cell_types] Found 11 clusters after Leiden clustering.
[cell_types] Finished assigning cell types.
[cell_types] Computing UMAP...
[cell_types] Converting GPU arrays to CPU...
[cell_types] Generating UMAP visualizations...
[generate_umap_visualizations] Generating UMAP plots...
[generate_umap_visualizations] → Plotting UMAP colored by 'cell_type' (11 categories)
[generate_umap_visualizations] ✓ Saved: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/preprocess/umap_cell_type.png
[cell_types] Total runtime: 6.03 seconds
[safe_h5ad_write] Preparing to save to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/preprocess/adata_sample.h5ad
[clean_obs_for_saving] Cleaning observation metadata for H5AD compatibility...
[clean_obs_for_saving] Cleaning completed successfully
[clean_obs_for_saving] 11 categorical columns processed
[safe_h5ad_write] Writing H5AD file...
[safe_h5ad_write] Successfully saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/preprocess/adata_sample.h5ad
Reading Pseudobulk from provided or default path: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/pseudobulk/pseudobulk_sample.h5ad
Starting trajectory analysis...

Processing X_DR_proportion...
Using default PC1 + PC2: CCA score = 0.3385
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/CCA/pca_2d_cca_proportion.pdf

Processing X_DR_expression...
Using default PC1 + PC2: CCA score = 0.2846
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/CCA/pca_2d_cca_expression.pdf
Saved proportion pseudotime data to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/CCA/pseudotime_proportion.csv
Saved expression pseudotime data to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/CCA/pseudotime_expression.csv

==================================================
CCA ANALYSIS SUMMARY
==================================================
X_DR_proportion: CCA score = 0.3385 (using PC1 + PC2)
X_DR_expression: CCA score = 0.2846 (using PC1 + PC2)

Total runtime: 3.66 seconds
==================================================
P-value for observed correlation 0.3385494285008944: 0.271
[CCA p-test] Runtime: 2.53 seconds
P-value for observed correlation 0.28460172986647997: 0.436
[CCA p-test] Runtime: 2.30 seconds
🚀 Using PROFILED GPU version of optimal resolution WITH TIMEOUT PROTECTION
⏰ Timeout per resolution: 3600 seconds (1.0 hours)
⏱️  Directory setup: 0.38 seconds

📊 Starting RNA-seq resolution optimization with detailed timing...
Using representation: X_pca with 20 components
Using 10 PCs for CCA analysis
Will compute corrected p-values with 1000 simulations per resolution

🔍 === FIRST PASS: Coarse Search ===

🎯 Testing resolution: 0.100
  ⏱️  Cleanup: 0.004 seconds
⏱️    🧬 Cell clustering: 3.32 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 5
⏱️    🧪 Pseudobulk computation: 12.60 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.3659 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3348
PC1 + PC3: CCA score = 0.2799
PC1 + PC4: CCA score = 0.2792
PC1 + PC5: CCA score = 0.2733
PC2 + PC3: CCA score = 0.2258
PC2 + PC4: CCA score = 0.2249
PC2 + PC5: CCA score = 0.2175
PC3 + PC4: CCA score = 0.1299
PC3 + PC5: CCA score = 0.1167
PC4 + PC5: CCA score = 0.1148
Best combination: PC1 + PC2 with score 0.3348
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.100/cca_plot_res_0.100.png
  ⏱️  CCA plot generation: 1.378 seconds
  📊 Created CCA visualization using PC1 + PC2 (viz score: 0.3348)
⏱️    🎲 Null distribution (1000 sims): 1.62 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.7160
  ⏱️  TOTAL for resolution 0.100: 19.41 seconds

🎯 Testing resolution: 0.200
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 3.54 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 5
⏱️    🧪 Pseudobulk computation: 12.56 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.3803 (using 5 PCs)
Auto-selecting best 2-PC combination from 5 components...
Testing 10 PC combinations...
PC1 + PC2: CCA score = 0.3339
PC1 + PC3: CCA score = 0.2807
PC1 + PC4: CCA score = 0.2826
PC1 + PC5: CCA score = 0.2895
PC2 + PC3: CCA score = 0.2252
PC2 + PC4: CCA score = 0.2275
PC2 + PC5: CCA score = 0.2360
PC3 + PC4: CCA score = 0.1382
PC3 + PC5: CCA score = 0.1518
PC4 + PC5: CCA score = 0.1553
Best combination: PC1 + PC2 with score 0.3339
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.200/cca_plot_res_0.200.png
  ⏱️  CCA plot generation: 1.430 seconds
  📊 Created CCA visualization using PC1 + PC2 (viz score: 0.3339)
⏱️    🎲 Null distribution (1000 sims): 1.47 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.6750
  ⏱️  TOTAL for resolution 0.200: 19.02 seconds

🎯 Testing resolution: 0.300
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 3.41 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 8
⏱️    🧪 Pseudobulk computation: 18.87 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.6303 (using 8 PCs)
Auto-selecting best 2-PC combination from 8 components...
Testing 28 PC combinations...
PC1 + PC2: CCA score = 0.3106
PC1 + PC3: CCA score = 0.2994
PC1 + PC4: CCA score = 0.3656
PC1 + PC5: CCA score = 0.2831
PC1 + PC6: CCA score = 0.4941
PC1 + PC7: CCA score = 0.3832
PC1 + PC8: CCA score = 0.2917
PC2 + PC3: CCA score = 0.1629
PC2 + PC4: CCA score = 0.2657
PC2 + PC5: CCA score = 0.1304
PC2 + PC6: CCA score = 0.4255
PC2 + PC7: CCA score = 0.2894
PC2 + PC8: CCA score = 0.1482
PC3 + PC4: CCA score = 0.2525
PC3 + PC5: CCA score = 0.1010
PC3 + PC6: CCA score = 0.4174
PC3 + PC7: CCA score = 0.2774
PC3 + PC8: CCA score = 0.1231
PC4 + PC5: CCA score = 0.2329
PC4 + PC6: CCA score = 0.4672
PC4 + PC7: CCA score = 0.3479
PC4 + PC8: CCA score = 0.2433
PC5 + PC6: CCA score = 0.4058
PC5 + PC7: CCA score = 0.2597
PC5 + PC8: CCA score = 0.0752
PC6 + PC7: CCA score = 0.4811
PC6 + PC8: CCA score = 0.4119
PC7 + PC8: CCA score = 0.2691
Best combination: PC1 + PC6 with score 0.4941
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.300/cca_plot_res_0.300.png
  ⏱️  CCA plot generation: 1.276 seconds
  📊 Created CCA visualization using PC1 + PC6 (viz score: 0.4941)
⏱️    🎲 Null distribution (1000 sims): 1.74 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.2950
  ⏱️  TOTAL for resolution 0.300: 25.41 seconds

🎯 Testing resolution: 0.400
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 4.59 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 9
⏱️    🧪 Pseudobulk computation: 19.05 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.6964 (using 9 PCs)
Auto-selecting best 2-PC combination from 9 components...
Testing 36 PC combinations...
PC1 + PC2: CCA score = 0.3110
PC1 + PC3: CCA score = 0.3504
PC1 + PC4: CCA score = 0.3569
PC1 + PC5: CCA score = 0.2945
PC1 + PC6: CCA score = 0.3060
PC1 + PC7: CCA score = 0.5538
PC1 + PC8: CCA score = 0.3609
PC1 + PC9: CCA score = 0.3521
PC2 + PC3: CCA score = 0.2171
PC2 + PC4: CCA score = 0.2275
PC2 + PC5: CCA score = 0.1051
PC2 + PC6: CCA score = 0.1342
PC2 + PC7: CCA score = 0.4807
PC2 + PC8: CCA score = 0.2337
PC2 + PC9: CCA score = 0.2199
PC3 + PC4: CCA score = 0.2790
PC3 + PC5: CCA score = 0.1927
PC3 + PC6: CCA score = 0.2100
PC3 + PC7: CCA score = 0.5071
PC3 + PC8: CCA score = 0.2841
PC3 + PC9: CCA score = 0.2728
PC4 + PC5: CCA score = 0.2043
PC4 + PC6: CCA score = 0.2207
PC4 + PC7: CCA score = 0.5116
PC4 + PC8: CCA score = 0.2921
PC4 + PC9: CCA score = 0.2811
PC5 + PC6: CCA score = 0.0894
PC5 + PC7: CCA score = 0.4702
PC5 + PC8: CCA score = 0.2112
PC5 + PC9: CCA score = 0.1958
PC6 + PC7: CCA score = 0.4775
PC6 + PC8: CCA score = 0.2271
PC6 + PC9: CCA score = 0.2128
PC7 + PC8: CCA score = 0.5144
PC7 + PC9: CCA score = 0.5083
PC8 + PC9: CCA score = 0.2862
Best combination: PC1 + PC7 with score 0.5538
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.400/cca_plot_res_0.400.png
  ⏱️  CCA plot generation: 2.113 seconds
  📊 Created CCA visualization using PC1 + PC7 (viz score: 0.5538)
⏱️    🎲 Null distribution (1000 sims): 1.54 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.1970
  ⏱️  TOTAL for resolution 0.400: 27.31 seconds

🎯 Testing resolution: 0.500
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 3.69 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 10
⏱️    🧪 Pseudobulk computation: 21.52 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.6593 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3357
PC1 + PC3: CCA score = 0.3831
PC1 + PC4: CCA score = 0.3265
PC1 + PC5: CCA score = 0.2985
PC1 + PC6: CCA score = 0.2980
PC1 + PC7: CCA score = 0.3067
PC1 + PC8: CCA score = 0.5267
PC1 + PC9: CCA score = 0.3596
PC1 + PC10: CCA score = 0.3166
PC2 + PC3: CCA score = 0.2862
PC2 + PC4: CCA score = 0.2043
PC2 + PC5: CCA score = 0.1556
PC2 + PC6: CCA score = 0.1547
PC2 + PC7: CCA score = 0.1710
PC2 + PC8: CCA score = 0.4610
PC2 + PC9: CCA score = 0.2539
PC2 + PC10: CCA score = 0.1881
PC3 + PC4: CCA score = 0.2753
PC3 + PC5: CCA score = 0.2414
PC3 + PC6: CCA score = 0.2408
PC3 + PC7: CCA score = 0.2516
PC3 + PC8: CCA score = 0.4966
PC3 + PC9: CCA score = 0.3139
PC3 + PC10: CCA score = 0.2635
PC4 + PC5: CCA score = 0.1346
PC4 + PC6: CCA score = 0.1335
PC4 + PC7: CCA score = 0.1521
PC4 + PC8: CCA score = 0.4544
PC4 + PC9: CCA score = 0.2416
PC4 + PC10: CCA score = 0.1711
PC5 + PC6: CCA score = 0.0172
PC5 + PC7: CCA score = 0.0749
PC5 + PC8: CCA score = 0.4347
PC5 + PC9: CCA score = 0.2021
PC5 + PC10: CCA score = 0.1083
PC6 + PC7: CCA score = 0.0729
PC6 + PC8: CCA score = 0.4343
PC6 + PC9: CCA score = 0.2013
PC6 + PC10: CCA score = 0.1070
PC7 + PC8: CCA score = 0.4404
PC7 + PC9: CCA score = 0.2141
PC7 + PC10: CCA score = 0.1294
PC8 + PC9: CCA score = 0.4787
PC8 + PC10: CCA score = 0.4473
PC9 + PC10: CCA score = 0.2280
Best combination: PC1 + PC8 with score 0.5267
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.500/cca_plot_res_0.500.png
  ⏱️  CCA plot generation: 1.830 seconds
  📊 Created CCA visualization using PC1 + PC8 (viz score: 0.5267)
⏱️    🎲 Null distribution (1000 sims): 4.27 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.4290
  ⏱️  TOTAL for resolution 0.500: 31.32 seconds

🎯 Testing resolution: 0.600
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 4.08 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 11
⏱️    🧪 Pseudobulk computation: 24.21 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7121 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3101
PC1 + PC3: CCA score = 0.3932
PC1 + PC4: CCA score = 0.2889
PC1 + PC5: CCA score = 0.2790
PC1 + PC6: CCA score = 0.2780
PC1 + PC7: CCA score = 0.2843
PC1 + PC8: CCA score = 0.5471
PC1 + PC9: CCA score = 0.3103
PC1 + PC10: CCA score = 0.3463
PC2 + PC3: CCA score = 0.3258
PC2 + PC4: CCA score = 0.1869
PC2 + PC5: CCA score = 0.1713
PC2 + PC6: CCA score = 0.1698
PC2 + PC7: CCA score = 0.1798
PC2 + PC8: CCA score = 0.5008
PC2 + PC9: CCA score = 0.2186
PC2 + PC10: CCA score = 0.2672
PC3 + PC4: CCA score = 0.3057
PC3 + PC5: CCA score = 0.2963
PC3 + PC6: CCA score = 0.2955
PC3 + PC7: CCA score = 0.3013
PC3 + PC8: CCA score = 0.5562
PC3 + PC9: CCA score = 0.3260
PC3 + PC10: CCA score = 0.3604
PC4 + PC5: CCA score = 0.1289
PC4 + PC6: CCA score = 0.1269
PC4 + PC7: CCA score = 0.1400
PC4 + PC8: CCA score = 0.4880
PC4 + PC9: CCA score = 0.1873
PC4 + PC10: CCA score = 0.2423
PC5 + PC6: CCA score = 0.1024
PC5 + PC7: CCA score = 0.1183
PC5 + PC8: CCA score = 0.4822
PC5 + PC9: CCA score = 0.1717
PC5 + PC10: CCA score = 0.2304
PC6 + PC7: CCA score = 0.1161
PC6 + PC8: CCA score = 0.4817
PC6 + PC9: CCA score = 0.1701
PC6 + PC10: CCA score = 0.2293
PC7 + PC8: CCA score = 0.4853
PC7 + PC9: CCA score = 0.1802
PC7 + PC10: CCA score = 0.2368
PC8 + PC9: CCA score = 0.5010
PC8 + PC10: CCA score = 0.5240
PC9 + PC10: CCA score = 0.2675
Best combination: PC3 + PC8 with score 0.5562
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.600/cca_plot_res_0.600.png
  ⏱️  CCA plot generation: 1.796 seconds
  📊 Created CCA visualization using PC3 + PC8 (viz score: 0.5562)
⏱️    🎲 Null distribution (1000 sims): 1.67 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.2680
  ⏱️  TOTAL for resolution 0.600: 31.85 seconds

🎯 Testing resolution: 0.700
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 3.71 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 14
⏱️    🧪 Pseudobulk computation: 27.18 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7399 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3106
PC1 + PC3: CCA score = 0.4024
PC1 + PC4: CCA score = 0.2806
PC1 + PC5: CCA score = 0.3395
PC1 + PC6: CCA score = 0.2814
PC1 + PC7: CCA score = 0.2701
PC1 + PC8: CCA score = 0.3186
PC1 + PC9: CCA score = 0.5198
PC1 + PC10: CCA score = 0.3871
PC2 + PC3: CCA score = 0.3373
PC2 + PC4: CCA score = 0.1748
PC2 + PC5: CCA score = 0.2590
PC2 + PC6: CCA score = 0.1760
PC2 + PC7: CCA score = 0.1574
PC2 + PC8: CCA score = 0.2309
PC2 + PC9: CCA score = 0.4712
PC2 + PC10: CCA score = 0.3189
PC3 + PC4: CCA score = 0.3099
PC3 + PC5: CCA score = 0.3640
PC3 + PC6: CCA score = 0.3105
PC3 + PC7: CCA score = 0.3004
PC3 + PC8: CCA score = 0.3446
PC3 + PC9: CCA score = 0.5362
PC3 + PC10: CCA score = 0.4088
PC4 + PC5: CCA score = 0.2221
PC4 + PC6: CCA score = 0.1150
PC4 + PC7: CCA score = 0.0838
PC4 + PC8: CCA score = 0.1886
PC4 + PC9: CCA score = 0.4520
PC4 + PC10: CCA score = 0.2897
PC5 + PC6: CCA score = 0.2230
PC5 + PC7: CCA score = 0.2087
PC5 + PC8: CCA score = 0.2685
PC5 + PC9: CCA score = 0.4907
PC5 + PC10: CCA score = 0.3470
PC6 + PC7: CCA score = 0.0863
PC6 + PC8: CCA score = 0.1897
PC6 + PC9: CCA score = 0.4525
PC6 + PC10: CCA score = 0.2904
PC7 + PC8: CCA score = 0.1725
PC7 + PC9: CCA score = 0.4455
PC7 + PC10: CCA score = 0.2795
PC8 + PC9: CCA score = 0.4765
PC8 + PC10: CCA score = 0.3266
PC9 + PC10: CCA score = 0.5248
Best combination: PC3 + PC9 with score 0.5362
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.700/cca_plot_res_0.700.png
  ⏱️  CCA plot generation: 2.019 seconds
  📊 Created CCA visualization using PC3 + PC9 (viz score: 0.5362)
⏱️    🎲 Null distribution (1000 sims): 1.48 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.1670
  ⏱️  TOTAL for resolution 0.700: 34.49 seconds

🎯 Testing resolution: 0.800
  ⏱️  Cleanup: 0.003 seconds
⏱️    🧬 Cell clustering: 3.19 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 14
⏱️    🧪 Pseudobulk computation: 27.70 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7611 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3092
PC1 + PC3: CCA score = 0.3908
PC1 + PC4: CCA score = 0.2865
PC1 + PC5: CCA score = 0.3370
PC1 + PC6: CCA score = 0.2706
PC1 + PC7: CCA score = 0.2653
PC1 + PC8: CCA score = 0.3062
PC1 + PC9: CCA score = 0.5791
PC1 + PC10: CCA score = 0.3546
PC2 + PC3: CCA score = 0.3279
PC2 + PC4: CCA score = 0.1920
PC2 + PC5: CCA score = 0.2615
PC2 + PC6: CCA score = 0.1674
PC2 + PC7: CCA score = 0.1588
PC2 + PC8: CCA score = 0.2203
PC2 + PC9: CCA score = 0.5387
PC2 + PC10: CCA score = 0.2838
PC3 + PC4: CCA score = 0.3066
PC3 + PC5: CCA score = 0.3542
PC3 + PC6: CCA score = 0.2918
PC3 + PC7: CCA score = 0.2869
PC3 + PC8: CCA score = 0.3251
PC3 + PC9: CCA score = 0.5893
PC3 + PC10: CCA score = 0.3710
PC4 + PC5: CCA score = 0.2342
PC4 + PC6: CCA score = 0.1203
PC4 + PC7: CCA score = 0.1080
PC4 + PC8: CCA score = 0.1871
PC4 + PC9: CCA score = 0.5260
PC4 + PC10: CCA score = 0.2589
PC5 + PC6: CCA score = 0.2144
PC5 + PC7: CCA score = 0.2078
PC5 + PC8: CCA score = 0.2579
PC5 + PC9: CCA score = 0.5551
PC5 + PC10: CCA score = 0.3139
PC6 + PC7: CCA score = 0.0530
PC6 + PC8: CCA score = 0.1617
PC6 + PC9: CCA score = 0.5175
PC6 + PC10: CCA score = 0.2412
PC7 + PC8: CCA score = 0.1528
PC7 + PC9: CCA score = 0.5148
PC7 + PC10: CCA score = 0.2353
PC8 + PC9: CCA score = 0.5370
PC8 + PC10: CCA score = 0.2805
PC9 + PC10: CCA score = 0.5660
Best combination: PC3 + PC9 with score 0.5893
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.800/cca_plot_res_0.800.png
  ⏱️  CCA plot generation: 1.441 seconds
  📊 Created CCA visualization using PC3 + PC9 (viz score: 0.5893)
⏱️    🎲 Null distribution (1000 sims): 1.83 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0960
  ⏱️  TOTAL for resolution 0.800: 34.18 seconds

🎯 Testing resolution: 0.900
  ⏱️  Cleanup: 0.003 seconds
⏱️    🧬 Cell clustering: 4.09 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 14
⏱️    🧪 Pseudobulk computation: 26.71 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7496 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3086
PC1 + PC3: CCA score = 0.3920
PC1 + PC4: CCA score = 0.2930
PC1 + PC5: CCA score = 0.3479
PC1 + PC6: CCA score = 0.2711
PC1 + PC7: CCA score = 0.3283
PC1 + PC8: CCA score = 0.3044
PC1 + PC9: CCA score = 0.4997
PC1 + PC10: CCA score = 0.3972
PC2 + PC3: CCA score = 0.3242
PC2 + PC4: CCA score = 0.1931
PC2 + PC5: CCA score = 0.2692
PC2 + PC6: CCA score = 0.1578
PC2 + PC7: CCA score = 0.2434
PC2 + PC8: CCA score = 0.2100
PC2 + PC9: CCA score = 0.4485
PC2 + PC10: CCA score = 0.3305
PC3 + PC4: CCA score = 0.3094
PC3 + PC5: CCA score = 0.3618
PC3 + PC6: CCA score = 0.2887
PC3 + PC7: CCA score = 0.3430
PC3 + PC8: CCA score = 0.3202
PC3 + PC9: CCA score = 0.5095
PC3 + PC10: CCA score = 0.4095
PC4 + PC5: CCA score = 0.2511
PC4 + PC6: CCA score = 0.1244
PC4 + PC7: CCA score = 0.2232
PC4 + PC8: CCA score = 0.1862
PC4 + PC9: CCA score = 0.4378
PC4 + PC10: CCA score = 0.3159
PC5 + PC6: CCA score = 0.2251
PC5 + PC7: CCA score = 0.2916
PC5 + PC8: CCA score = 0.2643
PC5 + PC9: CCA score = 0.4763
PC5 + PC10: CCA score = 0.3674
PC6 + PC7: CCA score = 0.1935
PC6 + PC8: CCA score = 0.1493
PC6 + PC9: CCA score = 0.4235
PC6 + PC10: CCA score = 0.2957
PC7 + PC8: CCA score = 0.2380
PC7 + PC9: CCA score = 0.4622
PC7 + PC10: CCA score = 0.3489
PC8 + PC9: CCA score = 0.4456
PC8 + PC10: CCA score = 0.3265
PC9 + PC10: CCA score = 0.5135
Best combination: PC9 + PC10 with score 0.5135
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.900/cca_plot_res_0.900.png
  ⏱️  CCA plot generation: 1.059 seconds
  📊 Created CCA visualization using PC9 + PC10 (viz score: 0.5135)
⏱️    🎲 Null distribution (1000 sims): 1.66 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.1270
  ⏱️  TOTAL for resolution 0.900: 33.53 seconds

🎯 Testing resolution: 1.000
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 5.14 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 16
⏱️    🧪 Pseudobulk computation: 32.78 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7319 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3151
PC1 + PC3: CCA score = 0.3798
PC1 + PC4: CCA score = 0.3261
PC1 + PC5: CCA score = 0.3348
PC1 + PC6: CCA score = 0.2924
PC1 + PC7: CCA score = 0.2838
PC1 + PC8: CCA score = 0.4170
PC1 + PC9: CCA score = 0.4614
PC1 + PC10: CCA score = 0.3889
PC2 + PC3: CCA score = 0.2932
PC2 + PC4: CCA score = 0.2191
PC2 + PC5: CCA score = 0.2319
PC2 + PC6: CCA score = 0.1648
PC2 + PC7: CCA score = 0.1491
PC2 + PC8: CCA score = 0.3400
PC2 + PC9: CCA score = 0.3931
PC2 + PC10: CCA score = 0.3048
PC3 + PC4: CCA score = 0.3050
PC3 + PC5: CCA score = 0.3143
PC3 + PC6: CCA score = 0.2686
PC3 + PC7: CCA score = 0.2593
PC3 + PC8: CCA score = 0.4007
PC3 + PC9: CCA score = 0.4467
PC3 + PC10: CCA score = 0.3713
PC4 + PC5: CCA score = 0.2467
PC4 + PC6: CCA score = 0.1851
PC4 + PC7: CCA score = 0.1712
PC4 + PC8: CCA score = 0.3502
PC4 + PC9: CCA score = 0.4020
PC4 + PC10: CCA score = 0.3162
PC5 + PC6: CCA score = 0.2000
PC5 + PC7: CCA score = 0.1872
PC5 + PC8: CCA score = 0.3583
PC5 + PC9: CCA score = 0.4091
PC5 + PC10: CCA score = 0.3251
PC6 + PC7: CCA score = 0.0919
PC6 + PC8: CCA score = 0.3191
PC6 + PC9: CCA score = 0.3752
PC6 + PC10: CCA score = 0.2813
PC7 + PC8: CCA score = 0.3112
PC7 + PC9: CCA score = 0.3685
PC7 + PC10: CCA score = 0.2723
PC8 + PC9: CCA score = 0.4787
PC8 + PC10: CCA score = 0.4093
PC9 + PC10: CCA score = 0.4544
Best combination: PC8 + PC9 with score 0.4787
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_1.000/cca_plot_res_1.000.png
  ⏱️  CCA plot generation: 1.389 seconds
  📊 Created CCA visualization using PC8 + PC9 (viz score: 0.4787)
⏱️    🎲 Null distribution (1000 sims): 1.49 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.2110
  ⏱️  TOTAL for resolution 1.000: 40.93 seconds

⏱️  COARSE SEARCH TOTAL: 297.47 seconds

🏆 Best resolution from first pass: 0.80
🎯 Best CCA score: 0.7611

🔬 === SECOND PASS: Fine-tuned Search ===
Fine-tuning search from 0.78 to 0.82...

🎯 Testing resolution: 0.780
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 3.77 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 14
⏱️    🧪 Pseudobulk computation: 27.00 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7441 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3062
PC1 + PC3: CCA score = 0.3860
PC1 + PC4: CCA score = 0.2919
PC1 + PC5: CCA score = 0.3379
PC1 + PC6: CCA score = 0.2719
PC1 + PC7: CCA score = 0.2675
PC1 + PC8: CCA score = 0.3001
PC1 + PC9: CCA score = 0.5511
PC1 + PC10: CCA score = 0.3691
PC2 + PC3: CCA score = 0.3191
PC2 + PC4: CCA score = 0.1948
PC2 + PC5: CCA score = 0.2587
PC2 + PC6: CCA score = 0.1633
PC2 + PC7: CCA score = 0.1560
PC2 + PC8: CCA score = 0.2069
PC2 + PC9: CCA score = 0.5064
PC2 + PC10: CCA score = 0.2984
PC3 + PC4: CCA score = 0.3053
PC3 + PC5: CCA score = 0.3496
PC3 + PC6: CCA score = 0.2863
PC3 + PC7: CCA score = 0.2822
PC3 + PC8: CCA score = 0.3132
PC3 + PC9: CCA score = 0.5584
PC3 + PC10: CCA score = 0.3799
PC4 + PC5: CCA score = 0.2416
PC4 + PC6: CCA score = 0.1346
PC4 + PC7: CCA score = 0.1256
PC4 + PC8: CCA score = 0.1850
PC4 + PC9: CCA score = 0.4979
PC4 + PC10: CCA score = 0.2837
PC5 + PC6: CCA score = 0.2170
PC5 + PC7: CCA score = 0.2115
PC5 + PC8: CCA score = 0.2514
PC5 + PC9: CCA score = 0.5262
PC5 + PC10: CCA score = 0.3308
PC6 + PC7: CCA score = 0.0670
PC6 + PC8: CCA score = 0.1516
PC6 + PC9: CCA score = 0.4865
PC6 + PC10: CCA score = 0.2631
PC7 + PC8: CCA score = 0.1436
PC7 + PC9: CCA score = 0.4840
PC7 + PC10: CCA score = 0.2586
PC8 + PC9: CCA score = 0.5028
PC8 + PC10: CCA score = 0.2921
PC9 + PC10: CCA score = 0.5468
Best combination: PC3 + PC9 with score 0.5584
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.780/cca_plot_res_0.780.png
  ⏱️  CCA plot generation: 1.699 seconds
  📊 Created CCA visualization using PC3 + PC9 (viz score: 0.5584)
⏱️    🎲 Null distribution (1000 sims): 1.96 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.1420
  ⏱️  TOTAL for resolution 0.780: 34.62 seconds

🎯 Testing resolution: 0.790
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 3.18 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 14
⏱️    🧪 Pseudobulk computation: 28.49 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7493 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3077
PC1 + PC3: CCA score = 0.3910
PC1 + PC4: CCA score = 0.2906
PC1 + PC5: CCA score = 0.3597
PC1 + PC6: CCA score = 0.2700
PC1 + PC7: CCA score = 0.2661
PC1 + PC8: CCA score = 0.2983
PC1 + PC9: CCA score = 0.5345
PC1 + PC10: CCA score = 0.3824
PC2 + PC3: CCA score = 0.3263
PC2 + PC4: CCA score = 0.1950
PC2 + PC5: CCA score = 0.2879
PC2 + PC6: CCA score = 0.1626
PC2 + PC7: CCA score = 0.1560
PC2 + PC8: CCA score = 0.2062
PC2 + PC9: CCA score = 0.4891
PC2 + PC10: CCA score = 0.3159
PC3 + PC4: CCA score = 0.3102
PC3 + PC5: CCA score = 0.3757
PC3 + PC6: CCA score = 0.2910
PC3 + PC7: CCA score = 0.2873
PC3 + PC8: CCA score = 0.3174
PC3 + PC9: CCA score = 0.5454
PC3 + PC10: CCA score = 0.3975
PC4 + PC5: CCA score = 0.2697
PC4 + PC6: CCA score = 0.1275
PC4 + PC7: CCA score = 0.1189
PC4 + PC8: CCA score = 0.1797
PC4 + PC9: CCA score = 0.4786
PC4 + PC10: CCA score = 0.2993
PC5 + PC6: CCA score = 0.2473
PC5 + PC7: CCA score = 0.2430
PC5 + PC8: CCA score = 0.2779
PC5 + PC9: CCA score = 0.5234
PC5 + PC10: CCA score = 0.3667
PC6 + PC7: CCA score = 0.0507
PC6 + PC8: CCA score = 0.1440
PC6 + PC9: CCA score = 0.4664
PC6 + PC10: CCA score = 0.2793
PC7 + PC8: CCA score = 0.1365
PC7 + PC9: CCA score = 0.4641
PC7 + PC10: CCA score = 0.2755
PC8 + PC9: CCA score = 0.4833
PC8 + PC10: CCA score = 0.3067
PC9 + PC10: CCA score = 0.5393
Best combination: PC3 + PC9 with score 0.5454
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.790/cca_plot_res_0.790.png
  ⏱️  CCA plot generation: 1.614 seconds
  📊 Created CCA visualization using PC3 + PC9 (viz score: 0.5454)
⏱️    🎲 Null distribution (1000 sims): 1.98 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.1620
  ⏱️  TOTAL for resolution 0.790: 35.38 seconds

🎯 Testing resolution: 0.810
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 4.15 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 13
⏱️    🧪 Pseudobulk computation: 25.65 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7270 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3106
PC1 + PC3: CCA score = 0.3942
PC1 + PC4: CCA score = 0.2843
PC1 + PC5: CCA score = 0.3467
PC1 + PC6: CCA score = 0.2713
PC1 + PC7: CCA score = 0.2920
PC1 + PC8: CCA score = 0.3095
PC1 + PC9: CCA score = 0.5095
PC1 + PC10: CCA score = 0.3711
PC2 + PC3: CCA score = 0.3283
PC2 + PC4: CCA score = 0.1823
PC2 + PC5: CCA score = 0.2694
PC2 + PC6: CCA score = 0.1612
PC2 + PC7: CCA score = 0.1941
PC2 + PC8: CCA score = 0.2195
PC2 + PC9: CCA score = 0.4605
PC2 + PC10: CCA score = 0.3002
PC3 + PC4: CCA score = 0.3035
PC3 + PC5: CCA score = 0.3626
PC3 + PC6: CCA score = 0.2914
PC3 + PC7: CCA score = 0.3108
PC3 + PC8: CCA score = 0.3273
PC3 + PC9: CCA score = 0.5205
PC3 + PC10: CCA score = 0.3860
PC4 + PC5: CCA score = 0.2386
PC4 + PC6: CCA score = 0.1016
PC4 + PC7: CCA score = 0.1483
PC4 + PC8: CCA score = 0.1804
PC4 + PC9: CCA score = 0.4431
PC4 + PC10: CCA score = 0.2729
PC5 + PC6: CCA score = 0.2229
PC5 + PC7: CCA score = 0.2477
PC5 + PC8: CCA score = 0.2681
PC5 + PC9: CCA score = 0.4855
PC5 + PC10: CCA score = 0.3373
PC6 + PC7: CCA score = 0.1215
PC6 + PC8: CCA score = 0.1590
PC6 + PC9: CCA score = 0.4349
PC6 + PC10: CCA score = 0.2592
PC7 + PC8: CCA score = 0.1923
PC7 + PC9: CCA score = 0.4481
PC7 + PC10: CCA score = 0.2809
PC8 + PC9: CCA score = 0.4597
PC8 + PC10: CCA score = 0.2990
PC9 + PC10: CCA score = 0.5032
Best combination: PC3 + PC9 with score 0.5205
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.810/cca_plot_res_0.810.png
  ⏱️  CCA plot generation: 1.659 seconds
  📊 Created CCA visualization using PC3 + PC9 (viz score: 0.5205)
⏱️    🎲 Null distribution (1000 sims): 3.24 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.2020
  ⏱️  TOTAL for resolution 0.810: 34.71 seconds

🎯 Testing resolution: 0.820
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 3.42 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 13
⏱️    🧪 Pseudobulk computation: 23.71 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7311 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3067
PC1 + PC3: CCA score = 0.3939
PC1 + PC4: CCA score = 0.2826
PC1 + PC5: CCA score = 0.3273
PC1 + PC6: CCA score = 0.2705
PC1 + PC7: CCA score = 0.2652
PC1 + PC8: CCA score = 0.3147
PC1 + PC9: CCA score = 0.5328
PC1 + PC10: CCA score = 0.3599
PC2 + PC3: CCA score = 0.3314
PC2 + PC4: CCA score = 0.1858
PC2 + PC5: CCA score = 0.2485
PC2 + PC6: CCA score = 0.1668
PC2 + PC7: CCA score = 0.1581
PC2 + PC8: CCA score = 0.2317
PC2 + PC9: CCA score = 0.4884
PC2 + PC10: CCA score = 0.2902
PC3 + PC4: CCA score = 0.3093
PC3 + PC5: CCA score = 0.3505
PC3 + PC6: CCA score = 0.2982
PC3 + PC7: CCA score = 0.2934
PC3 + PC8: CCA score = 0.3388
PC3 + PC9: CCA score = 0.5474
PC3 + PC10: CCA score = 0.3812
PC4 + PC5: CCA score = 0.2181
PC4 + PC6: CCA score = 0.1169
PC4 + PC7: CCA score = 0.1040
PC4 + PC8: CCA score = 0.1988
PC4 + PC9: CCA score = 0.4736
PC4 + PC10: CCA score = 0.2646
PC5 + PC6: CCA score = 0.2022
PC5 + PC7: CCA score = 0.1950
PC5 + PC8: CCA score = 0.2583
PC5 + PC9: CCA score = 0.5015
PC5 + PC10: CCA score = 0.3118
PC6 + PC7: CCA score = 0.0642
PC6 + PC8: CCA score = 0.1811
PC6 + PC9: CCA score = 0.4665
PC6 + PC10: CCA score = 0.2516
PC7 + PC8: CCA score = 0.1731
PC7 + PC9: CCA score = 0.4635
PC7 + PC10: CCA score = 0.2459
PC8 + PC9: CCA score = 0.4934
PC8 + PC10: CCA score = 0.2986
PC9 + PC10: CCA score = 0.5234
Best combination: PC3 + PC9 with score 0.5474
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_proportion/resolutions/resolution_0.820/cca_plot_res_0.820.png
  ⏱️  CCA plot generation: 1.188 seconds
  📊 Created CCA visualization using PC3 + PC9 (viz score: 0.5474)
⏱️    🎲 Null distribution (1000 sims): 1.36 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.1910
  ⏱️  TOTAL for resolution 0.820: 29.79 seconds

⏱️  FINE SEARCH TOTAL: 134.50 seconds

🔧 === GENERATING CORRECTED NULL DISTRIBUTION ===
⏱️  📊 Corrected null distribution generation: 0.00 seconds
⏱️  Saving corrected null: 0.912 seconds

📊 === COMPUTING CORRECTED P-VALUES ===
⏱️  📈 Corrected p-values computation: 22.22 seconds
⏱️  Corrected null visualization: 1.118 seconds
⏱️  CORRECTED P-VALUES TOTAL: 24.25 seconds

🏆 === FINAL RESULTS ===
🎯 Best resolution: 0.800
📊 Best CCA score: 0.7611
🧬 Number of clusters: 14
📐 Number of PCs used: 10
📊 Best visualization used PC3 + PC9
📈 Standard p-value: 0.0960
📊 Corrected p-value: 0.7260
⏱️  Final processing: 1.666 seconds

🚀 [PROFILED Find Optimal Resolution RNA-seq] TOTAL RUNTIME: 457.98 seconds

📊 PERFORMANCE SUMMARY:
  🔧 Setup: 0.4s
  🔍 Coarse search: 297.5s (65.0%)
  🔬 Fine search: 134.5s (29.4%)
  📊 Corrected p-values: 24.3s (5.3%)
  📝 Final processing: 1.7s
🚀 Using PROFILED GPU version of optimal resolution WITH TIMEOUT PROTECTION
⏰ Timeout per resolution: 3600 seconds (1.0 hours)
⏱️  Directory setup: 0.06 seconds

📊 Starting RNA-seq resolution optimization with detailed timing...
Using representation: X_pca with 20 components
Using 10 PCs for CCA analysis
Will compute corrected p-values with 1000 simulations per resolution

🔍 === FIRST PASS: Coarse Search ===

🎯 Testing resolution: 0.100
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 3.76 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 5
⏱️    🧪 Pseudobulk computation: 12.12 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7626 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.4696
PC1 + PC3: CCA score = 0.4314
PC1 + PC4: CCA score = 0.4645
PC1 + PC5: CCA score = 0.4235
PC1 + PC6: CCA score = 0.5245
PC1 + PC7: CCA score = 0.4254
PC1 + PC8: CCA score = 0.4148
PC1 + PC9: CCA score = 0.4486
PC1 + PC10: CCA score = 0.3931
PC2 + PC3: CCA score = 0.3249
PC2 + PC4: CCA score = 0.3678
PC2 + PC5: CCA score = 0.3143
PC2 + PC6: CCA score = 0.4411
PC2 + PC7: CCA score = 0.3169
PC2 + PC8: CCA score = 0.3025
PC2 + PC9: CCA score = 0.3474
PC2 + PC10: CCA score = 0.2719
PC3 + PC4: CCA score = 0.3176
PC3 + PC5: CCA score = 0.2539
PC3 + PC6: CCA score = 0.4003
PC3 + PC7: CCA score = 0.2570
PC3 + PC8: CCA score = 0.2391
PC3 + PC9: CCA score = 0.2939
PC3 + PC10: CCA score = 0.1990
PC4 + PC5: CCA score = 0.3068
PC4 + PC6: CCA score = 0.4358
PC4 + PC7: CCA score = 0.3094
PC4 + PC8: CCA score = 0.2946
PC4 + PC9: CCA score = 0.3406
PC4 + PC10: CCA score = 0.2632
PC5 + PC6: CCA score = 0.3917
PC5 + PC7: CCA score = 0.2434
PC5 + PC8: CCA score = 0.2244
PC5 + PC9: CCA score = 0.2821
PC5 + PC10: CCA score = 0.1811
PC6 + PC7: CCA score = 0.3938
PC6 + PC8: CCA score = 0.3823
PC6 + PC9: CCA score = 0.4188
PC6 + PC10: CCA score = 0.3586
PC7 + PC8: CCA score = 0.2280
PC7 + PC9: CCA score = 0.2849
PC7 + PC10: CCA score = 0.1855
PC8 + PC9: CCA score = 0.2688
PC8 + PC10: CCA score = 0.1597
PC9 + PC10: CCA score = 0.2340
Best combination: PC1 + PC6 with score 0.5245
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.100/cca_plot_res_0.100.png
  ⏱️  CCA plot generation: 1.586 seconds
  📊 Created CCA visualization using PC1 + PC6 (viz score: 0.5245)
⏱️    🎲 Null distribution (1000 sims): 1.46 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0990
  ⏱️  TOTAL for resolution 0.100: 19.04 seconds

🎯 Testing resolution: 0.200
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 2.85 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 5
⏱️    🧪 Pseudobulk computation: 12.66 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7613 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.4685
PC1 + PC3: CCA score = 0.4391
PC1 + PC4: CCA score = 0.4799
PC1 + PC5: CCA score = 0.4566
PC1 + PC6: CCA score = 0.5037
PC1 + PC7: CCA score = 0.4312
PC1 + PC8: CCA score = 0.4249
PC1 + PC9: CCA score = 0.4669
PC1 + PC10: CCA score = 0.4044
PC2 + PC3: CCA score = 0.3066
PC2 + PC4: CCA score = 0.3625
PC2 + PC5: CCA score = 0.3311
PC2 + PC6: CCA score = 0.3935
PC2 + PC7: CCA score = 0.2951
PC2 + PC8: CCA score = 0.2858
PC2 + PC9: CCA score = 0.3451
PC2 + PC10: CCA score = 0.2543
PC3 + PC4: CCA score = 0.3238
PC3 + PC5: CCA score = 0.2881
PC3 + PC6: CCA score = 0.3581
PC3 + PC7: CCA score = 0.2460
PC3 + PC8: CCA score = 0.2347
PC3 + PC9: CCA score = 0.3042
PC3 + PC10: CCA score = 0.1951
PC4 + PC5: CCA score = 0.3471
PC4 + PC6: CCA score = 0.4070
PC4 + PC7: CCA score = 0.3130
PC4 + PC8: CCA score = 0.3042
PC4 + PC9: CCA score = 0.3605
PC4 + PC10: CCA score = 0.2748
PC5 + PC6: CCA score = 0.3793
PC5 + PC7: CCA score = 0.2759
PC5 + PC8: CCA score = 0.2659
PC5 + PC9: CCA score = 0.3288
PC5 + PC10: CCA score = 0.2317
PC6 + PC7: CCA score = 0.3483
PC6 + PC8: CCA score = 0.3405
PC6 + PC9: CCA score = 0.3916
PC6 + PC10: CCA score = 0.3145
PC7 + PC8: CCA score = 0.2196
PC7 + PC9: CCA score = 0.2926
PC7 + PC10: CCA score = 0.1767
PC8 + PC9: CCA score = 0.2832
PC8 + PC10: CCA score = 0.1606
PC9 + PC10: CCA score = 0.2514
Best combination: PC1 + PC6 with score 0.5037
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.200/cca_plot_res_0.200.png
  ⏱️  CCA plot generation: 1.555 seconds
  📊 Created CCA visualization using PC1 + PC6 (viz score: 0.5037)
⏱️    🎲 Null distribution (1000 sims): 2.04 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0910
  ⏱️  TOTAL for resolution 0.200: 19.19 seconds

🎯 Testing resolution: 0.300
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 3.22 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 8
⏱️    🧪 Pseudobulk computation: 17.20 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7884 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2121
PC1 + PC3: CCA score = 0.5271
PC1 + PC4: CCA score = 0.4003
PC1 + PC5: CCA score = 0.2683
PC1 + PC6: CCA score = 0.3410
PC1 + PC7: CCA score = 0.3435
PC1 + PC8: CCA score = 0.2607
PC1 + PC9: CCA score = 0.2177
PC1 + PC10: CCA score = 0.2439
PC2 + PC3: CCA score = 0.4870
PC2 + PC4: CCA score = 0.3458
PC2 + PC5: CCA score = 0.1770
PC2 + PC6: CCA score = 0.2750
PC2 + PC7: CCA score = 0.2782
PC2 + PC8: CCA score = 0.1654
PC2 + PC9: CCA score = 0.0821
PC2 + PC10: CCA score = 0.1374
PC3 + PC4: CCA score = 0.5936
PC3 + PC5: CCA score = 0.5139
PC3 + PC6: CCA score = 0.5554
PC3 + PC7: CCA score = 0.5569
PC3 + PC8: CCA score = 0.5100
PC3 + PC9: CCA score = 0.4894
PC3 + PC10: CCA score = 0.5017
PC4 + PC5: CCA score = 0.3828
PC4 + PC6: CCA score = 0.4369
PC4 + PC7: CCA score = 0.4388
PC4 + PC8: CCA score = 0.3776
PC4 + PC9: CCA score = 0.3492
PC4 + PC10: CCA score = 0.3662
PC5 + PC6: CCA score = 0.3203
PC5 + PC7: CCA score = 0.3230
PC5 + PC8: CCA score = 0.2331
PC5 + PC9: CCA score = 0.1836
PC5 + PC10: CCA score = 0.2141
PC6 + PC7: CCA score = 0.3855
PC6 + PC8: CCA score = 0.3140
PC6 + PC9: CCA score = 0.2793
PC6 + PC10: CCA score = 0.3002
PC7 + PC8: CCA score = 0.3168
PC7 + PC9: CCA score = 0.2824
PC7 + PC10: CCA score = 0.3031
PC8 + PC9: CCA score = 0.1724
PC8 + PC10: CCA score = 0.2046
PC9 + PC10: CCA score = 0.1458
Best combination: PC3 + PC4 with score 0.5936
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.300/cca_plot_res_0.300.png
  ⏱️  CCA plot generation: 1.324 seconds
  📊 Created CCA visualization using PC3 + PC4 (viz score: 0.5936)
⏱️    🎲 Null distribution (1000 sims): 1.69 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0330
  ⏱️  TOTAL for resolution 0.300: 23.69 seconds

🎯 Testing resolution: 0.400
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 4.36 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 9
⏱️    🧪 Pseudobulk computation: 19.74 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7917 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2180
PC1 + PC3: CCA score = 0.5327
PC1 + PC4: CCA score = 0.4050
PC1 + PC5: CCA score = 0.3022
PC1 + PC6: CCA score = 0.3555
PC1 + PC7: CCA score = 0.3316
PC1 + PC8: CCA score = 0.2623
PC1 + PC9: CCA score = 0.2310
PC1 + PC10: CCA score = 0.2309
PC2 + PC3: CCA score = 0.4882
PC2 + PC4: CCA score = 0.3444
PC2 + PC5: CCA score = 0.2143
PC2 + PC6: CCA score = 0.2846
PC2 + PC7: CCA score = 0.2541
PC2 + PC8: CCA score = 0.1531
PC2 + PC9: CCA score = 0.0892
PC2 + PC10: CCA score = 0.0889
PC3 + PC4: CCA score = 0.5957
PC3 + PC5: CCA score = 0.5312
PC3 + PC6: CCA score = 0.5632
PC3 + PC7: CCA score = 0.5484
PC3 + PC8: CCA score = 0.5096
PC3 + PC9: CCA score = 0.4942
PC3 + PC10: CCA score = 0.4941
PC4 + PC5: CCA score = 0.4030
PC4 + PC6: CCA score = 0.4444
PC4 + PC7: CCA score = 0.4255
PC4 + PC8: CCA score = 0.3741
PC4 + PC9: CCA score = 0.3528
PC4 + PC10: CCA score = 0.3527
PC5 + PC6: CCA score = 0.3532
PC5 + PC7: CCA score = 0.3292
PC5 + PC8: CCA score = 0.2593
PC5 + PC9: CCA score = 0.2275
PC5 + PC10: CCA score = 0.2274
PC6 + PC7: CCA score = 0.3787
PC6 + PC8: CCA score = 0.3198
PC6 + PC9: CCA score = 0.2946
PC6 + PC10: CCA score = 0.2946
PC7 + PC8: CCA score = 0.2930
PC7 + PC9: CCA score = 0.2653
PC7 + PC10: CCA score = 0.2652
PC8 + PC9: CCA score = 0.1711
PC8 + PC10: CCA score = 0.1709
PC9 + PC10: CCA score = 0.1173
Best combination: PC3 + PC4 with score 0.5957
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.400/cca_plot_res_0.400.png
  ⏱️  CCA plot generation: 1.957 seconds
  📊 Created CCA visualization using PC3 + PC4 (viz score: 0.5957)
⏱️    🎲 Null distribution (1000 sims): 1.75 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0440
  ⏱️  TOTAL for resolution 0.400: 27.89 seconds

🎯 Testing resolution: 0.500
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 3.28 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 10
⏱️    🧪 Pseudobulk computation: 20.89 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7937 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2251
PC1 + PC3: CCA score = 0.5382
PC1 + PC4: CCA score = 0.4293
PC1 + PC5: CCA score = 0.2968
PC1 + PC6: CCA score = 0.2491
PC1 + PC7: CCA score = 0.3607
PC1 + PC8: CCA score = 0.3229
PC1 + PC9: CCA score = 0.2349
PC1 + PC10: CCA score = 0.2561
PC2 + PC3: CCA score = 0.4902
PC2 + PC4: CCA score = 0.3674
PC2 + PC5: CCA score = 0.1969
PC2 + PC6: CCA score = 0.1130
PC2 + PC7: CCA score = 0.2842
PC2 + PC8: CCA score = 0.2344
PC2 + PC9: CCA score = 0.0768
PC2 + PC10: CCA score = 0.1276
PC3 + PC4: CCA score = 0.6115
PC3 + PC5: CCA score = 0.5270
PC3 + PC6: CCA score = 0.5017
PC3 + PC7: CCA score = 0.5655
PC3 + PC8: CCA score = 0.5422
PC3 + PC9: CCA score = 0.4948
PC3 + PC10: CCA score = 0.5052
PC4 + PC5: CCA score = 0.4152
PC4 + PC6: CCA score = 0.3826
PC4 + PC7: CCA score = 0.4630
PC4 + PC8: CCA score = 0.4342
PC4 + PC9: CCA score = 0.3735
PC4 + PC10: CCA score = 0.3871
PC5 + PC6: CCA score = 0.2240
PC5 + PC7: CCA score = 0.3438
PC5 + PC8: CCA score = 0.3039
PC5 + PC9: CCA score = 0.2081
PC5 + PC10: CCA score = 0.2317
PC6 + PC7: CCA score = 0.3036
PC6 + PC8: CCA score = 0.2576
PC6 + PC9: CCA score = 0.1315
PC6 + PC10: CCA score = 0.1664
PC7 + PC8: CCA score = 0.3666
PC7 + PC9: CCA score = 0.2921
PC7 + PC10: CCA score = 0.3094
PC8 + PC9: CCA score = 0.2439
PC8 + PC10: CCA score = 0.2643
PC9 + PC10: CCA score = 0.1443
Best combination: PC3 + PC4 with score 0.6115
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.500/cca_plot_res_0.500.png
  ⏱️  CCA plot generation: 1.286 seconds
  📊 Created CCA visualization using PC3 + PC4 (viz score: 0.6115)
⏱️    🎲 Null distribution (1000 sims): 1.47 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0440
  ⏱️  TOTAL for resolution 0.500: 27.13 seconds

🎯 Testing resolution: 0.600
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 3.23 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 11
⏱️    🧪 Pseudobulk computation: 22.47 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7576 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2867
PC1 + PC3: CCA score = 0.3778
PC1 + PC4: CCA score = 0.3599
PC1 + PC5: CCA score = 0.3288
PC1 + PC6: CCA score = 0.3620
PC1 + PC7: CCA score = 0.5240
PC1 + PC8: CCA score = 0.4248
PC1 + PC9: CCA score = 0.3027
PC1 + PC10: CCA score = 0.2872
PC2 + PC3: CCA score = 0.2505
PC2 + PC4: CCA score = 0.2227
PC2 + PC5: CCA score = 0.1678
PC2 + PC6: CCA score = 0.2260
PC2 + PC7: CCA score = 0.4412
PC2 + PC8: CCA score = 0.3170
PC2 + PC9: CCA score = 0.1079
PC2 + PC10: CCA score = 0.0503
PC3 + PC4: CCA score = 0.3318
PC3 + PC5: CCA score = 0.2977
PC3 + PC6: CCA score = 0.3340
PC3 + PC7: CCA score = 0.5051
PC3 + PC8: CCA score = 0.4012
PC3 + PC9: CCA score = 0.2686
PC3 + PC10: CCA score = 0.2510
PC4 + PC5: CCA score = 0.2748
PC4 + PC6: CCA score = 0.3137
PC4 + PC7: CCA score = 0.4919
PC4 + PC8: CCA score = 0.3844
PC4 + PC9: CCA score = 0.2429
PC4 + PC10: CCA score = 0.2233
PC5 + PC6: CCA score = 0.2774
PC5 + PC7: CCA score = 0.4696
PC5 + PC8: CCA score = 0.3555
PC5 + PC9: CCA score = 0.1938
PC5 + PC10: CCA score = 0.1686
PC6 + PC7: CCA score = 0.4934
PC6 + PC8: CCA score = 0.3863
PC6 + PC9: CCA score = 0.2459
PC6 + PC10: CCA score = 0.2266
PC7 + PC8: CCA score = 0.5411
PC7 + PC9: CCA score = 0.4517
PC7 + PC10: CCA score = 0.4415
PC8 + PC9: CCA score = 0.3314
PC8 + PC10: CCA score = 0.3174
PC9 + PC10: CCA score = 0.1091
Best combination: PC7 + PC8 with score 0.5411
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.600/cca_plot_res_0.600.png
  ⏱️  CCA plot generation: 1.837 seconds
  📊 Created CCA visualization using PC7 + PC8 (viz score: 0.5411)
⏱️    🎲 Null distribution (1000 sims): 3.02 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0910
  ⏱️  TOTAL for resolution 0.600: 30.57 seconds

🎯 Testing resolution: 0.700
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 3.00 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 14
⏱️    🧪 Pseudobulk computation: 26.24 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7845 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3410
PC1 + PC3: CCA score = 0.3712
PC1 + PC4: CCA score = 0.4556
PC1 + PC5: CCA score = 0.4221
PC1 + PC6: CCA score = 0.4226
PC1 + PC7: CCA score = 0.3710
PC1 + PC8: CCA score = 0.5041
PC1 + PC9: CCA score = 0.3221
PC1 + PC10: CCA score = 0.3274
PC2 + PC3: CCA score = 0.2294
PC2 + PC4: CCA score = 0.3498
PC2 + PC5: CCA score = 0.3049
PC2 + PC6: CCA score = 0.3056
PC2 + PC7: CCA score = 0.2289
PC2 + PC8: CCA score = 0.4111
PC2 + PC9: CCA score = 0.1363
PC2 + PC10: CCA score = 0.1484
PC3 + PC4: CCA score = 0.3794
PC3 + PC5: CCA score = 0.3384
PC3 + PC6: CCA score = 0.3391
PC3 + PC7: CCA score = 0.2720
PC3 + PC8: CCA score = 0.4365
PC3 + PC9: CCA score = 0.2003
PC3 + PC10: CCA score = 0.2087
PC4 + PC5: CCA score = 0.4293
PC4 + PC6: CCA score = 0.4298
PC4 + PC7: CCA score = 0.3791
PC4 + PC8: CCA score = 0.5102
PC4 + PC9: CCA score = 0.3315
PC4 + PC10: CCA score = 0.3366
PC5 + PC6: CCA score = 0.3941
PC5 + PC7: CCA score = 0.3381
PC5 + PC8: CCA score = 0.4805
PC5 + PC9: CCA score = 0.2837
PC5 + PC10: CCA score = 0.2897
PC6 + PC7: CCA score = 0.3388
PC6 + PC8: CCA score = 0.4809
PC6 + PC9: CCA score = 0.2845
PC6 + PC10: CCA score = 0.2905
PC7 + PC8: CCA score = 0.4363
PC7 + PC9: CCA score = 0.1998
PC7 + PC10: CCA score = 0.2082
PC8 + PC9: CCA score = 0.3956
PC8 + PC10: CCA score = 0.3999
PC9 + PC10: CCA score = 0.0976
Best combination: PC4 + PC8 with score 0.5102
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.700/cca_plot_res_0.700.png
  ⏱️  CCA plot generation: 1.624 seconds
  📊 Created CCA visualization using PC4 + PC8 (viz score: 0.5102)
⏱️    🎲 Null distribution (1000 sims): 1.94 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0360
  ⏱️  TOTAL for resolution 0.700: 32.81 seconds

🎯 Testing resolution: 0.800
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 3.09 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 14
⏱️    🧪 Pseudobulk computation: 26.42 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7764 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3402
PC1 + PC3: CCA score = 0.3892
PC1 + PC4: CCA score = 0.3767
PC1 + PC5: CCA score = 0.4478
PC1 + PC6: CCA score = 0.4796
PC1 + PC7: CCA score = 0.5018
PC1 + PC8: CCA score = 0.3174
PC1 + PC9: CCA score = 0.3300
PC1 + PC10: CCA score = 0.3177
PC2 + PC3: CCA score = 0.2596
PC2 + PC4: CCA score = 0.2406
PC2 + PC5: CCA score = 0.3413
PC2 + PC6: CCA score = 0.3820
PC2 + PC7: CCA score = 0.4096
PC2 + PC8: CCA score = 0.1293
PC2 + PC9: CCA score = 0.1577
PC2 + PC10: CCA score = 0.1300
PC3 + PC4: CCA score = 0.3059
PC3 + PC5: CCA score = 0.3901
PC3 + PC6: CCA score = 0.4262
PC3 + PC7: CCA score = 0.4510
PC3 + PC8: CCA score = 0.2289
PC3 + PC9: CCA score = 0.2460
PC3 + PC10: CCA score = 0.2293
PC4 + PC5: CCA score = 0.3777
PC4 + PC6: CCA score = 0.4149
PC4 + PC7: CCA score = 0.4404
PC4 + PC8: CCA score = 0.2070
PC4 + PC9: CCA score = 0.2259
PC4 + PC10: CCA score = 0.2075
PC5 + PC6: CCA score = 0.4803
PC5 + PC7: CCA score = 0.5025
PC5 + PC8: CCA score = 0.3185
PC5 + PC9: CCA score = 0.3311
PC5 + PC10: CCA score = 0.3188
PC6 + PC7: CCA score = 0.5310
PC6 + PC8: CCA score = 0.3618
PC6 + PC9: CCA score = 0.3729
PC6 + PC10: CCA score = 0.3621
PC7 + PC8: CCA score = 0.3908
PC7 + PC9: CCA score = 0.4011
PC7 + PC10: CCA score = 0.3910
PC8 + PC9: CCA score = 0.0991
PC8 + PC10: CCA score = 0.0432
PC9 + PC10: CCA score = 0.1001
Best combination: PC6 + PC7 with score 0.5310
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.800/cca_plot_res_0.800.png
  ⏱️  CCA plot generation: 1.634 seconds
  📊 Created CCA visualization using PC6 + PC7 (viz score: 0.5310)
⏱️    🎲 Null distribution (1000 sims): 1.87 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0510
  ⏱️  TOTAL for resolution 0.800: 33.03 seconds

🎯 Testing resolution: 0.900
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 3.48 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 10
⏱️    🧪 Pseudobulk computation: 22.84 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7713 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.4690
PC1 + PC3: CCA score = 0.4751
PC1 + PC4: CCA score = 0.2222
PC1 + PC5: CCA score = 0.0969
PC1 + PC6: CCA score = 0.0943
PC1 + PC7: CCA score = 0.2445
PC1 + PC8: CCA score = 0.1056
PC1 + PC9: CCA score = 0.0991
PC1 + PC10: CCA score = 0.2654
PC2 + PC3: CCA score = 0.6544
PC2 + PC4: CCA score = 0.5019
PC2 + PC5: CCA score = 0.4604
PC2 + PC6: CCA score = 0.4598
PC2 + PC7: CCA score = 0.5122
PC2 + PC8: CCA score = 0.4623
PC2 + PC9: CCA score = 0.4608
PC2 + PC10: CCA score = 0.5225
PC3 + PC4: CCA score = 0.5077
PC3 + PC5: CCA score = 0.4667
PC3 + PC6: CCA score = 0.4661
PC3 + PC7: CCA score = 0.5178
PC3 + PC8: CCA score = 0.4685
PC3 + PC9: CCA score = 0.4671
PC3 + PC10: CCA score = 0.5280
PC4 + PC5: CCA score = 0.2034
PC4 + PC6: CCA score = 0.2022
PC4 + PC7: CCA score = 0.3029
PC4 + PC8: CCA score = 0.2077
PC4 + PC9: CCA score = 0.2045
PC4 + PC10: CCA score = 0.3200
PC5 + PC6: CCA score = 0.0299
PC5 + PC7: CCA score = 0.2275
PC5 + PC8: CCA score = 0.0562
PC5 + PC9: CCA score = 0.0428
PC5 + PC10: CCA score = 0.2498
PC6 + PC7: CCA score = 0.2264
PC6 + PC8: CCA score = 0.0515
PC6 + PC9: CCA score = 0.0364
PC6 + PC10: CCA score = 0.2488
PC7 + PC8: CCA score = 0.2314
PC7 + PC9: CCA score = 0.2285
PC7 + PC10: CCA score = 0.3359
PC8 + PC9: CCA score = 0.0599
PC8 + PC10: CCA score = 0.2533
PC9 + PC10: CCA score = 0.2507
Best combination: PC2 + PC3 with score 0.6544
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.900/cca_plot_res_0.900.png
  ⏱️  CCA plot generation: 1.320 seconds
  📊 Created CCA visualization using PC2 + PC3 (viz score: 0.6544)
⏱️    🎲 Null distribution (1000 sims): 1.94 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0780
  ⏱️  TOTAL for resolution 0.900: 29.69 seconds

🎯 Testing resolution: 1.000
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 3.63 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 16
⏱️    🧪 Pseudobulk computation: 31.04 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.8007 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.2674
PC1 + PC3: CCA score = 0.3884
PC1 + PC4: CCA score = 0.3028
PC1 + PC5: CCA score = 0.4745
PC1 + PC6: CCA score = 0.4830
PC1 + PC7: CCA score = 0.2921
PC1 + PC8: CCA score = 0.3139
PC1 + PC9: CCA score = 0.3459
PC1 + PC10: CCA score = 0.3646
PC2 + PC3: CCA score = 0.2835
PC2 + PC4: CCA score = 0.1457
PC2 + PC5: CCA score = 0.3933
PC2 + PC6: CCA score = 0.4035
PC2 + PC7: CCA score = 0.1220
PC2 + PC8: CCA score = 0.1676
PC2 + PC9: CCA score = 0.2218
PC2 + PC10: CCA score = 0.2499
PC3 + PC4: CCA score = 0.3171
PC3 + PC5: CCA score = 0.4838
PC3 + PC6: CCA score = 0.4921
PC3 + PC7: CCA score = 0.3070
PC3 + PC8: CCA score = 0.3278
PC3 + PC9: CCA score = 0.3585
PC3 + PC10: CCA score = 0.3765
PC4 + PC5: CCA score = 0.4182
PC4 + PC6: CCA score = 0.4278
PC4 + PC7: CCA score = 0.1873
PC4 + PC8: CCA score = 0.2197
PC4 + PC9: CCA score = 0.2634
PC4 + PC10: CCA score = 0.2874
PC5 + PC6: CCA score = 0.5625
PC5 + PC7: CCA score = 0.4105
PC5 + PC8: CCA score = 0.4263
PC5 + PC9: CCA score = 0.4504
PC5 + PC10: CCA score = 0.4648
PC6 + PC7: CCA score = 0.4203
PC6 + PC8: CCA score = 0.4357
PC6 + PC9: CCA score = 0.4593
PC6 + PC10: CCA score = 0.4735
PC7 + PC8: CCA score = 0.2048
PC7 + PC9: CCA score = 0.2511
PC7 + PC10: CCA score = 0.2762
PC8 + PC9: CCA score = 0.2761
PC8 + PC10: CCA score = 0.2991
PC9 + PC10: CCA score = 0.3325
Best combination: PC5 + PC6 with score 0.5625
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_1.000/cca_plot_res_1.000.png
  ⏱️  CCA plot generation: 1.599 seconds
  📊 Created CCA visualization using PC5 + PC6 (viz score: 0.5625)
⏱️    🎲 Null distribution (1000 sims): 1.91 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0190
  ⏱️  TOTAL for resolution 1.000: 38.31 seconds

⏱️  COARSE SEARCH TOTAL: 281.36 seconds

🏆 Best resolution from first pass: 1.00
🎯 Best CCA score: 0.8007

🔬 === SECOND PASS: Fine-tuned Search ===
Fine-tuning search from 0.98 to 1.00...

🎯 Testing resolution: 0.980
  ⏱️  Cleanup: 0.002 seconds
⏱️    🧬 Cell clustering: 2.92 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 15
⏱️    🧪 Pseudobulk computation: 29.04 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.8055 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.3229
PC1 + PC3: CCA score = 0.3163
PC1 + PC4: CCA score = 0.5118
PC1 + PC5: CCA score = 0.2981
PC1 + PC6: CCA score = 0.5736
PC1 + PC7: CCA score = 0.3465
PC1 + PC8: CCA score = 0.3853
PC1 + PC9: CCA score = 0.3299
PC1 + PC10: CCA score = 0.3073
PC2 + PC3: CCA score = 0.1660
PC2 + PC4: CCA score = 0.4353
PC2 + PC5: CCA score = 0.1279
PC2 + PC6: CCA score = 0.5064
PC2 + PC7: CCA score = 0.2181
PC2 + PC8: CCA score = 0.2756
PC2 + PC9: CCA score = 0.1905
PC2 + PC10: CCA score = 0.1480
PC3 + PC4: CCA score = 0.4304
PC3 + PC5: CCA score = 0.1102
PC3 + PC6: CCA score = 0.5022
PC3 + PC7: CCA score = 0.2082
PC3 + PC8: CCA score = 0.2679
PC3 + PC9: CCA score = 0.1791
PC3 + PC10: CCA score = 0.1331
PC4 + PC5: CCA score = 0.4172
PC4 + PC6: CCA score = 0.6435
PC4 + PC7: CCA score = 0.4531
PC4 + PC8: CCA score = 0.4834
PC4 + PC9: CCA score = 0.4404
PC4 + PC10: CCA score = 0.4238
PC5 + PC6: CCA score = 0.4910
PC5 + PC7: CCA score = 0.1793
PC5 + PC8: CCA score = 0.2461
PC5 + PC9: CCA score = 0.1445
PC5 + PC10: CCA score = 0.0806
PC6 + PC7: CCA score = 0.5218
PC6 + PC8: CCA score = 0.5483
PC6 + PC9: CCA score = 0.5109
PC6 + PC10: CCA score = 0.4966
PC7 + PC8: CCA score = 0.3030
PC7 + PC9: CCA score = 0.2283
PC7 + PC10: CCA score = 0.1942
PC8 + PC9: CCA score = 0.2837
PC8 + PC10: CCA score = 0.2571
PC9 + PC10: CCA score = 0.1626
Best combination: PC4 + PC6 with score 0.6435
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.980/cca_plot_res_0.980.png
  ⏱️  CCA plot generation: 1.355 seconds
  📊 Created CCA visualization using PC4 + PC6 (viz score: 0.6435)
⏱️    🎲 Null distribution (1000 sims): 1.78 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.0110
  ⏱️  TOTAL for resolution 0.980: 35.58 seconds

🎯 Testing resolution: 0.990
  ⏱️  Cleanup: 0.003 seconds
⏱️    🧬 Cell clustering: 3.11 seconds
⏱️    📋 Cell type assignment: 0.00 seconds
  📊 Number of clusters: 14
⏱️    🧪 Pseudobulk computation: 29.04 seconds
⏱️    📐 Dimension reduction: 0.01 seconds
  ⏱️  CCA analysis: 0.001 seconds
  🎯 CCA Score = 0.7440 (using 10 PCs)
Auto-selecting best 2-PC combination from 10 components...
Testing 45 PC combinations...
PC1 + PC2: CCA score = 0.5578
PC1 + PC3: CCA score = 0.0153
PC1 + PC4: CCA score = 0.0938
PC1 + PC5: CCA score = 0.0888
PC1 + PC6: CCA score = 0.2952
PC1 + PC7: CCA score = 0.3126
PC1 + PC8: CCA score = 0.1739
PC1 + PC9: CCA score = 0.0120
PC1 + PC10: CCA score = 0.1070
PC2 + PC3: CCA score = 0.5578
PC2 + PC4: CCA score = 0.5654
PC2 + PC5: CCA score = 0.5646
PC2 + PC6: CCA score = 0.6309
PC2 + PC7: CCA score = 0.6392
PC2 + PC8: CCA score = 0.5840
PC2 + PC9: CCA score = 0.5577
PC2 + PC10: CCA score = 0.5677
PC3 + PC4: CCA score = 0.0935
PC3 + PC5: CCA score = 0.0885
PC3 + PC6: CCA score = 0.2951
PC3 + PC7: CCA score = 0.3125
PC3 + PC8: CCA score = 0.1737
PC3 + PC9: CCA score = 0.0099
PC3 + PC10: CCA score = 0.1067
PC4 + PC5: CCA score = 0.1280
PC4 + PC6: CCA score = 0.3093
PC4 + PC7: CCA score = 0.3259
PC4 + PC8: CCA score = 0.1968
PC4 + PC9: CCA score = 0.0930
PC4 + PC10: CCA score = 0.1413
PC5 + PC6: CCA score = 0.3078
PC5 + PC7: CCA score = 0.3245
PC5 + PC8: CCA score = 0.1945
PC5 + PC9: CCA score = 0.0880
PC5 + PC10: CCA score = 0.1380
PC6 + PC7: CCA score = 0.4296
PC6 + PC8: CCA score = 0.3422
PC6 + PC9: CCA score = 0.2950
PC6 + PC10: CCA score = 0.3135
PC7 + PC8: CCA score = 0.3573
PC7 + PC9: CCA score = 0.3123
PC7 + PC10: CCA score = 0.3299
PC8 + PC9: CCA score = 0.1735
PC8 + PC10: CCA score = 0.2035
PC9 + PC10: CCA score = 0.1063
Best combination: PC2 + PC7 with score 0.6392
Saved CCA plot to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/RNA_resolution_optimization_expression/resolutions/resolution_0.990/cca_plot_res_0.990.png
  ⏱️  CCA plot generation: 1.435 seconds
  📊 Created CCA visualization using PC2 + PC7 (viz score: 0.6392)
⏱️    🎲 Null distribution (1000 sims): 2.46 seconds
  ⏱️  P-value computation: 0.000 seconds
  📈 Standard p-value = 0.1240
  ⏱️  TOTAL for resolution 0.990: 36.60 seconds

⏱️  FINE SEARCH TOTAL: 72.18 seconds

🔧 === GENERATING CORRECTED NULL DISTRIBUTION ===
⏱️  📊 Corrected null distribution generation: 0.00 seconds
⏱️  Saving corrected null: 0.989 seconds

📊 === COMPUTING CORRECTED P-VALUES ===
⏱️  📈 Corrected p-values computation: 16.88 seconds
⏱️  Corrected null visualization: 1.090 seconds
⏱️  CORRECTED P-VALUES TOTAL: 18.96 seconds

🏆 === FINAL RESULTS ===
🎯 Best resolution: 0.980
📊 Best CCA score: 0.8055
🧬 Number of clusters: 15
📐 Number of PCs used: 10
📊 Best visualization used PC4 + PC6
📈 Standard p-value: 0.0110
📊 Corrected p-value: 0.2490
⏱️  Final processing: 1.325 seconds

🚀 [PROFILED Find Optimal Resolution RNA-seq] TOTAL RUNTIME: 373.26 seconds

📊 PERFORMANCE SUMMARY:
  🔧 Setup: 0.1s
  🔍 Coarse search: 281.4s (75.4%)
  🔬 Fine search: 72.2s (19.3%)
  📊 Corrected p-values: 19.0s (5.1%)
  📝 Final processing: 1.3s
Starting visualization...
[_preprocessing] Verified required columns in pseudobulk AnnData: ['sev.level']
Found 14 unique cell types.
Dendrogram saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/rna/visualization/cell_type_dendrogram.png
[visualization] All requested visualizations saved.
RNA analysis completed successfully!

✓ RNA pipeline completed successfully!

============================================================
PIPELINE EXECUTION SUMMARY
============================================================
RNA Pipeline: ⚠ PARTIAL
  - preprocessing: ✓
  - cell_type_cluster: ✓
  - dimensionality_reduction: ✓
  - sample_distance_calculation: ✗
  - trajectory_analysis: ✓
  - trajectory_dge: ✗
  - cluster_dge: ✗
  - visualization: ✓

Results saved to: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample
Status file: /dcs07/hongkai/data/harry/result/Benchmark/covid_25_sample/sys_log/main_process_status.json
Execution time: 898.7664 seconds
